<?xml version="1.0"?>
<root><AttributeHolder Name="Type" Value="exe"/><AttributeHolder Name="Template" Value="c:\bami\MTZ\Generators L4\VB6ARMGEN\Template\Template.vbp"/><AttributeHolder Name="Name" Value="WMS_PLUS"/><AttributeHolder Name="ProjectName" Value="WMS_PLUS"/><AttributeHolder Name="Description" Value="WMS_PLUS"/><AttributeHolder Name="ExeName" Value="WMS_PLUS.Exe"/><ModuleHolder ModuleName="frmMain" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="mnuDictionary" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Справочники"/><Properties Name="Name" PropValue="mnuDictionary"/><ControlData Name="mnuwpG" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Справочник товаров "/><Properties Name="Name" PropValue="mnuwpG"/></ControlData><ControlData Name="mnuwpDic" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Справочники"/><Properties Name="Name" PropValue="mnuwpDic"/></ControlData><ControlData Name="mnuwpCell" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Ячейка"/><Properties Name="Name" PropValue="mnuwpCell"/></ControlData></ControlData><ControlData Name="mnuJRNL" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Журналы"/><Properties Name="Name" PropValue="mnuJRNL"/><ControlData Name="mnuwpACT" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Акт расхождений"/><Properties Name="Name" PropValue="mnuwpACT"/><ControlData Name="mnuAllwpACT" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Акт расхождений - все состояния"/><Properties Name="Name" PropValue="mnuAllwpACT"/></ControlData><ControlData Name="mnuwpACT_1" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Акт расхождений :Проведен"/><Properties Name="Name" PropValue="mnuwpACT_1"/></ControlData><ControlData Name="mnuwpACT_2" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Акт расхождений :Согласован"/><Properties Name="Name" PropValue="mnuwpACT_2"/></ControlData><ControlData Name="mnuwpACT_3" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Акт расхождений :Создан"/><Properties Name="Name" PropValue="mnuwpACT_3"/></ControlData></ControlData><ControlData Name="mnuwpDog" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Договор"/><Properties Name="Name" PropValue="mnuwpDog"/></ControlData><ControlData Name="mnuwpOut" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку"/><Properties Name="Name" PropValue="mnuwpOut"/><ControlData Name="mnuAllwpOut" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку - все состояния"/><Properties Name="Name" PropValue="mnuAllwpOut"/></ControlData><ControlData Name="mnuwpOut_1" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Проведен"/><Properties Name="Name" PropValue="mnuwpOut_1"/></ControlData><ControlData Name="mnuwpOut_2" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Создан"/><Properties Name="Name" PropValue="mnuwpOut_2"/></ControlData><ControlData Name="mnuwpOut_3" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Товар заблокирован"/><Properties Name="Name" PropValue="mnuwpOut_3"/></ControlData><ControlData Name="mnuwpOut_4" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Согласован"/><Properties Name="Name" PropValue="mnuwpOut_4"/></ControlData><ControlData Name="mnuwpOut_5" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Отгружен"/><Properties Name="Name" PropValue="mnuwpOut_5"/></ControlData><ControlData Name="mnuwpOut_6" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на отгрузку :Отменен"/><Properties Name="Name" PropValue="mnuwpOut_6"/></ControlData></ControlData><ControlData Name="mnuwpIN" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку"/><Properties Name="Name" PropValue="mnuwpIN"/><ControlData Name="mnuAllwpIN" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку - все состояния"/><Properties Name="Name" PropValue="mnuAllwpIN"/></ControlData><ControlData Name="mnuwpIN_1" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Идет приемка"/><Properties Name="Name" PropValue="mnuwpIN_1"/></ControlData><ControlData Name="mnuwpIN_2" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Отменен"/><Properties Name="Name" PropValue="mnuwpIN_2"/></ControlData><ControlData Name="mnuwpIN_3" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Принят"/><Properties Name="Name" PropValue="mnuwpIN_3"/></ControlData><ControlData Name="mnuwpIN_4" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Проведен"/><Properties Name="Name" PropValue="mnuwpIN_4"/></ControlData><ControlData Name="mnuwpIN_5" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Создан"/><Properties Name="Name" PropValue="mnuwpIN_5"/></ControlData><ControlData Name="mnuwpIN_6" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Заказ на приемку :Согласован"/><Properties Name="Name" PropValue="mnuwpIN_6"/></ControlData></ControlData><ControlData Name="mnuwpCLI" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Контрагет"/><Properties Name="Name" PropValue="mnuwpCLI"/></ControlData><ControlData Name="mnuwpOpt" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация"/><Properties Name="Name" PropValue="mnuwpOpt"/><ControlData Name="mnuAllwpOpt" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация - все состояния"/><Properties Name="Name" PropValue="mnuAllwpOpt"/></ControlData><ControlData Name="mnuwpOpt_1" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация :Производятся перемещения"/><Properties Name="Name" PropValue="mnuwpOpt_1"/></ControlData><ControlData Name="mnuwpOpt_2" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация :Отменен"/><Properties Name="Name" PropValue="mnuwpOpt_2"/></ControlData><ControlData Name="mnuwpOpt_3" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация :Создан"/><Properties Name="Name" PropValue="mnuwpOpt_3"/></ControlData><ControlData Name="mnuwpOpt_4" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация :Расчет оптимизации произведен"/><Properties Name="Name" PropValue="mnuwpOpt_4"/></ControlData><ControlData Name="mnuwpOpt_5" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Оптимизация :Проведен"/><Properties Name="Name" PropValue="mnuwpOpt_5"/></ControlData></ControlData><ControlData Name="mnuwpPal" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Паллета"/><Properties Name="Name" PropValue="mnuwpPal"/><ControlData Name="mnuAllwpPal" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Паллета - все состояния"/><Properties Name="Name" PropValue="mnuAllwpPal"/></ControlData><ControlData Name="mnuwpPal_1" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Паллета :Списана"/><Properties Name="Name" PropValue="mnuwpPal_1"/></ControlData><ControlData Name="mnuwpPal_2" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Паллета :С грузом"/><Properties Name="Name" PropValue="mnuwpPal_2"/></ControlData><ControlData Name="mnuwpPal_3" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Паллета :Пустая"/><Properties Name="Name" PropValue="mnuwpPal_3"/></ControlData></ControlData></ControlData></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="







dim withevents jfmnuAllwpACT as frmJournalShow

dim withevents jfmnuwpACT_1 as frmJournalShow

dim withevents jfmnuwpACT_2 as frmJournalShow

dim withevents jfmnuwpACT_3 as frmJournalShow



dim withevents jfmnuwpDog as frmJournalShow

dim withevents jfmnuAllwpOut as frmJournalShow

dim withevents jfmnuwpOut_1 as frmJournalShow

dim withevents jfmnuwpOut_2 as frmJournalShow

dim withevents jfmnuwpOut_3 as frmJournalShow

dim withevents jfmnuwpOut_4 as frmJournalShow

dim withevents jfmnuwpOut_5 as frmJournalShow

dim withevents jfmnuwpOut_6 as frmJournalShow



dim withevents jfmnuAllwpIN as frmJournalShow

dim withevents jfmnuwpIN_1 as frmJournalShow

dim withevents jfmnuwpIN_2 as frmJournalShow

dim withevents jfmnuwpIN_3 as frmJournalShow

dim withevents jfmnuwpIN_4 as frmJournalShow

dim withevents jfmnuwpIN_5 as frmJournalShow

dim withevents jfmnuwpIN_6 as frmJournalShow



dim withevents jfmnuwpCLI as frmJournalShow

dim withevents jfmnuAllwpOpt as frmJournalShow

dim withevents jfmnuwpOpt_1 as frmJournalShow

dim withevents jfmnuwpOpt_2 as frmJournalShow

dim withevents jfmnuwpOpt_3 as frmJournalShow

dim withevents jfmnuwpOpt_4 as frmJournalShow

dim withevents jfmnuwpOpt_5 as frmJournalShow



dim withevents jfmnuAllwpPal as frmJournalShow

dim withevents jfmnuwpPal_1 as frmJournalShow

dim withevents jfmnuwpPal_2 as frmJournalShow

dim withevents jfmnuwpPal_3 as frmJournalShow







"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
private sub mnuwpG_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim ID as string
  Set rs = Manager.ListInstances(&quot;&quot;,&quot;wpG&quot;)
  if not  rs.eof then
    id =rs!Instanceid 
  else
    id =createguid2
    Manager.NewInstance id, &quot;wpG&quot;, &quot;Справочник товаров &quot; 
  End If
    Set o = Manager.GetInstanceObject( id)
    If IsDocDenied(o) Then
      MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.ID)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  set rs = nothing
end sub 


private sub mnuwpDic_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim ID as string
  Set rs = Manager.ListInstances(&quot;&quot;,&quot;wpDic&quot;)
  if not  rs.eof then
    id =rs!Instanceid 
  else
    id =createguid2
    Manager.NewInstance id, &quot;wpDic&quot;, &quot;Справочники&quot; 
  End If
    Set o = Manager.GetInstanceObject( id)
    If IsDocDenied(o) Then
      MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.ID)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  set rs = nothing
end sub 


private sub mnuwpCell_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim ID as string
  Set rs = Manager.ListInstances(&quot;&quot;,&quot;wpCell&quot;)
  if not  rs.eof then
    id =rs!Instanceid 
  else
    id =createguid2
    Manager.NewInstance id, &quot;wpCell&quot;, &quot;Ячейка&quot; 
  End If
    Set o = Manager.GetInstanceObject( id)
    If IsDocDenied(o) Then
      MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.ID)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  set rs = nothing
end sub 




private sub mnuAllwpACT_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllwpACT Is Nothing Then
      Set jfmnuAllwpACT = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{84C8AA50-443D-478A-9CAA-9D1AE752F599}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuAllwpACT.jv.journal = journal
      jfmnuAllwpACT.jv.OpenModal = False
      jfmnuAllwpACT.Caption = &quot;Акт расхождений - все состояния&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpACT
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuAllwpACT.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
      jfmnuAllwpACT.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllwpACT.Show
    jfmnuAllwpACT.WindowState = 0
    jfmnuAllwpACT.ZOrder 0
end sub 
private sub   jfmnuAllwpACT_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpACT
    Dim f as string
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuAllwpACT.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuAllwpACT_OnClearFilter()  
end sub 
Private Sub jfmnuAllwpACT_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpACT&quot;, &quot;Акт расхождений&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpACT_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpACT_1 Is Nothing Then
      Set jfmnuwpACT_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{84C8AA50-443D-478A-9CAA-9D1AE752F599}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpACT_1.jv.journal = journal
      jfmnuwpACT_1.jv.OpenModal = False
      jfmnuwpACT_1.Caption = &quot;Акт расхождений :Проведен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{71A9B033-A2BC-4683-85F6-3ECE99C40A00}'&quot; 
    jfmnuwpACT_1.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    Dim fltr As frmwpACT
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpACT_1.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
      jfmnuwpACT_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpACT_1.Show
    jfmnuwpACT_1.WindowState = 0
    jfmnuwpACT_1.ZOrder 0
end sub 
private sub   jfmnuwpACT_1_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpACT
    Dim f as string
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{71A9B033-A2BC-4683-85F6-3ECE99C40A00}'&quot; 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpACT_1.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpACT_1_OnClearFilter()  
   jfmnuwpACT_1.jv.Filter.Add  &quot;AUTOwpACT_DEF&quot;,&quot; INTSANCEStatusID='{71A9B033-A2BC-4683-85F6-3ECE99C40A00}'&quot; 
end sub 
Private Sub jfmnuwpACT_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpACT&quot;, &quot;Акт расхождений&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpACT_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpACT_2 Is Nothing Then
      Set jfmnuwpACT_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{84C8AA50-443D-478A-9CAA-9D1AE752F599}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpACT_2.jv.journal = journal
      jfmnuwpACT_2.jv.OpenModal = False
      jfmnuwpACT_2.Caption = &quot;Акт расхождений :Согласован&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{39C6754B-4D97-408F-AB9B-725AF8DA7140}'&quot; 
    jfmnuwpACT_2.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    Dim fltr As frmwpACT
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpACT_2.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
      jfmnuwpACT_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpACT_2.Show
    jfmnuwpACT_2.WindowState = 0
    jfmnuwpACT_2.ZOrder 0
end sub 
private sub   jfmnuwpACT_2_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpACT
    Dim f as string
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{39C6754B-4D97-408F-AB9B-725AF8DA7140}'&quot; 
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpACT_2.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpACT_2_OnClearFilter()  
   jfmnuwpACT_2.jv.Filter.Add  &quot;AUTOwpACT_DEF&quot;,&quot; INTSANCEStatusID='{39C6754B-4D97-408F-AB9B-725AF8DA7140}'&quot; 
end sub 
Private Sub jfmnuwpACT_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpACT&quot;, &quot;Акт расхождений&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpACT_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpACT_3 Is Nothing Then
      Set jfmnuwpACT_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{84C8AA50-443D-478A-9CAA-9D1AE752F599}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpACT_3.jv.journal = journal
      jfmnuwpACT_3.jv.OpenModal = False
      jfmnuwpACT_3.Caption = &quot;Акт расхождений :Создан&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{1CFC4610-2026-4D82-A595-784D93F8830D}'&quot; 
    jfmnuwpACT_3.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    Dim fltr As frmwpACT
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpACT_3.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
      jfmnuwpACT_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpACT_3.Show
    jfmnuwpACT_3.WindowState = 0
    jfmnuwpACT_3.ZOrder 0
end sub 
private sub   jfmnuwpACT_3_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpACT
    Dim f as string
    set fltr = new frmwpACT
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{1CFC4610-2026-4D82-A595-784D93F8830D}'&quot; 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpACT_DEF_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpACT_3.jv.Filter.Add &quot;AUTOwpACT_DEF&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpACT_3_OnClearFilter()  
   jfmnuwpACT_3.jv.Filter.Add  &quot;AUTOwpACT_DEF&quot;,&quot; INTSANCEStatusID='{1CFC4610-2026-4D82-A595-784D93F8830D}'&quot; 
end sub 
Private Sub jfmnuwpACT_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpACT&quot;, &quot;Акт расхождений&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




private sub mnuwpDog_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpDog Is Nothing Then
      Set jfmnuwpDog = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{0E7C501C-4CC9-4F84-AC2C-85291E39FBB1}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpDog.jv.journal = journal
      jfmnuwpDog.jv.OpenModal = False
      jfmnuwpDog.Caption = &quot;Договор&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpDog
    set fltr = new frmwpDog
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheClient.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_TheClient_ID='&quot; &amp; fltr.txtTheClient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblDogDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_DogDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpDogDate_LE.value)
      end if
      if fltr.lblDogDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_DogDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpDogDate_GE.value)
      end if
      if fltr.lblMyOrg.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_MyOrg_ID='&quot; &amp; fltr.txtMyOrg.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpDog.jv.Filter.Add &quot;AUTOwpDog_def&quot;, f
    end if 
      jfmnuwpDog.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpDog.Show
    jfmnuwpDog.WindowState = 0
    jfmnuwpDog.ZOrder 0
end sub 
private sub   jfmnuwpDog_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpDog
    Dim f as string
    set fltr = new frmwpDog
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheClient.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_TheClient_ID='&quot; &amp; fltr.txtTheClient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblDogDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_DogDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpDogDate_LE.value)
      end if
      if fltr.lblDogDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_DogDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpDogDate_GE.value)
      end if
      if fltr.lblMyOrg.Value=vbChecked then
        f=f &amp;  &quot; and wpDog_def_MyOrg_ID='&quot; &amp; fltr.txtMyOrg.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpDog.jv.Filter.Add &quot;AUTOwpDog_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpDog_OnClearFilter()  
end sub 
Private Sub jfmnuwpDog_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpDog&quot;, &quot;Договор&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuAllwpOut_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllwpOut Is Nothing Then
      Set jfmnuAllwpOut = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuAllwpOut.jv.journal = journal
      jfmnuAllwpOut.jv.OpenModal = False
      jfmnuAllwpOut.Caption = &quot;Заказ на отгрузку - все состояния&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuAllwpOut.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuAllwpOut.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllwpOut.Show
    jfmnuAllwpOut.WindowState = 0
    jfmnuAllwpOut.ZOrder 0
end sub 
private sub   jfmnuAllwpOut_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuAllwpOut.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuAllwpOut_OnClearFilter()  
end sub 
Private Sub jfmnuAllwpOut_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_1 Is Nothing Then
      Set jfmnuwpOut_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_1.jv.journal = journal
      jfmnuwpOut_1.jv.OpenModal = False
      jfmnuwpOut_1.Caption = &quot;Заказ на отгрузку :Проведен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{9AF79409-7A05-4CFE-A3D9-53701267A2C2}'&quot; 
    jfmnuwpOut_1.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpOut_1.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_1.Show
    jfmnuwpOut_1.WindowState = 0
    jfmnuwpOut_1.ZOrder 0
end sub 
private sub   jfmnuwpOut_1_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{9AF79409-7A05-4CFE-A3D9-53701267A2C2}'&quot; 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpOut_1.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_1_OnClearFilter()  
   jfmnuwpOut_1.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{9AF79409-7A05-4CFE-A3D9-53701267A2C2}'&quot; 
end sub 
Private Sub jfmnuwpOut_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_2 Is Nothing Then
      Set jfmnuwpOut_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_2.jv.journal = journal
      jfmnuwpOut_2.jv.OpenModal = False
      jfmnuwpOut_2.Caption = &quot;Заказ на отгрузку :Создан&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{EDC95A01-70D8-4C20-B5DA-61993ED44BE3}'&quot; 
    jfmnuwpOut_2.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuwpOut_2.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_2.Show
    jfmnuwpOut_2.WindowState = 0
    jfmnuwpOut_2.ZOrder 0
end sub 
private sub   jfmnuwpOut_2_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{EDC95A01-70D8-4C20-B5DA-61993ED44BE3}'&quot; 
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
    jfmnuwpOut_2.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_2_OnClearFilter()  
   jfmnuwpOut_2.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{EDC95A01-70D8-4C20-B5DA-61993ED44BE3}'&quot; 
end sub 
Private Sub jfmnuwpOut_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_3 Is Nothing Then
      Set jfmnuwpOut_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_3.jv.journal = journal
      jfmnuwpOut_3.jv.OpenModal = False
      jfmnuwpOut_3.Caption = &quot;Заказ на отгрузку :Товар заблокирован&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{E05DFCB0-7609-4A37-B35A-73CF8863CD03}'&quot; 
    jfmnuwpOut_3.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpOut_3.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_3.Show
    jfmnuwpOut_3.WindowState = 0
    jfmnuwpOut_3.ZOrder 0
end sub 
private sub   jfmnuwpOut_3_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{E05DFCB0-7609-4A37-B35A-73CF8863CD03}'&quot; 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpOut_3.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_3_OnClearFilter()  
   jfmnuwpOut_3.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{E05DFCB0-7609-4A37-B35A-73CF8863CD03}'&quot; 
end sub 
Private Sub jfmnuwpOut_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_4 Is Nothing Then
      Set jfmnuwpOut_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_4.jv.journal = journal
      jfmnuwpOut_4.jv.OpenModal = False
      jfmnuwpOut_4.Caption = &quot;Заказ на отгрузку :Согласован&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{6F604281-1612-4658-AD21-BDE4DB63ED78}'&quot; 
    jfmnuwpOut_4.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpOut_4.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_4.Show
    jfmnuwpOut_4.WindowState = 0
    jfmnuwpOut_4.ZOrder 0
end sub 
private sub   jfmnuwpOut_4_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{6F604281-1612-4658-AD21-BDE4DB63ED78}'&quot; 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpOut_4.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_4_OnClearFilter()  
   jfmnuwpOut_4.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{6F604281-1612-4658-AD21-BDE4DB63ED78}'&quot; 
end sub 
Private Sub jfmnuwpOut_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_5 Is Nothing Then
      Set jfmnuwpOut_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_5.jv.journal = journal
      jfmnuwpOut_5.jv.OpenModal = False
      jfmnuwpOut_5.Caption = &quot;Заказ на отгрузку :Отгружен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{9DBFD83F-B002-4CD1-9CAC-E7738C126AEC}'&quot; 
    jfmnuwpOut_5.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
    jfmnuwpOut_5.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_5.Show
    jfmnuwpOut_5.WindowState = 0
    jfmnuwpOut_5.ZOrder 0
end sub 
private sub   jfmnuwpOut_5_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{9DBFD83F-B002-4CD1-9CAC-E7738C126AEC}'&quot; 
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
    jfmnuwpOut_5.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_5_OnClearFilter()  
   jfmnuwpOut_5.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{9DBFD83F-B002-4CD1-9CAC-E7738C126AEC}'&quot; 
end sub 
Private Sub jfmnuwpOut_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOut_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOut_6 Is Nothing Then
      Set jfmnuwpOut_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{135BDAE0-1BC5-4794-9D84-663DD53D2AB7}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOut_6.jv.journal = journal
      jfmnuwpOut_6.jv.OpenModal = False
      jfmnuwpOut_6.Caption = &quot;Заказ на отгрузку :Отменен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{ECB8C4A8-3A5F-43B1-99CE-FD9596E2B7C7}'&quot; 
    jfmnuwpOut_6.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    Dim fltr As frmwpOut
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
    jfmnuwpOut_6.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
      jfmnuwpOut_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOut_6.Show
    jfmnuwpOut_6.WindowState = 0
    jfmnuwpOut_6.ZOrder 0
end sub 
private sub   jfmnuwpOut_6_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOut
    Dim f as string
    set fltr = new frmwpOut
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{ECB8C4A8-3A5F-43B1-99CE-FD9596E2B7C7}'&quot; 
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOut_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
    jfmnuwpOut_6.jv.Filter.Add &quot;AUTOwpOut_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOut_6_OnClearFilter()  
   jfmnuwpOut_6.jv.Filter.Add  &quot;AUTOwpOut_def&quot;,&quot; INTSANCEStatusID='{ECB8C4A8-3A5F-43B1-99CE-FD9596E2B7C7}'&quot; 
end sub 
Private Sub jfmnuwpOut_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOut&quot;, &quot;Заказ на отгрузку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




private sub mnuAllwpIN_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllwpIN Is Nothing Then
      Set jfmnuAllwpIN = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuAllwpIN.jv.journal = journal
      jfmnuAllwpIN.jv.OpenModal = False
      jfmnuAllwpIN.Caption = &quot;Заказ на приемку - все состояния&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
    jfmnuAllwpIN.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuAllwpIN.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllwpIN.Show
    jfmnuAllwpIN.WindowState = 0
    jfmnuAllwpIN.ZOrder 0
end sub 
private sub   jfmnuAllwpIN_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
    jfmnuAllwpIN.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuAllwpIN_OnClearFilter()  
end sub 
Private Sub jfmnuAllwpIN_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_1 Is Nothing Then
      Set jfmnuwpIN_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_1.jv.journal = journal
      jfmnuwpIN_1.jv.OpenModal = False
      jfmnuwpIN_1.Caption = &quot;Заказ на приемку :Идет приемка&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{E4ED2AA6-4EFE-4146-9132-3E670DE9294F}'&quot; 
    jfmnuwpIN_1.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
    jfmnuwpIN_1.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_1.Show
    jfmnuwpIN_1.WindowState = 0
    jfmnuwpIN_1.ZOrder 0
end sub 
private sub   jfmnuwpIN_1_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{E4ED2AA6-4EFE-4146-9132-3E670DE9294F}'&quot; 
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
    jfmnuwpIN_1.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_1_OnClearFilter()  
   jfmnuwpIN_1.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{E4ED2AA6-4EFE-4146-9132-3E670DE9294F}'&quot; 
end sub 
Private Sub jfmnuwpIN_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_2 Is Nothing Then
      Set jfmnuwpIN_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_2.jv.journal = journal
      jfmnuwpIN_2.jv.OpenModal = False
      jfmnuwpIN_2.Caption = &quot;Заказ на приемку :Отменен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{CF9A2B5F-E6BB-4239-8ED1-8425787FDEC4}'&quot; 
    jfmnuwpIN_2.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_2.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_2.Show
    jfmnuwpIN_2.WindowState = 0
    jfmnuwpIN_2.ZOrder 0
end sub 
private sub   jfmnuwpIN_2_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{CF9A2B5F-E6BB-4239-8ED1-8425787FDEC4}'&quot; 
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_2.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_2_OnClearFilter()  
   jfmnuwpIN_2.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{CF9A2B5F-E6BB-4239-8ED1-8425787FDEC4}'&quot; 
end sub 
Private Sub jfmnuwpIN_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_3 Is Nothing Then
      Set jfmnuwpIN_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_3.jv.journal = journal
      jfmnuwpIN_3.jv.OpenModal = False
      jfmnuwpIN_3.Caption = &quot;Заказ на приемку :Принят&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{EA7CCABE-D2BB-4914-A201-A01EFF5C535B}'&quot; 
    jfmnuwpIN_3.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_3.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_3.Show
    jfmnuwpIN_3.WindowState = 0
    jfmnuwpIN_3.ZOrder 0
end sub 
private sub   jfmnuwpIN_3_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{EA7CCABE-D2BB-4914-A201-A01EFF5C535B}'&quot; 
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_3.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_3_OnClearFilter()  
   jfmnuwpIN_3.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{EA7CCABE-D2BB-4914-A201-A01EFF5C535B}'&quot; 
end sub 
Private Sub jfmnuwpIN_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_4 Is Nothing Then
      Set jfmnuwpIN_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_4.jv.journal = journal
      jfmnuwpIN_4.jv.OpenModal = False
      jfmnuwpIN_4.Caption = &quot;Заказ на приемку :Проведен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{473E43A0-FF6E-4393-B340-A8F354F07287}'&quot; 
    jfmnuwpIN_4.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_4.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_4.Show
    jfmnuwpIN_4.WindowState = 0
    jfmnuwpIN_4.ZOrder 0
end sub 
private sub   jfmnuwpIN_4_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{473E43A0-FF6E-4393-B340-A8F354F07287}'&quot; 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_4.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_4_OnClearFilter()  
   jfmnuwpIN_4.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{473E43A0-FF6E-4393-B340-A8F354F07287}'&quot; 
end sub 
Private Sub jfmnuwpIN_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_5 Is Nothing Then
      Set jfmnuwpIN_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_5.jv.journal = journal
      jfmnuwpIN_5.jv.OpenModal = False
      jfmnuwpIN_5.Caption = &quot;Заказ на приемку :Создан&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{0B9A4284-FB8A-4201-8A40-EEABA5558165}'&quot; 
    jfmnuwpIN_5.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_5.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_5.Show
    jfmnuwpIN_5.WindowState = 0
    jfmnuwpIN_5.ZOrder 0
end sub 
private sub   jfmnuwpIN_5_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{0B9A4284-FB8A-4201-8A40-EEABA5558165}'&quot; 
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_5.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_5_OnClearFilter()  
   jfmnuwpIN_5.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{0B9A4284-FB8A-4201-8A40-EEABA5558165}'&quot; 
end sub 
Private Sub jfmnuwpIN_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpIN_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpIN_6 Is Nothing Then
      Set jfmnuwpIN_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{B3C5210C-3BA3-4D19-A4A5-1511A579E62C}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpIN_6.jv.journal = journal
      jfmnuwpIN_6.jv.OpenModal = False
      jfmnuwpIN_6.Caption = &quot;Заказ на приемку :Согласован&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{88E76D49-A550-42F8-ADDD-FA9CF96FF55A}'&quot; 
    jfmnuwpIN_6.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    Dim fltr As frmwpIN
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_6.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
      jfmnuwpIN_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpIN_6.Show
    jfmnuwpIN_6.WindowState = 0
    jfmnuwpIN_6.ZOrder 0
end sub 
private sub   jfmnuwpIN_6_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpIN
    Dim f as string
    set fltr = new frmwpIN
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{88E76D49-A550-42F8-ADDD-FA9CF96FF55A}'&quot; 
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblCar2Num.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Car2Num like '%&quot; &amp; fltr.txtCar2Num.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarInTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_LE.value)
      end if
      if fltr.lblTheDogovor.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDogovor_ID='&quot; &amp; fltr.txtTheDogovor.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblCarNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarNum like '%&quot; &amp; fltr.txtCarNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNNum like '%&quot; &amp; fltr.txtTTNNum.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTTNDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_GE.value)
      end if
      if fltr.lblTTNDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TTNDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTTNDate_LE.value)
      end if
      if fltr.lblCarInTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarInTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarInTime_GE.value)
      end if
      if fltr.lblTheContainer.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheContainer like '%&quot; &amp; fltr.txtTheContainer.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblCarOutTime_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_LE.value)
      end if
      if fltr.lblTheCLient.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheCLient_ID='&quot; &amp; fltr.txtTheCLient.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblCarOutTime_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_CarOutTime&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpCarOutTime_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblSupplier.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_Supplier like '%&quot; &amp; fltr.txtSupplier.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheComment.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_TheComment like '%&quot; &amp; fltr.txtTheComment.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPlombNum.Value=vbChecked then
        f=f &amp;  &quot; and wpIn_def_PlombNum like '%&quot; &amp; fltr.txtPlombNum.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpIN_6.jv.Filter.Add &quot;AUTOwpIn_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpIN_6_OnClearFilter()  
   jfmnuwpIN_6.jv.Filter.Add  &quot;AUTOwpIn_def&quot;,&quot; INTSANCEStatusID='{88E76D49-A550-42F8-ADDD-FA9CF96FF55A}'&quot; 
end sub 
Private Sub jfmnuwpIN_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpIN&quot;, &quot;Заказ на приемку&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




private sub mnuwpCLI_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpCLI Is Nothing Then
      Set jfmnuwpCLI = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{973069E8-C110-4EE8-B932-B05E19C95833}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpCLI.jv.journal = journal
      jfmnuwpCLI.jv.OpenModal = False
      jfmnuwpCLI.Caption = &quot;Контрагет&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpCLI
    set fltr = new frmwpCLI
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblFIOBuh.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FIOBuh like '%&quot; &amp; fltr.txtFIOBuh.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpostAddr.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_postAddr like '%&quot; &amp; fltr.txtpostAddr.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheFax.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_TheFax like '%&quot; &amp; fltr.txtTheFax.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblFIODirector.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FIODirector like '%&quot; &amp; fltr.txtFIODirector.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblFullName.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FullName like '%&quot; &amp; fltr.txtFullName.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblemail.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_email like '%&quot; &amp; fltr.txtemail.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblWEBSiteURL.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_WEBSiteURL like '%&quot; &amp; fltr.txtWEBSiteURL.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblKPP.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_KPP like '%&quot; &amp; fltr.txtKPP.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblINN.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_INN like '%&quot; &amp; fltr.txtINN.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPhone.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_Phone like '%&quot; &amp; fltr.txtPhone.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblShortName.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_ShortName like '%&quot; &amp; fltr.txtShortName.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblUrAddr.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_UrAddr like '%&quot; &amp; fltr.txtUrAddr.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpCLI.jv.Filter.Add &quot;AUTOwpCli_def&quot;, f
    end if 
      jfmnuwpCLI.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpCLI.Show
    jfmnuwpCLI.WindowState = 0
    jfmnuwpCLI.ZOrder 0
end sub 
private sub   jfmnuwpCLI_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpCLI
    Dim f as string
    set fltr = new frmwpCLI
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblFIOBuh.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FIOBuh like '%&quot; &amp; fltr.txtFIOBuh.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpostAddr.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_postAddr like '%&quot; &amp; fltr.txtpostAddr.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheFax.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_TheFax like '%&quot; &amp; fltr.txtTheFax.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblFIODirector.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FIODirector like '%&quot; &amp; fltr.txtFIODirector.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblFullName.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_FullName like '%&quot; &amp; fltr.txtFullName.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblemail.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_email like '%&quot; &amp; fltr.txtemail.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblWEBSiteURL.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_WEBSiteURL like '%&quot; &amp; fltr.txtWEBSiteURL.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblKPP.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_KPP like '%&quot; &amp; fltr.txtKPP.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblINN.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_INN like '%&quot; &amp; fltr.txtINN.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblPhone.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_Phone like '%&quot; &amp; fltr.txtPhone.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblShortName.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_ShortName like '%&quot; &amp; fltr.txtShortName.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblUrAddr.Value=vbChecked then
        f=f &amp;  &quot; and wpCli_def_UrAddr like '%&quot; &amp; fltr.txtUrAddr.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpCLI.jv.Filter.Add &quot;AUTOwpCli_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpCLI_OnClearFilter()  
end sub 
Private Sub jfmnuwpCLI_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpCLI&quot;, &quot;Контрагет&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuAllwpOpt_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllwpOpt Is Nothing Then
      Set jfmnuAllwpOpt = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuAllwpOpt.jv.journal = journal
      jfmnuAllwpOpt.jv.OpenModal = False
      jfmnuAllwpOpt.Caption = &quot;Оптимизация - все состояния&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuAllwpOpt.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuAllwpOpt.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllwpOpt.Show
    jfmnuAllwpOpt.WindowState = 0
    jfmnuAllwpOpt.ZOrder 0
end sub 
private sub   jfmnuAllwpOpt_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuAllwpOpt.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuAllwpOpt_OnClearFilter()  
end sub 
Private Sub jfmnuAllwpOpt_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOpt_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOpt_1 Is Nothing Then
      Set jfmnuwpOpt_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOpt_1.jv.journal = journal
      jfmnuwpOpt_1.jv.OpenModal = False
      jfmnuwpOpt_1.Caption = &quot;Оптимизация :Производятся перемещения&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{0BC001B0-678C-4B7D-9CA2-1CF872AD98AD}'&quot; 
    jfmnuwpOpt_1.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_1.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuwpOpt_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOpt_1.Show
    jfmnuwpOpt_1.WindowState = 0
    jfmnuwpOpt_1.ZOrder 0
end sub 
private sub   jfmnuwpOpt_1_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{0BC001B0-678C-4B7D-9CA2-1CF872AD98AD}'&quot; 
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_1.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOpt_1_OnClearFilter()  
   jfmnuwpOpt_1.jv.Filter.Add  &quot;AUTOwpOpt_def&quot;,&quot; INTSANCEStatusID='{0BC001B0-678C-4B7D-9CA2-1CF872AD98AD}'&quot; 
end sub 
Private Sub jfmnuwpOpt_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOpt_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOpt_2 Is Nothing Then
      Set jfmnuwpOpt_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOpt_2.jv.journal = journal
      jfmnuwpOpt_2.jv.OpenModal = False
      jfmnuwpOpt_2.Caption = &quot;Оптимизация :Отменен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{A2358A44-752E-4BEE-B8CE-501461B7FF6F}'&quot; 
    jfmnuwpOpt_2.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
    jfmnuwpOpt_2.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuwpOpt_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOpt_2.Show
    jfmnuwpOpt_2.WindowState = 0
    jfmnuwpOpt_2.ZOrder 0
end sub 
private sub   jfmnuwpOpt_2_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{A2358A44-752E-4BEE-B8CE-501461B7FF6F}'&quot; 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
    jfmnuwpOpt_2.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOpt_2_OnClearFilter()  
   jfmnuwpOpt_2.jv.Filter.Add  &quot;AUTOwpOpt_def&quot;,&quot; INTSANCEStatusID='{A2358A44-752E-4BEE-B8CE-501461B7FF6F}'&quot; 
end sub 
Private Sub jfmnuwpOpt_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOpt_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOpt_3 Is Nothing Then
      Set jfmnuwpOpt_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOpt_3.jv.journal = journal
      jfmnuwpOpt_3.jv.OpenModal = False
      jfmnuwpOpt_3.Caption = &quot;Оптимизация :Создан&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{78377FCD-1A6A-4B60-B9FF-6E27D79966EA}'&quot; 
    jfmnuwpOpt_3.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_3.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuwpOpt_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOpt_3.Show
    jfmnuwpOpt_3.WindowState = 0
    jfmnuwpOpt_3.ZOrder 0
end sub 
private sub   jfmnuwpOpt_3_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{78377FCD-1A6A-4B60-B9FF-6E27D79966EA}'&quot; 
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_3.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOpt_3_OnClearFilter()  
   jfmnuwpOpt_3.jv.Filter.Add  &quot;AUTOwpOpt_def&quot;,&quot; INTSANCEStatusID='{78377FCD-1A6A-4B60-B9FF-6E27D79966EA}'&quot; 
end sub 
Private Sub jfmnuwpOpt_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOpt_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOpt_4 Is Nothing Then
      Set jfmnuwpOpt_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOpt_4.jv.journal = journal
      jfmnuwpOpt_4.jv.OpenModal = False
      jfmnuwpOpt_4.Caption = &quot;Оптимизация :Расчет оптимизации произведен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{2960F547-00D5-456E-9C40-855E62F64EAA}'&quot; 
    jfmnuwpOpt_4.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_4.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuwpOpt_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOpt_4.Show
    jfmnuwpOpt_4.WindowState = 0
    jfmnuwpOpt_4.ZOrder 0
end sub 
private sub   jfmnuwpOpt_4_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{2960F547-00D5-456E-9C40-855E62F64EAA}'&quot; 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
    jfmnuwpOpt_4.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOpt_4_OnClearFilter()  
   jfmnuwpOpt_4.jv.Filter.Add  &quot;AUTOwpOpt_def&quot;,&quot; INTSANCEStatusID='{2960F547-00D5-456E-9C40-855E62F64EAA}'&quot; 
end sub 
Private Sub jfmnuwpOpt_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpOpt_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpOpt_5 Is Nothing Then
      Set jfmnuwpOpt_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{8125ECB0-356D-44C0-9067-912209DCDC88}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpOpt_5.jv.journal = journal
      jfmnuwpOpt_5.jv.OpenModal = False
      jfmnuwpOpt_5.Caption = &quot;Оптимизация :Проведен&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{8A9EA233-4AB9-44D9-82B4-F3BDF9A0D753}'&quot; 
    jfmnuwpOpt_5.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    Dim fltr As frmwpOpt
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpOpt_5.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
      jfmnuwpOpt_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpOpt_5.Show
    jfmnuwpOpt_5.WindowState = 0
    jfmnuwpOpt_5.ZOrder 0
end sub 
private sub   jfmnuwpOpt_5_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpOpt
    Dim f as string
    set fltr = new frmwpOpt
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{8A9EA233-4AB9-44D9-82B4-F3BDF9A0D753}'&quot; 
      if fltr.lblTheNumber_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&gt;=&quot; &amp; val(fltr.txtTheNumber_GE.Text)
      end if
      if fltr.lblTheDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_GE.value)
      end if
      if fltr.lblTheDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpTheDate_LE.value)
      end if
      if fltr.lblTheNumber_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpOpt_def_TheNumber&lt;=&quot; &amp; val(fltr.txtTheNumber_LE.Text)
      end if
    jfmnuwpOpt_5.jv.Filter.Add &quot;AUTOwpOpt_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpOpt_5_OnClearFilter()  
   jfmnuwpOpt_5.jv.Filter.Add  &quot;AUTOwpOpt_def&quot;,&quot; INTSANCEStatusID='{8A9EA233-4AB9-44D9-82B4-F3BDF9A0D753}'&quot; 
end sub 
Private Sub jfmnuwpOpt_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpOpt&quot;, &quot;Оптимизация&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




private sub mnuAllwpPal_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllwpPal Is Nothing Then
      Set jfmnuAllwpPal = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{214501F8-F2CB-4C89-971F-7F5D52EA939E}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuAllwpPal.jv.journal = journal
      jfmnuAllwpPal.jv.OpenModal = False
      jfmnuAllwpPal.Caption = &quot;Паллета - все состояния&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
    Dim fltr As frmwpPal
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
    jfmnuAllwpPal.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
      jfmnuAllwpPal.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllwpPal.Show
    jfmnuAllwpPal.WindowState = 0
    jfmnuAllwpPal.ZOrder 0
end sub 
private sub   jfmnuAllwpPal_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpPal
    Dim f as string
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
    jfmnuAllwpPal.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuAllwpPal_OnClearFilter()  
end sub 
Private Sub jfmnuAllwpPal_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpPal&quot;, &quot;Паллета&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpPal_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpPal_1 Is Nothing Then
      Set jfmnuwpPal_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{214501F8-F2CB-4C89-971F-7F5D52EA939E}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpPal_1.jv.journal = journal
      jfmnuwpPal_1.jv.OpenModal = False
      jfmnuwpPal_1.Caption = &quot;Паллета :Списана&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{FF7951B6-035E-4ADB-8B66-00C72740E543}'&quot; 
    jfmnuwpPal_1.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    Dim fltr As frmwpPal
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpPal_1.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
      jfmnuwpPal_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpPal_1.Show
    jfmnuwpPal_1.WindowState = 0
    jfmnuwpPal_1.ZOrder 0
end sub 
private sub   jfmnuwpPal_1_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpPal
    Dim f as string
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{FF7951B6-035E-4ADB-8B66-00C72740E543}'&quot; 
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
    jfmnuwpPal_1.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpPal_1_OnClearFilter()  
   jfmnuwpPal_1.jv.Filter.Add  &quot;AUTOwpPal_def&quot;,&quot; INTSANCEStatusID='{FF7951B6-035E-4ADB-8B66-00C72740E543}'&quot; 
end sub 
Private Sub jfmnuwpPal_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpPal&quot;, &quot;Паллета&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpPal_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpPal_2 Is Nothing Then
      Set jfmnuwpPal_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{214501F8-F2CB-4C89-971F-7F5D52EA939E}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpPal_2.jv.journal = journal
      jfmnuwpPal_2.jv.OpenModal = False
      jfmnuwpPal_2.Caption = &quot;Паллета :С грузом&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{5E67134F-3A06-4639-8993-ABC12AB96D00}'&quot; 
    jfmnuwpPal_2.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    Dim fltr As frmwpPal
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpPal_2.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
      jfmnuwpPal_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpPal_2.Show
    jfmnuwpPal_2.WindowState = 0
    jfmnuwpPal_2.ZOrder 0
end sub 
private sub   jfmnuwpPal_2_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpPal
    Dim f as string
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{5E67134F-3A06-4639-8993-ABC12AB96D00}'&quot; 
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
    jfmnuwpPal_2.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpPal_2_OnClearFilter()  
   jfmnuwpPal_2.jv.Filter.Add  &quot;AUTOwpPal_def&quot;,&quot; INTSANCEStatusID='{5E67134F-3A06-4639-8993-ABC12AB96D00}'&quot; 
end sub 
Private Sub jfmnuwpPal_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpPal&quot;, &quot;Паллета&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


private sub mnuwpPal_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuwpPal_3 Is Nothing Then
      Set jfmnuwpPal_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject(&quot;{214501F8-F2CB-4C89-971F-7F5D52EA939E}&quot;)
      Manager.LockInstanceObject journal.ID
      Set jfmnuwpPal_3.jv.journal = journal
      jfmnuwpPal_3.jv.OpenModal = False
      jfmnuwpPal_3.Caption = &quot;Паллета :Пустая&quot;
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{58B81E48-6D54-4F47-A237-EC4B72718D7D}'&quot; 
    jfmnuwpPal_3.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    Dim fltr As frmwpPal
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
    jfmnuwpPal_3.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
      jfmnuwpPal_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuwpPal_3.Show
    jfmnuwpPal_3.WindowState = 0
    jfmnuwpPal_3.ZOrder 0
end sub 
private sub   jfmnuwpPal_3_OnFilter( usedefault as boolean)  
    Dim fltr As frmwpPal
    Dim f as string
    set fltr = new frmwpPal
    fltr.show vbmodal
    if fltr.ok then 
    ' build flter expression 
    f=&quot;1=1&quot;
   f=&quot; INTSANCEStatusID='{58B81E48-6D54-4F47-A237-EC4B72718D7D}'&quot; 
      if fltr.lblTheWeight_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&gt;=&quot; &amp; val(fltr.txtTheWeight_GE.Text)
      end if
      if fltr.lblWeightingDate_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&lt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_LE.value)
      end if
      if fltr.lblTheNumber.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheNumber like '%&quot; &amp; fltr.txtTheNumber.Text &amp; &quot;%'&quot; 
      end if
      if fltr.lblpalType.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_palType_ID='&quot; &amp; fltr.txtpalType.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheCell.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheCell_ID='&quot; &amp; fltr.txtTheCell.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblWeightingDate_GE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_WeightingDate&gt;=&quot; &amp; MakeMSSQLDate(fltr.dtpWeightingDate_GE.value)
      end if
      if fltr.lblLockedForIn.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForIn_ID='&quot; &amp; fltr.txtLockedForIn.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblLockedForOut.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_LockedForOut_ID='&quot; &amp; fltr.txtLockedForOut.Tag &amp; &quot;'&quot; 
      end if
      if fltr.lblTheWeight_LE.Value=vbChecked then
        f=f &amp;  &quot; and wpPal_def_TheWeight&lt;=&quot; &amp; val(fltr.txtTheWeight_LE.Text)
      end if
    jfmnuwpPal_3.jv.Filter.Add &quot;AUTOwpPal_def&quot;, f
    end if 
    unload fltr 
    usedefault = false
end sub 
private sub   jfmnuwpPal_3_OnClearFilter()  
   jfmnuwpPal_3.jv.Filter.Add  &quot;AUTOwpPal_def&quot;,&quot; INTSANCEStatusID='{58B81E48-6D54-4F47-A237-EC4B72718D7D}'&quot; 
end sub 
Private Sub jfmnuwpPal_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim ID As String
  ID = CreateGUID2
  Manager.NewInstance ID, &quot;wpPal&quot;, &quot;Паллета&quot; &amp; Now, Site
  Set o = Manager.GetInstanceObject(ID)
  If IsDocDenied(o) Then
    MsgBox &quot;Не разрешен доступ к документам такого типа&quot;
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.ID)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub






private sub UnloadObjects() 







unload  jfmnuAllwpACT
set  jfmnuAllwpACT = nothing

unload  jfmnuwpACT_1
set  jfmnuwpACT_1 = nothing

unload  jfmnuwpACT_2
set  jfmnuwpACT_2 = nothing

unload  jfmnuwpACT_3
set  jfmnuwpACT_3 = nothing

unload  jfmnuwpDog
set  jfmnuwpDog = nothing


unload  jfmnuAllwpOut
set  jfmnuAllwpOut = nothing

unload  jfmnuwpOut_1
set  jfmnuwpOut_1 = nothing

unload  jfmnuwpOut_2
set  jfmnuwpOut_2 = nothing

unload  jfmnuwpOut_3
set  jfmnuwpOut_3 = nothing

unload  jfmnuwpOut_4
set  jfmnuwpOut_4 = nothing

unload  jfmnuwpOut_5
set  jfmnuwpOut_5 = nothing

unload  jfmnuwpOut_6
set  jfmnuwpOut_6 = nothing


unload  jfmnuAllwpIN
set  jfmnuAllwpIN = nothing

unload  jfmnuwpIN_1
set  jfmnuwpIN_1 = nothing

unload  jfmnuwpIN_2
set  jfmnuwpIN_2 = nothing

unload  jfmnuwpIN_3
set  jfmnuwpIN_3 = nothing

unload  jfmnuwpIN_4
set  jfmnuwpIN_4 = nothing

unload  jfmnuwpIN_5
set  jfmnuwpIN_5 = nothing

unload  jfmnuwpIN_6
set  jfmnuwpIN_6 = nothing

unload  jfmnuwpCLI
set  jfmnuwpCLI = nothing


unload  jfmnuAllwpOpt
set  jfmnuAllwpOpt = nothing

unload  jfmnuwpOpt_1
set  jfmnuwpOpt_1 = nothing

unload  jfmnuwpOpt_2
set  jfmnuwpOpt_2 = nothing

unload  jfmnuwpOpt_3
set  jfmnuwpOpt_3 = nothing

unload  jfmnuwpOpt_4
set  jfmnuwpOpt_4 = nothing

unload  jfmnuwpOpt_5
set  jfmnuwpOpt_5 = nothing


unload  jfmnuAllwpPal
set  jfmnuAllwpPal = nothing

unload  jfmnuwpPal_1
set  jfmnuwpPal_1 = nothing

unload  jfmnuwpPal_2
set  jfmnuwpPal_2 = nothing

unload  jfmnuwpPal_3
set  jfmnuwpPal_3 = nothing

end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="RoleSupport" File=""><AttributeHolder Name="Type" Value="module"/><BlockHolder BlockName="'description" BlockCode="

"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
public function ARMID() as string
   ARMID=&quot;{D61E1A92-A67A-4980-85D8-E2C8C6BCFE14}&quot;
end function

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="Module1" File=""><AttributeHolder Name="Type" Value="module"/><BlockHolder BlockName="'description" BlockCode="

"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
private sub RegisterMDIGUI()
 Dim g As GUI
Set g = New GUI
g.Init &quot;wpDog&quot;
Manager.RegisterGUI g, &quot;wpDog&quot;
Set g = New GUI
g.Init &quot;wpIN&quot;
Manager.RegisterGUI g, &quot;wpIN&quot;
Set g = New GUI
g.Init &quot;wpPal&quot;
Manager.RegisterGUI g, &quot;wpPal&quot;
Set g = New GUI
g.Init &quot;wpG&quot;
Manager.RegisterGUI g, &quot;wpG&quot;
Set g = New GUI
g.Init &quot;wpOpt&quot;
Manager.RegisterGUI g, &quot;wpOpt&quot;
Set g = New GUI
g.Init &quot;wpCell&quot;
Manager.RegisterGUI g, &quot;wpCell&quot;
Set g = New GUI
g.Init &quot;wpACT&quot;
Manager.RegisterGUI g, &quot;wpACT&quot;
Set g = New GUI
g.Init &quot;wpOut&quot;
Manager.RegisterGUI g, &quot;wpOut&quot;
Set g = New GUI
g.Init &quot;wpDic&quot;
Manager.RegisterGUI g, &quot;wpDic&quot;
Set g = New GUI
g.Init &quot;wpCLI&quot;
Manager.RegisterGUI g, &quot;wpCLI&quot;

end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpACT" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheCLient"/><Properties Name="Caption" PropValue="Клиент:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheCLient"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheCLient"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="405"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDogovor"/><Properties Name="Caption" PropValue="Договор:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheDogovor"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheDogovor"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="1110"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_GE"/><Properties Name="Caption" PropValue="Номер документа больше или равно:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_GE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер документа больше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_LE"/><Properties Name="Caption" PropValue="Номер документа меньше или равно:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_LE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер документа меньше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_GE"/><Properties Name="Caption" PropValue="Дата документа C:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_GE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата документа C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_LE"/><Properties Name="Caption" PropValue="Дата документа по:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_LE"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата документа по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Акт расхождений"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpACT&quot;, &quot;fctlwpACT&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheCLient_Change()
  Changing
end sub
private sub cmdTheCLient_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpCli_def&quot;, id, brief) Then
          txtTheCLient.Tag = Left(id, 38)
          txtTheCLient = brief
        End If
end sub
private sub cmdTheCLient_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheDogovor_Change()
  Changing
end sub
private sub cmdTheDogovor_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpDog_def&quot;, id, brief) Then
          txtTheDogovor.Tag = Left(id, 38)
          txtTheDogovor = brief
        End If
end sub
private sub cmdTheDogovor_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheNumber_GE_Validate(cancel as boolean)
if txtTheNumber_GE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_GE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_GE.text) &lt;&gt;clng(Val(txtTheNumber_GE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_GE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_GE_Change()
  Changing
end sub
private sub txtTheNumber_LE_Validate(cancel as boolean)
if txtTheNumber_LE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_LE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_LE.text) &lt;&gt;clng(Val(txtTheNumber_LE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_LE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_LE_Change()
  Changing
end sub
private sub dtpTheDate_GE_Change()
  Changing
end sub
private sub dtpTheDate_LE_Change()
  Changing
end sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

  txtTheCLient.Tag = &quot;&quot; 
  txtTheCLient = &quot;&quot; 
 LoadBtnPictures cmdTheCLient,cmdTheCLient.tag
  cmdTheCLient.RemoveAllMenu
  txtTheDogovor.Tag = &quot;&quot; 
  txtTheDogovor = &quot;&quot; 
 LoadBtnPictures cmdTheDogovor,cmdTheDogovor.tag
  cmdTheDogovor.RemoveAllMenu
dtpTheDate_GE = date
dtpTheDate_LE = date
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpDog" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber"/><Properties Name="Caption" PropValue="Номер договора:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="80"/><Properties Name="ToolTipText" PropValue="Номер договора"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblDogDate_GE"/><Properties Name="Caption" PropValue="Дата договора C:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpDogDate_GE"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата договора C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblDogDate_LE"/><Properties Name="Caption" PropValue="Дата договора по:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpDogDate_LE"/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата договора по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblMyOrg"/><Properties Name="Caption" PropValue="Наша организация:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtMyOrg"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Наша организация"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdMyOrg"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="2520"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Наша организация"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheClient"/><Properties Name="Caption" PropValue="Конрагент:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheClient"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Конрагент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheClient"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="3225"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Конрагент"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Договор"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpDog&quot;, &quot;fctlwpDog&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheNumber_Change()
  Changing
end sub
private sub dtpDogDate_GE_Change()
  Changing
end sub
private sub dtpDogDate_LE_Change()
  Changing
end sub
private sub txtMyOrg_Change()
  Changing
end sub
private sub cmdMyOrg_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpDic_org&quot;, id, brief) Then
          txtMyOrg.Tag = Left(id, 38)
          txtMyOrg = brief
        End If
end sub
private sub cmdMyOrg_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheClient_Change()
  Changing
end sub
private sub cmdTheClient_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpCli_def&quot;, id, brief) Then
          txtTheClient.Tag = Left(id, 38)
          txtTheClient = brief
        End If
end sub
private sub cmdTheClient_MenuClick(ByVal sCaption As String)
End sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

txtTheNumber = &quot;&quot;
dtpDogDate_GE = date
dtpDogDate_LE = date
  txtMyOrg.Tag = &quot;&quot; 
  txtMyOrg = &quot;&quot; 
 LoadBtnPictures cmdMyOrg,cmdMyOrg.tag
  cmdMyOrg.RemoveAllMenu
  txtTheClient.Tag = &quot;&quot; 
  txtTheClient = &quot;&quot; 
 LoadBtnPictures cmdTheClient,cmdTheClient.tag
  cmdTheClient.RemoveAllMenu
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpOut" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheCLient"/><Properties Name="Caption" PropValue="Клиент:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheCLient"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheCLient"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="405"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDogovor"/><Properties Name="Caption" PropValue="Договор:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheDogovor"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheDogovor"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="1110"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_GE"/><Properties Name="Caption" PropValue="Номер заказа больше или равно:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_GE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер заказа больше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_LE"/><Properties Name="Caption" PropValue="Номер заказа меньше или равно:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_LE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер заказа меньше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_GE"/><Properties Name="Caption" PropValue="Дата заказа C:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_GE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата заказа C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_LE"/><Properties Name="Caption" PropValue="Дата заказа по:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_LE"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата заказа по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheComment"/><Properties Name="Caption" PropValue="Примечание:"/><Properties Name="Top" PropValue="4305"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheComment"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="4635"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="1200"/><Properties Name="Width" PropValue="3000"/><Properties Name="Multiline" PropValue="True"/><Properties Name="Scrollbars" PropValue="2"/><Properties Name="ToolTipText" PropValue="Примечание"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblSupplier"/><Properties Name="Caption" PropValue="Поставщик:"/><Properties Name="Top" PropValue="5910"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtSupplier"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="6240"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="Поставщик"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarNum"/><Properties Name="Caption" PropValue="Номер ТС:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtCarNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер ТС"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCar2Num"/><Properties Name="Caption" PropValue="Номер прицепа:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtCar2Num"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер прицепа"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheContainer"/><Properties Name="Caption" PropValue="Номер контейнера:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheContainer"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер контейнера"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNNum"/><Properties Name="Caption" PropValue="Номер ТТН:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTTNNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="50"/><Properties Name="ToolTipText" PropValue="Номер ТТН"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNDate_GE"/><Properties Name="Caption" PropValue="Дата ТТН C:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTTNDate_GE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата ТТН C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNDate_LE"/><Properties Name="Caption" PropValue="Дата ТТН по:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTTNDate_LE"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата ТТН по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblPlombNum"/><Properties Name="Caption" PropValue="Номер пломбы:"/><Properties Name="Top" PropValue="4305"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtPlombNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="4635"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="50"/><Properties Name="ToolTipText" PropValue="Номер пломбы"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarInTime_GE"/><Properties Name="Caption" PropValue="Время прибытия машины C:"/><Properties Name="Top" PropValue="5010"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarInTime_GE"/><Properties Name="Top" PropValue="5340"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время прибытия машины C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarInTime_LE"/><Properties Name="Caption" PropValue="Время прибытия машины по:"/><Properties Name="Top" PropValue="5715"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarInTime_LE"/><Properties Name="Top" PropValue="6045"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время прибытия машины по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarOutTime_GE"/><Properties Name="Caption" PropValue="Время убытия машины C:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarOutTime_GE"/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время убытия машины C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarOutTime_LE"/><Properties Name="Caption" PropValue="Время убытия машины по:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarOutTime_LE"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время убытия машины по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Заказ на отгрузку"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpOut&quot;, &quot;fctlwpOut&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheCLient_Change()
  Changing
end sub
private sub cmdTheCLient_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpCli_def&quot;, id, brief) Then
          txtTheCLient.Tag = Left(id, 38)
          txtTheCLient = brief
        End If
end sub
private sub cmdTheCLient_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheDogovor_Change()
  Changing
end sub
private sub cmdTheDogovor_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpDog_def&quot;, id, brief) Then
          txtTheDogovor.Tag = Left(id, 38)
          txtTheDogovor = brief
        End If
end sub
private sub cmdTheDogovor_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheNumber_GE_Validate(cancel as boolean)
if txtTheNumber_GE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_GE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_GE.text) &lt;&gt;clng(Val(txtTheNumber_GE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_GE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_GE_Change()
  Changing
end sub
private sub txtTheNumber_LE_Validate(cancel as boolean)
if txtTheNumber_LE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_LE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_LE.text) &lt;&gt;clng(Val(txtTheNumber_LE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_LE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_LE_Change()
  Changing
end sub
private sub dtpTheDate_GE_Change()
  Changing
end sub
private sub dtpTheDate_LE_Change()
  Changing
end sub
private sub txtTheComment_Change()
  Changing
end sub
private sub txtSupplier_Change()
  Changing
end sub
private sub txtCarNum_Change()
  Changing
end sub
private sub txtCar2Num_Change()
  Changing
end sub
private sub txtTheContainer_Change()
  Changing
end sub
private sub txtTTNNum_Change()
  Changing
end sub
private sub dtpTTNDate_GE_Change()
  Changing
end sub
private sub dtpTTNDate_LE_Change()
  Changing
end sub
private sub txtPlombNum_Change()
  Changing
end sub
private sub dtpCarInTime_GE_Change()
  Changing
end sub
private sub dtpCarInTime_LE_Change()
  Changing
end sub
private sub dtpCarOutTime_GE_Change()
  Changing
end sub
private sub dtpCarOutTime_LE_Change()
  Changing
end sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

  txtTheCLient.Tag = &quot;&quot; 
  txtTheCLient = &quot;&quot; 
 LoadBtnPictures cmdTheCLient,cmdTheCLient.tag
  cmdTheCLient.RemoveAllMenu
  txtTheDogovor.Tag = &quot;&quot; 
  txtTheDogovor = &quot;&quot; 
 LoadBtnPictures cmdTheDogovor,cmdTheDogovor.tag
  cmdTheDogovor.RemoveAllMenu
dtpTheDate_GE = date
dtpTheDate_LE = date
txtSupplier = &quot;&quot;
txtCarNum = &quot;&quot;
txtCar2Num = &quot;&quot;
txtTheContainer = &quot;&quot;
txtTTNNum = &quot;&quot;
dtpTTNDate_GE = date
dtpTTNDate_LE = date
txtPlombNum = &quot;&quot;
dtpCarInTime_GE = now
dtpCarInTime_LE = now
dtpCarOutTime_GE = now
dtpCarOutTime_LE = now
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpIN" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheCLient"/><Properties Name="Caption" PropValue="Клиент:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheCLient"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheCLient"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="405"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Клиент"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDogovor"/><Properties Name="Caption" PropValue="Договор:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheDogovor"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheDogovor"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="1110"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Договор"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_GE"/><Properties Name="Caption" PropValue="Номер заказа больше или равно:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_GE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер заказа больше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_LE"/><Properties Name="Caption" PropValue="Номер заказа меньше или равно:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_LE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер заказа меньше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_GE"/><Properties Name="Caption" PropValue="Дата заказа C:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_GE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата заказа C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_LE"/><Properties Name="Caption" PropValue="Дата заказа по:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_LE"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата заказа по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheComment"/><Properties Name="Caption" PropValue="Примечание:"/><Properties Name="Top" PropValue="4305"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheComment"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="4635"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="1200"/><Properties Name="Width" PropValue="3000"/><Properties Name="Multiline" PropValue="True"/><Properties Name="Scrollbars" PropValue="2"/><Properties Name="ToolTipText" PropValue="Примечание"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblSupplier"/><Properties Name="Caption" PropValue="Поставщик:"/><Properties Name="Top" PropValue="5910"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtSupplier"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="6240"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="Поставщик"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarNum"/><Properties Name="Caption" PropValue="Номер ТС:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtCarNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер ТС"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCar2Num"/><Properties Name="Caption" PropValue="Номер прицепа:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtCar2Num"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер прицепа"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheContainer"/><Properties Name="Caption" PropValue="Номер контейнера:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheContainer"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="20"/><Properties Name="ToolTipText" PropValue="Номер контейнера"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNNum"/><Properties Name="Caption" PropValue="Номер ТТН:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTTNNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="50"/><Properties Name="ToolTipText" PropValue="Номер ТТН"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNDate_GE"/><Properties Name="Caption" PropValue="Дата ТТН C:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTTNDate_GE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата ТТН C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTTNDate_LE"/><Properties Name="Caption" PropValue="Дата ТТН по:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTTNDate_LE"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата ТТН по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblPlombNum"/><Properties Name="Caption" PropValue="Номер пломбы:"/><Properties Name="Top" PropValue="4305"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtPlombNum"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="4635"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="50"/><Properties Name="ToolTipText" PropValue="Номер пломбы"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarInTime_GE"/><Properties Name="Caption" PropValue="Время прибытия машины C:"/><Properties Name="Top" PropValue="5010"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarInTime_GE"/><Properties Name="Top" PropValue="5340"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время прибытия машины C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarInTime_LE"/><Properties Name="Caption" PropValue="Время прибытия машины по:"/><Properties Name="Top" PropValue="5715"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarInTime_LE"/><Properties Name="Top" PropValue="6045"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время прибытия машины по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarOutTime_GE"/><Properties Name="Caption" PropValue="Время убытия машины C:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarOutTime_GE"/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время убытия машины C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblCarOutTime_LE"/><Properties Name="Caption" PropValue="Время убытия машины по:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpCarOutTime_LE"/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="6600"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Время убытия машины по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Заказ на приемку"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpIN&quot;, &quot;fctlwpIN&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheCLient_Change()
  Changing
end sub
private sub cmdTheCLient_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpCli_def&quot;, id, brief) Then
          txtTheCLient.Tag = Left(id, 38)
          txtTheCLient = brief
        End If
end sub
private sub cmdTheCLient_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheDogovor_Change()
  Changing
end sub
private sub cmdTheDogovor_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpDog_def&quot;, id, brief) Then
          txtTheDogovor.Tag = Left(id, 38)
          txtTheDogovor = brief
        End If
end sub
private sub cmdTheDogovor_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheNumber_GE_Validate(cancel as boolean)
if txtTheNumber_GE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_GE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_GE.text) &lt;&gt;clng(Val(txtTheNumber_GE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_GE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_GE_Change()
  Changing
end sub
private sub txtTheNumber_LE_Validate(cancel as boolean)
if txtTheNumber_LE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_LE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_LE.text) &lt;&gt;clng(Val(txtTheNumber_LE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_LE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_LE_Change()
  Changing
end sub
private sub dtpTheDate_GE_Change()
  Changing
end sub
private sub dtpTheDate_LE_Change()
  Changing
end sub
private sub txtTheComment_Change()
  Changing
end sub
private sub txtSupplier_Change()
  Changing
end sub
private sub txtCarNum_Change()
  Changing
end sub
private sub txtCar2Num_Change()
  Changing
end sub
private sub txtTheContainer_Change()
  Changing
end sub
private sub txtTTNNum_Change()
  Changing
end sub
private sub dtpTTNDate_GE_Change()
  Changing
end sub
private sub dtpTTNDate_LE_Change()
  Changing
end sub
private sub txtPlombNum_Change()
  Changing
end sub
private sub dtpCarInTime_GE_Change()
  Changing
end sub
private sub dtpCarInTime_LE_Change()
  Changing
end sub
private sub dtpCarOutTime_GE_Change()
  Changing
end sub
private sub dtpCarOutTime_LE_Change()
  Changing
end sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

  txtTheCLient.Tag = &quot;&quot; 
  txtTheCLient = &quot;&quot; 
 LoadBtnPictures cmdTheCLient,cmdTheCLient.tag
  cmdTheCLient.RemoveAllMenu
  txtTheDogovor.Tag = &quot;&quot; 
  txtTheDogovor = &quot;&quot; 
 LoadBtnPictures cmdTheDogovor,cmdTheDogovor.tag
  cmdTheDogovor.RemoveAllMenu
dtpTheDate_GE = date
dtpTheDate_LE = date
txtSupplier = &quot;&quot;
txtCarNum = &quot;&quot;
txtCar2Num = &quot;&quot;
txtTheContainer = &quot;&quot;
txtTTNNum = &quot;&quot;
dtpTTNDate_GE = date
dtpTTNDate_LE = date
txtPlombNum = &quot;&quot;
dtpCarInTime_GE = now
dtpCarInTime_LE = now
dtpCarOutTime_GE = now
dtpCarOutTime_LE = now
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpCLI" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblShortName"/><Properties Name="Caption" PropValue="Краткое наименование:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtShortName"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="Краткое наименование"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblFullName"/><Properties Name="Caption" PropValue="Полное наименование:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtFullName"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="Полное наименование"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblINN"/><Properties Name="Caption" PropValue="ИНН:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtINN"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="11"/><Properties Name="ToolTipText" PropValue="ИНН"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblKPP"/><Properties Name="Caption" PropValue="КПП:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtKPP"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="12"/><Properties Name="ToolTipText" PropValue="КПП"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblUrAddr"/><Properties Name="Caption" PropValue="Юр. адрес:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtUrAddr"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="1200"/><Properties Name="Width" PropValue="3000"/><Properties Name="Multiline" PropValue="True"/><Properties Name="Scrollbars" PropValue="2"/><Properties Name="ToolTipText" PropValue="Юр. адрес"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblpostAddr"/><Properties Name="Caption" PropValue="Почтовый адрес:"/><Properties Name="Top" PropValue="4500"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtpostAddr"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="4830"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="1200"/><Properties Name="Width" PropValue="3000"/><Properties Name="Multiline" PropValue="True"/><Properties Name="Scrollbars" PropValue="2"/><Properties Name="ToolTipText" PropValue="Почтовый адрес"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblPhone"/><Properties Name="Caption" PropValue="Телефон:"/><Properties Name="Top" PropValue="6105"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtPhone"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="6435"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="80"/><Properties Name="ToolTipText" PropValue="Телефон"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheFax"/><Properties Name="Caption" PropValue="Факс:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheFax"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="80"/><Properties Name="ToolTipText" PropValue="Факс"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblemail"/><Properties Name="Caption" PropValue="E-MAIL:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtemail"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="80"/><Properties Name="ToolTipText" PropValue="E-MAIL"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblWEBSiteURL"/><Properties Name="Caption" PropValue="WEB:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtWEBSiteURL"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="80"/><Properties Name="ToolTipText" PropValue="WEB"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblFIODirector"/><Properties Name="Caption" PropValue="ФИО директора:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtFIODirector"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="ФИО директора"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblFIOBuh"/><Properties Name="Caption" PropValue="ФИО гл. Бухгалтера:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtFIOBuh"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="3450"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="255"/><Properties Name="ToolTipText" PropValue="ФИО гл. Бухгалтера"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Контрагет"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpCLI&quot;, &quot;fctlwpCLI&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtShortName_Change()
  Changing
end sub
private sub txtFullName_Change()
  Changing
end sub
private sub txtINN_Change()
  Changing
end sub
private sub txtKPP_Change()
  Changing
end sub
private sub txtUrAddr_Change()
  Changing
end sub
private sub txtpostAddr_Change()
  Changing
end sub
private sub txtPhone_Change()
  Changing
end sub
private sub txtTheFax_Change()
  Changing
end sub
private sub txtemail_Change()
  Changing
end sub
private sub txtWEBSiteURL_Change()
  Changing
end sub
private sub txtFIODirector_Change()
  Changing
end sub
private sub txtFIOBuh_Change()
  Changing
end sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

txtShortName = &quot;&quot;
txtFullName = &quot;&quot;
txtINN = &quot;&quot;
txtKPP = &quot;&quot;
txtPhone = &quot;&quot;
txtTheFax = &quot;&quot;
txtemail = &quot;&quot;
txtWEBSiteURL = &quot;&quot;
txtFIODirector = &quot;&quot;
txtFIOBuh = &quot;&quot;
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpOpt" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_GE"/><Properties Name="Caption" PropValue="Номер документа больше или равно:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_GE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер документа больше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber_LE"/><Properties Name="Caption" PropValue="Номер документа меньше или равно:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber_LE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Номер документа меньше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="15"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_GE"/><Properties Name="Caption" PropValue="Дата документа C:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_GE"/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата документа C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheDate_LE"/><Properties Name="Caption" PropValue="Дата документа по:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpTheDate_LE"/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата документа по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy"/><Properties Name="Width" PropValue="1800"/><Properties Name="CheckBox" PropValue="False"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Оптимизация"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpOpt&quot;, &quot;fctlwpOpt&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheNumber_GE_Validate(cancel as boolean)
if txtTheNumber_GE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_GE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_GE.text) &lt;&gt;clng(Val(txtTheNumber_GE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_GE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_GE_Change()
  Changing
end sub
private sub txtTheNumber_LE_Validate(cancel as boolean)
if txtTheNumber_LE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheNumber_LE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheNumber_LE.text) &lt;&gt;clng(Val(txtTheNumber_LE.text)) then 
     cancel=true 
     msgbox &quot;Ожидалось целое число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheNumber_LE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheNumber_LE_Change()
  Changing
end sub
private sub dtpTheDate_GE_Change()
  Changing
end sub
private sub dtpTheDate_LE_Change()
  Changing
end sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

dtpTheDate_GE = date
dtpTheDate_LE = date
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="frmwpPal" File=""><AttributeHolder Name="Type" Value="form"/><BlockHolder BlockName="'form" BlockCode=""><AttributeHolder Name="Type" Value="form"/><FormData Name=""><ControlData Name="cmdOK" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdOK"/><Properties Name="Caption" PropValue="OK"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Применить фильтр"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="cmdCancel" ControlIndex="0" PROGID="VB.CommandButton"><Properties Name="Name" PropValue="cmdCancel"/><Properties Name="Caption" PropValue="Отмена"/><Properties Name="Tag" PropValue=""/><Properties Name="ToolTipText" PropValue="Отказ от задания фильтра"/><Properties Name="UseMaskColor" PropValue="True"/><Properties Name="Height" PropValue="330"/><Properties Name="Width" PropValue="750"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/></ControlData><ControlData Name="mnuCtl" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="mnuCtl"/><Properties Name="Name" PropValue="mnuCtl"/><Properties Name="Visible" PropValue="False"/><ControlData Name="mnuSetup" ControlIndex="0" PROGID="VB.Menu"><Properties Name="Caption" PropValue="Настройка"/><Properties Name="Name" PropValue="mnuSetup"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Visible" PropValue="True"/></ControlData></ControlData><ControlData Name="ts" ControlIndex="0" PROGID="mscomctllib.tabstrip"><Properties Name="Name" PropValue="ts"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Width" PropValue="1500"/><Properties Name="Height" PropValue="1500"/></ControlData><ControlData Name="PanelfGroup" ControlIndex="0" PROGID="MTZ_panel.Scrolledwindow"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="PanelfGroup"/><Properties Name="Top" PropValue="0"/><Properties Name="Left" PropValue="0"/><Properties Name="Height" PropValue="1000"/><Properties Name="Width" PropValue="1000"/><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheNumber"/><Properties Name="Caption" PropValue="Номер паллеты:"/><Properties Name="Top" PropValue="75"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheNumber"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="405"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="MaxLength" PropValue="10"/><Properties Name="ToolTipText" PropValue="Номер паллеты"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheWeight_GE"/><Properties Name="Caption" PropValue="Вес паллеты больше или равно:"/><Properties Name="Top" PropValue="780"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheWeight_GE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1110"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Вес паллеты больше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="27"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheWeight_LE"/><Properties Name="Caption" PropValue="Вес паллеты меньше или равно:"/><Properties Name="Top" PropValue="1485"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheWeight_LE"/><Properties Name="Text" PropValue=""/><Properties Name="Top" PropValue="1815"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="1800"/><Properties Name="ToolTipText" PropValue="Вес паллеты меньше или равно"/><Properties Name="CausesValidation" PropValue="True"/><Properties Name="Locked" PropValue="False"/><Properties Name="Enabled" PropValue="True"/><Properties Name="MaxLength" PropValue="27"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblWeightingDate_GE"/><Properties Name="Caption" PropValue="Дата взвешивания C:"/><Properties Name="Top" PropValue="2190"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpWeightingDate_GE"/><Properties Name="Top" PropValue="2520"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата взвешивания C"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblWeightingDate_LE"/><Properties Name="Caption" PropValue="Дата взвешивания по:"/><Properties Name="Top" PropValue="2895"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MSComCtl2.DTPicker"><Properties Name="NAME" PropValue="dtpWeightingDate_LE"/><Properties Name="Top" PropValue="3225"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Format" PropValue="3"/><Properties Name="Enabled" PropValue="True"/><Properties Name="ToolTipText" PropValue="Дата взвешивания по"/><Properties Name="CustomFormat" PropValue="dd/MM/yyyy HH:mm:ss"/><Properties Name="Width" PropValue="2250"/><Properties Name="CheckBox" PropValue="False"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblpalType"/><Properties Name="Caption" PropValue="Тип паллеты:"/><Properties Name="Top" PropValue="3600"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtpalType"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="3930"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Тип паллеты"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdpalType"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="3930"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Тип паллеты"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblLockedForIn"/><Properties Name="Caption" PropValue="Заблокирована для приемки:"/><Properties Name="Top" PropValue="4305"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtLockedForIn"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="4635"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Заблокирована для приемки"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdLockedForIn"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="4635"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Заблокирована для приемки"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblLockedForOut"/><Properties Name="Caption" PropValue="Заблокирована для отгрузки:"/><Properties Name="Top" PropValue="5010"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtLockedForOut"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="5340"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Заблокирована для отгрузки"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdLockedForOut"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="5340"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Заблокирована для отгрузки"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.CheckBox"><Properties Name="BackStyle" PropValue="0"/><Properties Name="NAME" PropValue="lblTheCell"/><Properties Name="Caption" PropValue="Текущая ячейка:"/><Properties Name="Top" PropValue="5715"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="3000"/><Properties Name="ForeColor" PropValue="0"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="VB.textbox"><Properties Name="NAME" PropValue="txtTheCell"/><Properties Name="Text" PropValue=""/><Properties Name="Locked" PropValue="True"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Top" PropValue="6045"/><Properties Name="Left" PropValue="300"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="2550"/><Properties Name="ToolTipText" PropValue="Текущая ячейка"/></ControlData><ControlData Name="" ControlIndex="0" PROGID="MTZ_PANEL.DropButton"><Properties Name="NAME" PropValue="cmdTheCell"/><Properties Name="Caption" PropValue=""/><Properties Name="Tag" PropValue="refopen.ico"/><Properties Name="Top" PropValue="6045"/><Properties Name="Enabled" PropValue="True"/><Properties Name="Left" PropValue="2850"/><Properties Name="Height" PropValue="300"/><Properties Name="Width" PropValue="450"/><Properties Name="ToolTipText" PropValue="Текущая ячейка"/></ControlData></ControlData><PropertyData Name="tag" PropValue="Card.ICO"/><PropertyData Name="caption" PropValue="Фильтр для Паллета"/><PropertyData Name="ShowInTaskBar" PropValue="True"/></FormData></BlockHolder><BlockHolder BlockName="'description" BlockCode="Public Item as object
public OK as boolean
private OnInit as boolean
public event Changed
Private TSCustom As MTZ_CUSTOMTAB.TabStripCustomizer



"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
Private Sub cmdOK_Click()
    on error resume next 
    OK = true
    me.hide
End Sub
Private Sub cmdCancel_Click()
    on error resume next 
    OK = false
    me.hide
End Sub
public sub Init( ObjItem as object)
 set Item = objItem
 if Item is nothing then set Item =Myuser.application
 TInit
end sub
Private Sub Form_Load()
  on error resume next
  Dim ff As Long, buf As String
  LoadFromSkin me
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  if Item is nothing then Init Myuser.Application
End Sub
Private Sub Form_Unload(Cancel As Integer)
  on error resume next
  set item=nothing
  Set TSCustom = Nothing
  SaveToSkin me
  exit sub
bye:
  msgbox err.description,vbokonly
  cancel = -1
End Sub
private sub Form_Resize()
 if me.windowstate =1 then exit sub
 on error resume next
  ts.Move 0,0,Me.ScaleWidth,Me.ScaleHeight-cmdOK.height
  cmdOK.Move Me.ScaleWidth - 110 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdok.width,cmdok.height
  cmdCancel.Move Me.ScaleWidth - 55 * screen.twipsperpixelx,Me.ScaleHeight-cmdOK.height,cmdcancel.width,cmdok.height
  ts_click
end sub
Private Sub mnuSetup_Click()
TSCustom.Setup ts
End Sub
Private Sub ts_MouseUp(Button As Integer, Shift As Integer, X As Single, Y As Single)
  If Button = 2 And Shift = 0 Then
    PopupMenu mnuCtl
  End If
End Sub
private sub ts_click()
  on error resume next
  panelfGroup.Visible = False

   Select Case ts.SelectedItem.Key
   Case &quot;fGroup&quot;
     With panelfGroup
     .Top = ts.ClientTop
     .Left = ts.ClientLeft
     .Width = ts.ClientWidth
     .Height = ts.ClientHeight
     .Visible = True
     .ZOrder 0
     End With
     End select
end sub
private sub TInit()
  on error resume next
  Dim ff As Long, buf As String

ts.Tabs.Item(1).Caption = &quot;Описание&quot;
ts.Tabs.Item(1).key = &quot;fGroup&quot;
panelfGroupInit
  Set TSCustom = New MTZ_CUSTOMTAB.TabStripCustomizer
  TSCustom.Init ts, &quot;wpPal&quot;, &quot;fctlwpPal&quot;
  TSCustom.SetupFromRegistry ts
 ts_click
end sub


private sub Changing
if OnInit then exit sub
 raiseevent Changed()
end sub
private sub txtTheNumber_Change()
  Changing
end sub
private sub txtTheWeight_GE_Validate(cancel as boolean)
if txtTheWeight_GE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheWeight_GE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheWeight_GE.text) &lt; -922337203685477.5808 or Val(txtTheWeight_GE.text)&gt;+922337203685477.5807 then 
     cancel=true 
     msgbox &quot;Значение вне допустимого диапазона&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheWeight_GE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheWeight_GE_Change()
  Changing
end sub
private sub txtTheWeight_LE_Validate(cancel as boolean)
if txtTheWeight_LE.text&lt;&gt;&quot;&quot; then 
 on error resume next 
  if not isnumeric(txtTheWeight_LE.text) then 
     cancel=true 
     msgbox &quot;Ожидалось число&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  elseif Val(txtTheWeight_LE.text) &lt; -922337203685477.5808 or Val(txtTheWeight_LE.text)&gt;+922337203685477.5807 then 
     cancel=true 
     msgbox &quot;Значение вне допустимого диапазона&quot;,vbokonly+vbexclamation,&quot;Внимание&quot; 
  end if
end if
end sub
Private Sub txtTheWeight_LE_KeyPess(KeyAscii As Integer)
Dim s As String
s = &quot;0123456789.,-&quot; &amp; Chr(8)
If InStr(s, Chr(KeyAscii)) &gt; 0 Then Exit Sub
KeyAscii = 0

End Sub
private sub txtTheWeight_LE_Change()
  Changing
end sub
private sub dtpWeightingDate_GE_Change()
  Changing
end sub
private sub dtpWeightingDate_LE_Change()
  Changing
end sub
private sub txtpalType_Change()
  Changing
end sub
private sub cmdpalType_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpDic_paltype&quot;, id, brief) Then
          txtpalType.Tag = Left(id, 38)
          txtpalType = brief
        End If
end sub
private sub cmdpalType_MenuClick(ByVal sCaption As String)
End sub
private sub txtLockedForIn_Change()
  Changing
end sub
private sub cmdLockedForIn_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpIn_def&quot;, id, brief) Then
          txtLockedForIn.Tag = Left(id, 38)
          txtLockedForIn = brief
        End If
end sub
private sub cmdLockedForIn_MenuClick(ByVal sCaption As String)
End sub
private sub txtLockedForOut_Change()
  Changing
end sub
private sub cmdLockedForOut_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpOut_def&quot;, id, brief) Then
          txtLockedForOut.Tag = Left(id, 38)
          txtLockedForOut = brief
        End If
end sub
private sub cmdLockedForOut_MenuClick(ByVal sCaption As String)
End sub
private sub txtTheCell_Change()
  Changing
end sub
private sub cmdTheCell_Click()
  on error resume next
        Dim id As String, brief As String
        If item.Application.Manager.GetReferenceDialogEx2(&quot;wpcell_cell&quot;, id, brief) Then
          txtTheCell.Tag = Left(id, 38)
          txtTheCell = brief
        End If
end sub
private sub cmdTheCell_MenuClick(ByVal sCaption As String)
End sub
private sub PanelfGroupInit()
OnInit = true
dim iii as long ' for combo only

txtTheNumber = &quot;&quot;
dtpWeightingDate_GE = now
dtpWeightingDate_LE = now
  txtpalType.Tag = &quot;&quot; 
  txtpalType = &quot;&quot; 
 LoadBtnPictures cmdpalType,cmdpalType.tag
  cmdpalType.RemoveAllMenu
  txtLockedForIn.Tag = &quot;&quot; 
  txtLockedForIn = &quot;&quot; 
 LoadBtnPictures cmdLockedForIn,cmdLockedForIn.tag
  cmdLockedForIn.RemoveAllMenu
  txtLockedForOut.Tag = &quot;&quot; 
  txtLockedForOut = &quot;&quot; 
 LoadBtnPictures cmdLockedForOut,cmdLockedForOut.tag
  cmdLockedForOut.RemoveAllMenu
  txtTheCell.Tag = &quot;&quot; 
  txtTheCell = &quot;&quot; 
 LoadBtnPictures cmdTheCell,cmdTheCell.tag
  cmdTheCell.RemoveAllMenu
OnInit = false
end sub

"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder><ModuleHolder ModuleName="Util" File=""><AttributeHolder Name="Instancing" Value="private"/><AttributeHolder Name="Type" Value="module"/><BlockHolder BlockName="'description" BlockCode="

"><AttributeHolder Name="Type" Value="description"/><FormData Name=""/></BlockHolder><BlockHolder BlockName="'codebody" BlockCode="
public sub LoadFromSkin( frm as form )
  on error resume next
  Dim s As String, arr() as string
  s = GetSetting(&quot;MTZ&quot;, &quot;CONFIG&quot;, &quot;LAYOUTS&quot;, &quot;&quot;)
  If s = &quot;&quot; Then Exit Sub
  Dim ff As Long, buf As String
  ff = FreeFile
  Open s &amp; frm.name For Input As #ff
  buf = Input(LOF(ff), ff)
  Close #ff
  arr = split(buf, vbcrlf)
  Dim arr2() As String, i as long
For i = 0 To UBound(arr)
  arr2 = Split(arr(i), &quot;:&quot;)
  Select Case arr2(0)
  case &quot;FormTag&quot;
    frm.Tag = arr2(1)
  Case &quot;FormTop&quot;
    frm.Top = arr2(1)
  Case &quot;FormLeft&quot;
    frm.left = arr2(1)
  Case &quot;FormWidth&quot;
    frm.Width = arr2(1)
  Case &quot;FormHeight&quot;
    frm.Height = arr2(1)
  Case Else
    frm.Controls(arr2(0)).tag = Val(arr2(1))
  End Select
Next
  s =&quot;&quot; 
  s = GetSetting(&quot;MTZ&quot;, &quot;CONFIG&quot;, &quot;IMAGEPATH&quot;, &quot;&quot;)
  If s = &quot;&quot; Then Exit Sub
  set frm.icon = LoadPicture(s &amp; frm.tag)
end sub

public sub SaveToSkin( frm as form )
  on error resume next
  Dim s As String, buf as string
  s = GetSetting(&quot;MTZ&quot;, &quot;CONFIG&quot;, &quot;LAYOUTS&quot;, &quot;&quot;)
  If s = &quot;&quot; Then Exit Sub
  frm.WindowState =0 
  Dim ff As Long
  ff = FreeFile
  kill s &amp; frm.name
  Open s &amp; frm.name For output As #ff
  buf =  &quot;FormTag:&quot; &amp; frm.Tag 
  buf = buf &amp; vbcrlf &amp; &quot;FormTop:&quot; &amp; frm.Top 
  buf = buf &amp; vbCrLf &amp; &quot;FormLeft:&quot; &amp; frm.Left
  buf = buf &amp; vbCrLf &amp; &quot;FormWidth:&quot; &amp; frm.Width
  buf = buf &amp; vbCrLf &amp; &quot;FormHeight:&quot; &amp; frm.Height
  print #ff, buf
  Close #ff
end sub


"><AttributeHolder Name="Type" Value="code"/><FormData Name=""/></BlockHolder></ModuleHolder></root>
