VERSION 5.00
Object = "{F9043C88-F6F2-101A-A3C9-08002B2F49FB}#1.2#0"; "comdlg32.ocx"
Object = "{3B7C8863-D78F-101B-B9B5-04021C009402}#1.2#0"; "richtx32.ocx"
Begin VB.MDIForm frmMain 
   BackColor       =   &H8000000C&
   Caption         =   "Главное окно"
   ClientHeight    =   6705
   ClientLeft      =   165
   ClientTop       =   735
   ClientWidth     =   8760
   Icon            =   "frmMain.frx":0000
   LinkTopic       =   "MDIForm1"
   StartUpPosition =   3  'Windows Default
   WindowState     =   2  'Maximized
   Begin VB.PictureBox Picture1 
      Align           =   2  'Align Bottom
      Height          =   975
      Left            =   0
      ScaleHeight     =   915
      ScaleWidth      =   8700
      TabIndex        =   0
      Top             =   5730
      Visible         =   0   'False
      Width           =   8760
      Begin RichTextLib.RichTextBox rtf 
         Height          =   495
         Left            =   360
         TabIndex        =   1
         Top             =   600
         Width           =   2295
         _ExtentX        =   4048
         _ExtentY        =   873
         _Version        =   393217
         TextRTF         =   $"frmMain.frx":030A
      End
   End
   Begin VB.Timer MenuTimer 
      Enabled         =   0   'False
      Interval        =   1
      Left            =   2355
      Top             =   840
   End
   Begin VB.Timer Timer2 
      Interval        =   60000
      Left            =   1665
      Top             =   855
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Interval        =   10000
      Left            =   1080
      Top             =   840
   End
   Begin MSComDlg.CommonDialog cdlg 
      Left            =   240
      Top             =   840
      _ExtentX        =   847
      _ExtentY        =   847
      _Version        =   393216
   End
   Begin VB.Menu mnuWin 
      Caption         =   "Окно"
      WindowList      =   -1  'True
      Begin VB.Menu mnuAbout 
         Caption         =   "О программе"
      End
      Begin VB.Menu mnuCascade 
         Caption         =   "Каскад"
      End
      Begin VB.Menu mnuTileVert 
         Caption         =   "Разложить вертикально"
      End
      Begin VB.Menu mnuTileHor 
         Caption         =   "Разложить горизонтально"
      End
      Begin VB.Menu mnuArrangeIcon 
         Caption         =   "Разложить иконки"
      End
   End
   Begin VB.Menu mnuJRNL 
      Caption         =   "Журналы"
      Begin VB.Menu mnuPCB_MPP 
         Caption         =   "Задача на изготовление ПП"
         Begin VB.Menu mnuAllPCB_MPP 
            Caption         =   "Задача на изготовление ПП - все состояния"
         End
         Begin VB.Menu mnuPCB_MPP_1 
            Caption         =   "Задача на изготовление ПП :Завершена"
         End
         Begin VB.Menu mnuPCB_MPP_2 
            Caption         =   "Задача на изготовление ПП :Оценена"
         End
         Begin VB.Menu mnuPCB_MPP_3 
            Caption         =   "Задача на изготовление ПП :Принята"
         End
         Begin VB.Menu mnuPCB_MPP_4 
            Caption         =   "Задача на изготовление ПП :Подготовка"
         End
         Begin VB.Menu mnuPCB_MPP_5 
            Caption         =   "Задача на изготовление ПП :В Работе"
         End
         Begin VB.Menu mnuPCB_MPP_6 
            Caption         =   "Задача на изготовление ПП :Создание"
         End
         Begin VB.Menu mnuPCB_MPP_7 
            Caption         =   "Задача на изготовление ПП :Отмена"
         End
         Begin VB.Menu mnuPCB_MPP_8 
            Caption         =   "Задача на изготовление ПП :Оценить"
         End
      End
      Begin VB.Menu mnuPCB_TaskPP 
         Caption         =   "Задача на монтаж ПП"
         Begin VB.Menu mnuAllPCB_TaskPP 
            Caption         =   "Задача на монтаж ПП - все состояния"
         End
         Begin VB.Menu mnuPCB_TaskPP_1 
            Caption         =   "Задача на монтаж ПП :Создание"
         End
         Begin VB.Menu mnuPCB_TaskPP_2 
            Caption         =   "Задача на монтаж ПП :В Работе"
         End
         Begin VB.Menu mnuPCB_TaskPP_3 
            Caption         =   "Задача на монтаж ПП :Отмена"
         End
         Begin VB.Menu mnuPCB_TaskPP_4 
            Caption         =   "Задача на монтаж ПП :Завершена"
         End
         Begin VB.Menu mnuPCB_TaskPP_5 
            Caption         =   "Задача на монтаж ПП :Принята"
         End
         Begin VB.Menu mnuPCB_TaskPP_6 
            Caption         =   "Задача на монтаж ПП :Оценить"
         End
         Begin VB.Menu mnuPCB_TaskPP_7 
            Caption         =   "Задача на монтаж ПП :Подготовка"
         End
         Begin VB.Menu mnuPCB_TaskPP_8 
            Caption         =   "Задача на монтаж ПП :Оценена"
         End
      End
      Begin VB.Menu mnuPCB_OUtility 
         Caption         =   "Задача на поставку комплектующих"
         Begin VB.Menu mnuAllPCB_OUtility 
            Caption         =   "Задача на поставку комплектующих - все состояния"
         End
         Begin VB.Menu mnuPCB_OUtility_1 
            Caption         =   "Задача на поставку комплектующих :Оценена"
         End
         Begin VB.Menu mnuPCB_OUtility_2 
            Caption         =   "Задача на поставку комплектующих :Оценить"
         End
         Begin VB.Menu mnuPCB_OUtility_3 
            Caption         =   "Задача на поставку комплектующих :Принята"
         End
         Begin VB.Menu mnuPCB_OUtility_4 
            Caption         =   "Задача на поставку комплектующих :Отмена"
         End
         Begin VB.Menu mnuPCB_OUtility_5 
            Caption         =   "Задача на поставку комплектующих :Завершена"
         End
         Begin VB.Menu mnuPCB_OUtility_6 
            Caption         =   "Задача на поставку комплектующих :Подготовка"
         End
         Begin VB.Menu mnuPCB_OUtility_7 
            Caption         =   "Задача на поставку комплектующих :В Работе"
         End
         Begin VB.Menu mnuPCB_OUtility_8 
            Caption         =   "Задача на поставку комплектующих :Создание"
         End
      End
      Begin VB.Menu mnuPCB_PPP 
         Caption         =   "Задача на проектирование ПП"
         Begin VB.Menu mnuAllPCB_PPP 
            Caption         =   "Задача на проектирование ПП - все состояния"
         End
         Begin VB.Menu mnuPCB_PPP_1 
            Caption         =   "Задача на проектирование ПП :Создание"
         End
         Begin VB.Menu mnuPCB_PPP_2 
            Caption         =   "Задача на проектирование ПП :Отмена"
         End
         Begin VB.Menu mnuPCB_PPP_3 
            Caption         =   "Задача на проектирование ПП :В Работе"
         End
         Begin VB.Menu mnuPCB_PPP_4 
            Caption         =   "Задача на проектирование ПП :Подготовка"
         End
         Begin VB.Menu mnuPCB_PPP_5 
            Caption         =   "Задача на проектирование ПП :Принята"
         End
         Begin VB.Menu mnuPCB_PPP_6 
            Caption         =   "Задача на проектирование ПП :Оценить"
         End
         Begin VB.Menu mnuPCB_PPP_7 
            Caption         =   "Задача на проектирование ПП :Оценена"
         End
         Begin VB.Menu mnuPCB_PPP_8 
            Caption         =   "Задача на проектирование ПП :Завершена"
         End
      End
      Begin VB.Menu mnuPCB_Delivery 
         Caption         =   "Задача по доставке"
         Begin VB.Menu mnuAllPCB_Delivery 
            Caption         =   "Задача по доставке - все состояния"
         End
         Begin VB.Menu mnuPCB_Delivery_1 
            Caption         =   "Задача по доставке :В Работе"
         End
         Begin VB.Menu mnuPCB_Delivery_2 
            Caption         =   "Задача по доставке :Принята"
         End
         Begin VB.Menu mnuPCB_Delivery_3 
            Caption         =   "Задача по доставке :Оценена"
         End
         Begin VB.Menu mnuPCB_Delivery_4 
            Caption         =   "Задача по доставке :Подготовка"
         End
         Begin VB.Menu mnuPCB_Delivery_5 
            Caption         =   "Задача по доставке :Завершена"
         End
         Begin VB.Menu mnuPCB_Delivery_6 
            Caption         =   "Задача по доставке :Создание"
         End
         Begin VB.Menu mnuPCB_Delivery_7 
            Caption         =   "Задача по доставке :Оценить"
         End
         Begin VB.Menu mnuPCB_Delivery_8 
            Caption         =   "Задача по доставке :Отмена"
         End
      End
      Begin VB.Menu mnuPCB_Order 
         Caption         =   "Заказ"
         Begin VB.Menu mnuAllPCB_Order 
            Caption         =   "Заказ - все состояния"
         End
         Begin VB.Menu mnuPCB_Order_1 
            Caption         =   "Заказ :Подготовка"
         End
         Begin VB.Menu mnuPCB_Order_2 
            Caption         =   "Заказ :Создание"
         End
         Begin VB.Menu mnuPCB_Order_3 
            Caption         =   "Заказ :Отмена"
         End
         Begin VB.Menu mnuPCB_Order_4 
            Caption         =   "Заказ :Выполнен"
         End
         Begin VB.Menu mnuPCB_Order_5 
            Caption         =   "Заказ :В Работе"
         End
      End
      Begin VB.Menu mnuPCB_Customer 
         Caption         =   "Заказчик"
      End
      Begin VB.Menu mnuPCB_Request 
         Caption         =   "Запрос"
         Begin VB.Menu mnuAllPCB_Request 
            Caption         =   "Запрос - все состояния"
         End
         Begin VB.Menu mnuPCB_Request_1 
            Caption         =   "Запрос :Отказ"
         End
         Begin VB.Menu mnuPCB_Request_2 
            Caption         =   "Запрос :Оценка"
         End
         Begin VB.Menu mnuPCB_Request_3 
            Caption         =   "Запрос :Оформлен"
         End
         Begin VB.Menu mnuPCB_Request_4 
            Caption         =   "Запрос :Оценён"
         End
         Begin VB.Menu mnuPCB_Request_5 
            Caption         =   "Запрос :Создание"
         End
      End
      Begin VB.Menu mnuPCB_Protocol 
         Caption         =   "Протокол"
      End
      Begin VB.Menu mnuPCB_Invoice 
         Caption         =   "Счёт"
         Begin VB.Menu mnuAllPCB_Invoice 
            Caption         =   "Счёт - все состояния"
         End
         Begin VB.Menu mnuPCB_Invoice_1 
            Caption         =   "Счёт :Частично оплачен"
         End
         Begin VB.Menu mnuPCB_Invoice_2 
            Caption         =   "Счёт :Создание"
         End
         Begin VB.Menu mnuPCB_Invoice_3 
            Caption         =   "Счёт :Закрыт"
         End
         Begin VB.Menu mnuPCB_Invoice_4 
            Caption         =   "Счёт :Оплачен"
         End
         Begin VB.Menu mnuPCB_Invoice_5 
            Caption         =   "Счёт :Выставлен"
         End
         Begin VB.Menu mnuPCB_Invoice_6 
            Caption         =   "Счёт :Отменён"
         End
         Begin VB.Menu mnuPCB_Invoice_7 
            Caption         =   "Счёт :Частично закрыт"
         End
      End
      Begin VB.Menu mnuPCB_File 
         Caption         =   "Файл"
      End
      Begin VB.Menu mnuROLES 
         Caption         =   "Роли"
      End
   End
   Begin VB.Menu mnuDictionary 
      Caption         =   "Справочники"
      Begin VB.Menu mnuPCB_Info 
         Caption         =   "PCB Professional"
      End
      Begin VB.Menu mnuPCB_Dict 
         Caption         =   "PCB справочники"
      End
      Begin VB.Menu mnuPCB_DICT_COM 
         Caption         =   "PCB Справочники общие"
      End
      Begin VB.Menu mnuPCB_Reports 
         Caption         =   "Отчёты"
      End
      Begin VB.Menu mnuMTZUsers 
         Caption         =   "Справочник: пользователи"
      End
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit


'%%%JOURNALPLACEHOLDER%%%
'sample: Dim WithEvents fDog As frmJournalShow

'%%%REPORTPLACEHOLDER%%%
'sample: Public RptResult As ReportShow

'Dim ObjectToReport As Object

Dim frmFind As Form
Dim frmFindFT As Form

Dim inTimer1 As Boolean
Dim inTimer2 As Boolean
Dim OnLoad As Boolean
Dim DelayedCommand As String

Private Declare Sub ExitProcess Lib "kernel32" (ByVal uExitCode As Long)

Dim WithEvents jfmnuAllPCB_MPP As frmJournalShow
Attribute jfmnuAllPCB_MPP.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_1 As frmJournalShow
Attribute jfmnuPCB_MPP_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_2 As frmJournalShow
Attribute jfmnuPCB_MPP_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_3 As frmJournalShow
Attribute jfmnuPCB_MPP_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_4 As frmJournalShow
Attribute jfmnuPCB_MPP_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_5 As frmJournalShow
Attribute jfmnuPCB_MPP_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_6 As frmJournalShow
Attribute jfmnuPCB_MPP_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_7 As frmJournalShow
Attribute jfmnuPCB_MPP_7.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_MPP_8 As frmJournalShow
Attribute jfmnuPCB_MPP_8.VB_VarHelpID = -1



Dim WithEvents jfmnuAllPCB_TaskPP As frmJournalShow
Attribute jfmnuAllPCB_TaskPP.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_1 As frmJournalShow
Attribute jfmnuPCB_TaskPP_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_2 As frmJournalShow
Attribute jfmnuPCB_TaskPP_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_3 As frmJournalShow
Attribute jfmnuPCB_TaskPP_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_4 As frmJournalShow
Attribute jfmnuPCB_TaskPP_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_5 As frmJournalShow
Attribute jfmnuPCB_TaskPP_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_6 As frmJournalShow
Attribute jfmnuPCB_TaskPP_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_7 As frmJournalShow
Attribute jfmnuPCB_TaskPP_7.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_TaskPP_8 As frmJournalShow
Attribute jfmnuPCB_TaskPP_8.VB_VarHelpID = -1



Dim WithEvents jfmnuAllPCB_OUtility As frmJournalShow
Attribute jfmnuAllPCB_OUtility.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_1 As frmJournalShow
Attribute jfmnuPCB_OUtility_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_2 As frmJournalShow
Attribute jfmnuPCB_OUtility_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_3 As frmJournalShow
Attribute jfmnuPCB_OUtility_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_4 As frmJournalShow
Attribute jfmnuPCB_OUtility_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_5 As frmJournalShow
Attribute jfmnuPCB_OUtility_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_6 As frmJournalShow
Attribute jfmnuPCB_OUtility_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_7 As frmJournalShow
Attribute jfmnuPCB_OUtility_7.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_OUtility_8 As frmJournalShow
Attribute jfmnuPCB_OUtility_8.VB_VarHelpID = -1



Dim WithEvents jfmnuAllPCB_PPP As frmJournalShow
Attribute jfmnuAllPCB_PPP.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_1 As frmJournalShow
Attribute jfmnuPCB_PPP_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_2 As frmJournalShow
Attribute jfmnuPCB_PPP_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_3 As frmJournalShow
Attribute jfmnuPCB_PPP_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_4 As frmJournalShow
Attribute jfmnuPCB_PPP_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_5 As frmJournalShow
Attribute jfmnuPCB_PPP_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_6 As frmJournalShow
Attribute jfmnuPCB_PPP_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_7 As frmJournalShow
Attribute jfmnuPCB_PPP_7.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_PPP_8 As frmJournalShow
Attribute jfmnuPCB_PPP_8.VB_VarHelpID = -1



Dim WithEvents jfmnuAllPCB_Delivery As frmJournalShow
Attribute jfmnuAllPCB_Delivery.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_1 As frmJournalShow
Attribute jfmnuPCB_Delivery_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_2 As frmJournalShow
Attribute jfmnuPCB_Delivery_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_3 As frmJournalShow
Attribute jfmnuPCB_Delivery_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_4 As frmJournalShow
Attribute jfmnuPCB_Delivery_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_5 As frmJournalShow
Attribute jfmnuPCB_Delivery_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_6 As frmJournalShow
Attribute jfmnuPCB_Delivery_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_7 As frmJournalShow
Attribute jfmnuPCB_Delivery_7.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Delivery_8 As frmJournalShow
Attribute jfmnuPCB_Delivery_8.VB_VarHelpID = -1



Dim WithEvents jfmnuAllPCB_Order As frmJournalShow
Attribute jfmnuAllPCB_Order.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Order_1 As frmJournalShow
Attribute jfmnuPCB_Order_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Order_2 As frmJournalShow
Attribute jfmnuPCB_Order_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Order_3 As frmJournalShow
Attribute jfmnuPCB_Order_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Order_4 As frmJournalShow
Attribute jfmnuPCB_Order_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Order_5 As frmJournalShow
Attribute jfmnuPCB_Order_5.VB_VarHelpID = -1



Dim WithEvents jfmnuPCB_Customer As frmJournalShow
Attribute jfmnuPCB_Customer.VB_VarHelpID = -1

Dim WithEvents jfmnuAllPCB_Request As frmJournalShow
Attribute jfmnuAllPCB_Request.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Request_1 As frmJournalShow
Attribute jfmnuPCB_Request_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Request_2 As frmJournalShow
Attribute jfmnuPCB_Request_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Request_3 As frmJournalShow
Attribute jfmnuPCB_Request_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Request_4 As frmJournalShow
Attribute jfmnuPCB_Request_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Request_5 As frmJournalShow
Attribute jfmnuPCB_Request_5.VB_VarHelpID = -1



Dim WithEvents jfmnuPCB_Protocol As frmJournalShow
Attribute jfmnuPCB_Protocol.VB_VarHelpID = -1

Dim WithEvents jfmnuAllPCB_Invoice As frmJournalShow
Attribute jfmnuAllPCB_Invoice.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_1 As frmJournalShow
Attribute jfmnuPCB_Invoice_1.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_2 As frmJournalShow
Attribute jfmnuPCB_Invoice_2.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_3 As frmJournalShow
Attribute jfmnuPCB_Invoice_3.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_4 As frmJournalShow
Attribute jfmnuPCB_Invoice_4.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_5 As frmJournalShow
Attribute jfmnuPCB_Invoice_5.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_6 As frmJournalShow
Attribute jfmnuPCB_Invoice_6.VB_VarHelpID = -1

Dim WithEvents jfmnuPCB_Invoice_7 As frmJournalShow
Attribute jfmnuPCB_Invoice_7.VB_VarHelpID = -1



Dim WithEvents jfmnuPCB_File As frmJournalShow
Attribute jfmnuPCB_File.VB_VarHelpID = -1

Dim WithEvents jfmnuROLES As frmJournalShow
Attribute jfmnuROLES.VB_VarHelpID = -1





















Public Sub On_Load()
   Me.Caption = App.FileDescription & " (" & Site & "\" & MyRole.Name & "\" & MyUser.brief & ")"
   On Error Resume Next
   'If command$ <> "DEBUG" Then
     Dim c As Control
     For Each c In Me.Controls
      If TypeName(c) = "Menu" Then
         
        If CheckMenu(c.Name) = RoleMenuStatus_Hidden Then
          c.Visible = False
        Else
          frmSplash.lblWarning = "Инициализация меню: " & c.Caption
          DoEvents
        End If
      End If
     Next
  'End If
   Manager.FreeAllInstanses
End Sub

Private Sub MDIForm_Load()
On_Load
End Sub

Private Sub mdiForm_Unload(Cancel As Integer)
On Error Resume Next

' whait for finalize timer loops
inTimer1 = True
Me.Timer1.Enabled = False

inTimer2 = True
Me.Timer2.Enabled = False


Timer1.Enabled = False
Timer2.Enabled = False

On Error Resume Next

' unload all dynamically created journals and reports
UnloadObjects

If Not frmFind Is Nothing Then
  Unload frmFind
End If
Set frmFind = Nothing

If Not frmFindFT Is Nothing Then
  Unload frmFindFT
End If
Set frmFindFT = Nothing



Dim f As Form
For Each f In Forms
  If f.MDIChild = True Then
    On Error Resume Next
    'Call f.Controls.Item(0).object.Init(Nothing, Nothing, False, Nothing)
    Unload f
  End If
Next

  For Each f In Forms
      On Error Resume Next
      Debug.Print f.Name
  Next
  
  
  Set MyRole = Nothing
  Set MyUser = Nothing
  Set usr = Nothing


  Session.Logout
  Set Session = Nothing
  Manager.CloseClass
  Set Manager = Nothing

  If Command$ <> "DEBUG" Then
   TerminateProcess GetCurrentProcess, 0
  'Else
  ' End
  End If
End Sub


Private Sub mnuAbout_Click()
frmAbout.Show vbModal, Me
End Sub



Private Sub mnuArrangeIcon_Click()
  Me.Arrange vbArrangeIcons
End Sub

Private Sub mnuCascade_Click()
  Me.Arrange vbCascade
End Sub

Private Sub mnuExit_Click()
  Unload Me
End Sub

Private Sub mnuTileHor_Click()
  Me.Arrange vbTileHorizontal
End Sub

Private Sub mnuTileVert_Click()
  Me.Arrange vbTileVertical
End Sub

Private Sub Timer2_Timer()
  If inTimer2 Then Exit Sub
  inTimer2 = True
  On Error Resume Next
  Call Session.Exec("SessionTouch", Nothing)
  inTimer2 = False
End Sub





Private Function NoTabs(ByVal s As String) As String
  NoTabs = Replace(Replace(Replace(Replace(s, vbTab, " "), vbCrLf, " "), vbCr, " "), vbLf, " ")
End Function


Private Sub OpenForm(o As Object)
  Dim t As Form
  For Each t In Forms
    If t.Caption = o.Name Then
      t.WindowState = vbNormal
      t.ZOrder 0
      t.Show
      Me.MousePointer = vbNormal
      Exit Sub
    End If
  Next
  
  Dim f As frmObj
  Set f = New frmObj
  f.Init o
  f.Show
  

End Sub



Private Function RTF_To_Text(s As String)
  rtf.Text = ""
  rtf.SelRTF = s
  RTF_To_Text = rtf.Text
  rtf.Text = ""
End Function


Private Function SynchronizeARMDescription()
    Dim objARM As Object
    Dim objMenuItem As Menu
    Dim ObjItem As Object

    Set objARM = Manager.GetInstanceObject(ARMID)
    
    Dim i As Long
    Dim objRS As ADODB.Recordset
    Dim objEntryPoint As Object
    
    For i = 0 To Me.Controls.Count - 1
        Set ObjItem = Me.Controls(i)
        If UCase(TypeName(ObjItem)) = UCase("menu") Then
            If ObjItem.Caption <> "-" Then
              Debug.Print "Found menu " + ObjItem.Caption + "-" + ObjItem.Name
              Set objRS = Session.GetRowsEx("EntryPoints", ARMID, , "Caption='" + ObjItem.Caption + "' or Name='" & ObjItem.Name & "'")
              If objRS.EOF And objRS.BOF Then
                  Set objEntryPoint = objARM.EntryPoints.Add
                  objEntryPoint.Caption = ObjItem.Caption
                  objEntryPoint.Name = ObjItem.Name
                  objEntryPoint.AsToolbarItem = Boolean_Net
                  objEntryPoint.ActionType = 0 'MenuActionType_Nicego_ne_delat_
                  objEntryPoint.Save
              Else
                  Set objEntryPoint = objARM.FindRowObject("EntryPoints", objRS!Entrypointsid)
                  If Not objEntryPoint Is Nothing Then
                    objEntryPoint.Caption = ObjItem.Caption
                    objEntryPoint.Name = ObjItem.Name
                    objEntryPoint.AsToolbarItem = Boolean_Net
                    objEntryPoint.Save
                  End If
              End If
              objRS.Close
            End If
        End If
    Next
End Function


Private Sub mnuAllPCB_MPP_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_MPP Is Nothing Then
      Set jfmnuAllPCB_MPP = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_MPP.jv.journal = journal
      jfmnuAllPCB_MPP.jv.OpenModal = False
      jfmnuAllPCB_MPP.Caption = "Задача на изготовление ПП - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuAllPCB_MPP.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuAllPCB_MPP.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_MPP.Show
    jfmnuAllPCB_MPP.WindowState = 0
    jfmnuAllPCB_MPP.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_MPP_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuAllPCB_MPP.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_MPP_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_1 Is Nothing Then
      Set jfmnuPCB_MPP_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_1.jv.journal = journal
      jfmnuPCB_MPP_1.jv.OpenModal = False
      jfmnuPCB_MPP_1.Caption = "Задача на изготовление ПП :Завершена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5B95D6CB-8185-4954-88F9-36F3AC8806D0}'"
    jfmnuPCB_MPP_1.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
    jfmnuPCB_MPP_1.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_1.Show
    jfmnuPCB_MPP_1.WindowState = 0
    jfmnuPCB_MPP_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5B95D6CB-8185-4954-88F9-36F3AC8806D0}'"
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
    jfmnuPCB_MPP_1.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_1_OnClearFilter()
   jfmnuPCB_MPP_1.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{5B95D6CB-8185-4954-88F9-36F3AC8806D0}'"
End Sub
Private Sub jfmnuPCB_MPP_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_2 Is Nothing Then
      Set jfmnuPCB_MPP_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_2.jv.journal = journal
      jfmnuPCB_MPP_2.jv.OpenModal = False
      jfmnuPCB_MPP_2.Caption = "Задача на изготовление ПП :Оценена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{353C510B-44F4-4CB4-8413-3AA121CA6B2A}'"
    jfmnuPCB_MPP_2.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
    jfmnuPCB_MPP_2.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_2.Show
    jfmnuPCB_MPP_2.WindowState = 0
    jfmnuPCB_MPP_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{353C510B-44F4-4CB4-8413-3AA121CA6B2A}'"
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
    jfmnuPCB_MPP_2.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_2_OnClearFilter()
   jfmnuPCB_MPP_2.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{353C510B-44F4-4CB4-8413-3AA121CA6B2A}'"
End Sub
Private Sub jfmnuPCB_MPP_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_3 Is Nothing Then
      Set jfmnuPCB_MPP_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_3.jv.journal = journal
      jfmnuPCB_MPP_3.jv.OpenModal = False
      jfmnuPCB_MPP_3.Caption = "Задача на изготовление ПП :Принята"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{E8A19A43-2FC7-487A-83EF-51D21DD8B6BC}'"
    jfmnuPCB_MPP_3.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_MPP_3.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_3.Show
    jfmnuPCB_MPP_3.WindowState = 0
    jfmnuPCB_MPP_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{E8A19A43-2FC7-487A-83EF-51D21DD8B6BC}'"
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_MPP_3.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_3_OnClearFilter()
   jfmnuPCB_MPP_3.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{E8A19A43-2FC7-487A-83EF-51D21DD8B6BC}'"
End Sub
Private Sub jfmnuPCB_MPP_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_4 Is Nothing Then
      Set jfmnuPCB_MPP_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_4.jv.journal = journal
      jfmnuPCB_MPP_4.jv.OpenModal = False
      jfmnuPCB_MPP_4.Caption = "Задача на изготовление ПП :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{A75A8466-189F-4638-8CC2-528D5B315F84}'"
    jfmnuPCB_MPP_4.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_MPP_4.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_4.Show
    jfmnuPCB_MPP_4.WindowState = 0
    jfmnuPCB_MPP_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{A75A8466-189F-4638-8CC2-528D5B315F84}'"
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_MPP_4.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_4_OnClearFilter()
   jfmnuPCB_MPP_4.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{A75A8466-189F-4638-8CC2-528D5B315F84}'"
End Sub
Private Sub jfmnuPCB_MPP_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_5 Is Nothing Then
      Set jfmnuPCB_MPP_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_5.jv.journal = journal
      jfmnuPCB_MPP_5.jv.OpenModal = False
      jfmnuPCB_MPP_5.Caption = "Задача на изготовление ПП :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{7F176EEC-D5C0-4F1D-BA55-5C0B21010320}'"
    jfmnuPCB_MPP_5.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
    jfmnuPCB_MPP_5.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_5.Show
    jfmnuPCB_MPP_5.WindowState = 0
    jfmnuPCB_MPP_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{7F176EEC-D5C0-4F1D-BA55-5C0B21010320}'"
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
    jfmnuPCB_MPP_5.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_5_OnClearFilter()
   jfmnuPCB_MPP_5.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{7F176EEC-D5C0-4F1D-BA55-5C0B21010320}'"
End Sub
Private Sub jfmnuPCB_MPP_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_6 Is Nothing Then
      Set jfmnuPCB_MPP_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_6.jv.journal = journal
      jfmnuPCB_MPP_6.jv.OpenModal = False
      jfmnuPCB_MPP_6.Caption = "Задача на изготовление ПП :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{E3509DAD-5BA9-4844-83E7-5FB33A3AE15C}'"
    jfmnuPCB_MPP_6.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
    jfmnuPCB_MPP_6.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_6.Show
    jfmnuPCB_MPP_6.WindowState = 0
    jfmnuPCB_MPP_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{E3509DAD-5BA9-4844-83E7-5FB33A3AE15C}'"
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
    jfmnuPCB_MPP_6.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_6_OnClearFilter()
   jfmnuPCB_MPP_6.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{E3509DAD-5BA9-4844-83E7-5FB33A3AE15C}'"
End Sub
Private Sub jfmnuPCB_MPP_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_7 Is Nothing Then
      Set jfmnuPCB_MPP_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_7.jv.journal = journal
      jfmnuPCB_MPP_7.jv.OpenModal = False
      jfmnuPCB_MPP_7.Caption = "Задача на изготовление ПП :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{A949FDD9-3FE8-491C-BD23-7E79A741BBE8}'"
    jfmnuPCB_MPP_7.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
    jfmnuPCB_MPP_7.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_7.Show
    jfmnuPCB_MPP_7.WindowState = 0
    jfmnuPCB_MPP_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{A949FDD9-3FE8-491C-BD23-7E79A741BBE8}'"
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
    jfmnuPCB_MPP_7.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_7_OnClearFilter()
   jfmnuPCB_MPP_7.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{A949FDD9-3FE8-491C-BD23-7E79A741BBE8}'"
End Sub
Private Sub jfmnuPCB_MPP_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_MPP_8_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_MPP_8 Is Nothing Then
      Set jfmnuPCB_MPP_8 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{18BCCDA3-23AA-4906-9E33-80337D105777}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_MPP_8.jv.journal = journal
      jfmnuPCB_MPP_8.jv.OpenModal = False
      jfmnuPCB_MPP_8.Caption = "Задача на изготовление ПП :Оценить"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{CFFFE632-C4DD-453C-9086-B28F21264578}'"
    jfmnuPCB_MPP_8.jv.Filter.Add "AUTOPCB_MPP_Info", f
    Dim fltr As frmPCB_MPP
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
    jfmnuPCB_MPP_8.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
      jfmnuPCB_MPP_8.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_MPP_8.Show
    jfmnuPCB_MPP_8.WindowState = 0
    jfmnuPCB_MPP_8.ZOrder 0
End Sub
Private Sub jfmnuPCB_MPP_8_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_MPP
    Dim f As String
    Set fltr = New frmPCB_MPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{CFFFE632-C4DD-453C-9086-B28F21264578}'"
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2<= val(fltr.txtCostsPriceDM2_LE.Text)"
      End If
      If fltr.lblTaskPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod>= val(fltr.txtTaskPeriod_GE.Text)"
      End If
      If fltr.lblShipedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT<= MakeMSSQLDate(fltr.dtpShipedDT_LE.value)"
      End If
      If fltr.lblSerigraphyColor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_SerigraphyColor_ID='" & fltr.txtSerigraphyColor.Tag & "'"
      End If
      If fltr.lblNeedsDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT<= MakeMSSQLDate(fltr.dtpNeedsDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin>= val(fltr.txtPriceMin_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblOpenHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_OpenHole='" & fltr.cmbOpenHole.Text & "'"
      End If
      If fltr.lblCuperRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CuperRef_ID='" & fltr.txtCuperRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCustom_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom<= val(fltr.txtPriceCustom_LE.Text)"
      End If
      If fltr.lblPriceMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceMin<= val(fltr.txtPriceMin_LE.Text)"
      End If
      If fltr.lblCoverTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CoverTypeRef_ID='" & fltr.txtCoverTypeRef.Tag & "'"
      End If
      If fltr.lblMinThinBetween_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween>= val(fltr.txtMinThinBetween_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblDefendMask.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DefendMask_ID='" & fltr.txtDefendMask.Tag & "'"
      End If
      If fltr.lblPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2>= val(fltr.txtPriceDM2_GE.Text)"
      End If
      If fltr.lblNeedsDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_NeedsDT>= MakeMSSQLDate(fltr.dtpNeedsDT_GE.value)"
      End If
      If fltr.lblMinThinBetween_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinBetween<= val(fltr.txtMinThinBetween_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePCB_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB<= val(fltr.txtPricePCB_LE.Text)"
      End If
      If fltr.lblMaskColorBottom.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorBottom_ID='" & fltr.txtMaskColorBottom.Tag & "'"
      End If
      If fltr.lblMinHole.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHole_ID='" & fltr.txtMinHole.Tag & "'"
      End If
      If fltr.lblPricePCB_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePCB>= val(fltr.txtPricePCB_GE.Text)"
      End If
      If fltr.lblPriceDM2_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDM2<= val(fltr.txtPriceDM2_LE.Text)"
      End If
      If fltr.lblProceedContur.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProceedContur_ID='" & fltr.txtProceedContur.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblIsCustomerCheck.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_IsCustomerCheck='" & fltr.cmbIsCustomerCheck.Text & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceETest_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest<= val(fltr.txtPriceETest_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblManufShipDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT>= MakeMSSQLDate(fltr.dtpManufShipDT_GE.value)"
      End If
      If fltr.lblUseGold.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseGold='" & fltr.cmbUseGold.Text & "'"
      End If
      If fltr.lblPriceOne_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne>= val(fltr.txtPriceOne_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFaskaGRD.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaGRD_ID='" & fltr.txtFaskaGRD.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCosts_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs>= val(fltr.txtCosts_GE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTolerancePRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TolerancePRef_ID='" & fltr.txtTolerancePRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize>= val(fltr.txtFaskaSize_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPPCount_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount>= val(fltr.txtPPCount_GE.Text)"
      End If
      If fltr.lblTheWeight_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight>= val(fltr.txtTheWeight_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheSender.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheSender like '%" & fltr.txtTheSender.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblMaterialPP.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaterialPP_ID='" & fltr.txtMaterialPP.Tag & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceETest_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceETest>= val(fltr.txtPriceETest_GE.Text)"
      End If
      If fltr.lblCosts_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Costs<= val(fltr.txtCosts_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS>= val(fltr.txtPriceOneNNDS_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceCustom_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceCustom>= val(fltr.txtPriceCustom_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblThickness_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness>= val(fltr.txtThickness_GE.Text)"
      End If
      If fltr.lblToleranceMRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ToleranceMRef_ID='" & fltr.txtToleranceMRef.Tag & "'"
      End If
      If fltr.lblFaskaSize_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FaskaSize<= val(fltr.txtFaskaSize_LE.Text)"
      End If
      If fltr.lblManufTypeRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufTypeRef_ID='" & fltr.txtManufTypeRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCheckImpedance.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CheckImpedance='" & fltr.cmbCheckImpedance.Text & "'"
      End If
      If fltr.lblMinHoleE_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE<= val(fltr.txtMinHoleE_LE.Text)"
      End If
      If fltr.lblCostsPriceDM2_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CostsPriceDM2>= val(fltr.txtCostsPriceDM2_GE.Text)"
      End If
      If fltr.lblWayBill.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_WayBill like '%" & fltr.txtWayBill.Text & "%'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Recipient like '%" & fltr.txtRecipient.Text & "%'"
      End If
      If fltr.lblTheWeight_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TheWeight<= val(fltr.txtTheWeight_LE.Text)"
      End If
      If fltr.lblPriceOne_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOne<= val(fltr.txtPriceOne_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMinHoleE_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinHoleE>= val(fltr.txtMinHoleE_GE.Text)"
      End If
      If fltr.lblMaskColorTop.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MaskColorTop_ID='" & fltr.txtMaskColorTop.Tag & "'"
      End If
      If fltr.lblPPCount_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PPCount<= val(fltr.txtPPCount_LE.Text)"
      End If
      If fltr.lblMinThinConductor.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_MinThinConductor_ID='" & fltr.txtMinThinConductor.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTaskPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_TaskPeriod<= val(fltr.txtTaskPeriod_LE.Text)"
      End If
      If fltr.lblPriceOneNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceOneNNDS<= val(fltr.txtPriceOneNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblManufShipDT_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ManufShipDT<= MakeMSSQLDate(fltr.dtpManufShipDT_LE.value)"
      End If
      If fltr.lblSerigraphy.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Serigraphy_ID='" & fltr.txtSerigraphy.Tag & "'"
      End If
      If fltr.lblAssessByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_AssessByRef_ID='" & fltr.txtAssessByRef.Tag & "'"
      End If
      If fltr.lblShipedDT_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ShipedDT>= MakeMSSQLDate(fltr.dtpShipedDT_GE.value)"
      End If
      If fltr.lblUseElectrTest.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_UseElectrTest='" & fltr.cmbUseElectrTest.Text & "'"
      End If
      If fltr.lblThickness_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Thickness<= val(fltr.txtThickness_LE.Text)"
      End If
      If fltr.lblImpedanceOverview.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_ImpedanceOverview like '%" & fltr.txtImpedanceOverview.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_MPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
    jfmnuPCB_MPP_8.jv.Filter.Add "AUTOPCB_MPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_MPP_8_OnClearFilter()
   jfmnuPCB_MPP_8.jv.Filter.Add "AUTOPCB_MPP_Info", " INTSANCEStatusID='{CFFFE632-C4DD-453C-9086-B28F21264578}'"
End Sub
Private Sub jfmnuPCB_MPP_8_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_MPP", "Задача на изготовление ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuAllPCB_TaskPP_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_TaskPP Is Nothing Then
      Set jfmnuAllPCB_TaskPP = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_TaskPP.jv.journal = journal
      jfmnuAllPCB_TaskPP.jv.OpenModal = False
      jfmnuAllPCB_TaskPP.Caption = "Задача на монтаж ПП - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuAllPCB_TaskPP.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuAllPCB_TaskPP.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_TaskPP.Show
    jfmnuAllPCB_TaskPP.WindowState = 0
    jfmnuAllPCB_TaskPP.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_TaskPP_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuAllPCB_TaskPP.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_TaskPP_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_1 Is Nothing Then
      Set jfmnuPCB_TaskPP_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_1.jv.journal = journal
      jfmnuPCB_TaskPP_1.jv.OpenModal = False
      jfmnuPCB_TaskPP_1.Caption = "Задача на монтаж ПП :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{C5E5802D-1D5C-4A6D-A886-0C089C050805}'"
    jfmnuPCB_TaskPP_1.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
    jfmnuPCB_TaskPP_1.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_1.Show
    jfmnuPCB_TaskPP_1.WindowState = 0
    jfmnuPCB_TaskPP_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{C5E5802D-1D5C-4A6D-A886-0C089C050805}'"
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
    jfmnuPCB_TaskPP_1.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_1_OnClearFilter()
   jfmnuPCB_TaskPP_1.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{C5E5802D-1D5C-4A6D-A886-0C089C050805}'"
End Sub
Private Sub jfmnuPCB_TaskPP_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_2 Is Nothing Then
      Set jfmnuPCB_TaskPP_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_2.jv.journal = journal
      jfmnuPCB_TaskPP_2.jv.OpenModal = False
      jfmnuPCB_TaskPP_2.Caption = "Задача на монтаж ПП :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{240E2C05-3D42-4691-8A8D-161195D83257}'"
    jfmnuPCB_TaskPP_2.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
    jfmnuPCB_TaskPP_2.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_2.Show
    jfmnuPCB_TaskPP_2.WindowState = 0
    jfmnuPCB_TaskPP_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{240E2C05-3D42-4691-8A8D-161195D83257}'"
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
    jfmnuPCB_TaskPP_2.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_2_OnClearFilter()
   jfmnuPCB_TaskPP_2.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{240E2C05-3D42-4691-8A8D-161195D83257}'"
End Sub
Private Sub jfmnuPCB_TaskPP_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_3 Is Nothing Then
      Set jfmnuPCB_TaskPP_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_3.jv.journal = journal
      jfmnuPCB_TaskPP_3.jv.OpenModal = False
      jfmnuPCB_TaskPP_3.Caption = "Задача на монтаж ПП :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{2113E2D5-97F5-4EAA-9DEE-1A68424DF0E6}'"
    jfmnuPCB_TaskPP_3.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
    jfmnuPCB_TaskPP_3.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_3.Show
    jfmnuPCB_TaskPP_3.WindowState = 0
    jfmnuPCB_TaskPP_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{2113E2D5-97F5-4EAA-9DEE-1A68424DF0E6}'"
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
    jfmnuPCB_TaskPP_3.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_3_OnClearFilter()
   jfmnuPCB_TaskPP_3.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{2113E2D5-97F5-4EAA-9DEE-1A68424DF0E6}'"
End Sub
Private Sub jfmnuPCB_TaskPP_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_4 Is Nothing Then
      Set jfmnuPCB_TaskPP_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_4.jv.journal = journal
      jfmnuPCB_TaskPP_4.jv.OpenModal = False
      jfmnuPCB_TaskPP_4.Caption = "Задача на монтаж ПП :Завершена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{7A4921F1-327A-4B35-A919-33226FE1F4F4}'"
    jfmnuPCB_TaskPP_4.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_TaskPP_4.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_4.Show
    jfmnuPCB_TaskPP_4.WindowState = 0
    jfmnuPCB_TaskPP_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{7A4921F1-327A-4B35-A919-33226FE1F4F4}'"
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_TaskPP_4.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_4_OnClearFilter()
   jfmnuPCB_TaskPP_4.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{7A4921F1-327A-4B35-A919-33226FE1F4F4}'"
End Sub
Private Sub jfmnuPCB_TaskPP_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_5 Is Nothing Then
      Set jfmnuPCB_TaskPP_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_5.jv.journal = journal
      jfmnuPCB_TaskPP_5.jv.OpenModal = False
      jfmnuPCB_TaskPP_5.Caption = "Задача на монтаж ПП :Принята"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{218A02E2-4631-455F-964D-B5397C1F1E82}'"
    jfmnuPCB_TaskPP_5.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_TaskPP_5.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_5.Show
    jfmnuPCB_TaskPP_5.WindowState = 0
    jfmnuPCB_TaskPP_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{218A02E2-4631-455F-964D-B5397C1F1E82}'"
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_TaskPP_5.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_5_OnClearFilter()
   jfmnuPCB_TaskPP_5.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{218A02E2-4631-455F-964D-B5397C1F1E82}'"
End Sub
Private Sub jfmnuPCB_TaskPP_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_6 Is Nothing Then
      Set jfmnuPCB_TaskPP_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_6.jv.journal = journal
      jfmnuPCB_TaskPP_6.jv.OpenModal = False
      jfmnuPCB_TaskPP_6.Caption = "Задача на монтаж ПП :Оценить"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{296C4850-A6D4-4B27-B266-C74732DAE227}'"
    jfmnuPCB_TaskPP_6.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
    jfmnuPCB_TaskPP_6.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_6.Show
    jfmnuPCB_TaskPP_6.WindowState = 0
    jfmnuPCB_TaskPP_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{296C4850-A6D4-4B27-B266-C74732DAE227}'"
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
    jfmnuPCB_TaskPP_6.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_6_OnClearFilter()
   jfmnuPCB_TaskPP_6.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{296C4850-A6D4-4B27-B266-C74732DAE227}'"
End Sub
Private Sub jfmnuPCB_TaskPP_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_7 Is Nothing Then
      Set jfmnuPCB_TaskPP_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_7.jv.journal = journal
      jfmnuPCB_TaskPP_7.jv.OpenModal = False
      jfmnuPCB_TaskPP_7.Caption = "Задача на монтаж ПП :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{8D926E51-F1E9-48AB-973E-D9B70443C0BA}'"
    jfmnuPCB_TaskPP_7.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
    jfmnuPCB_TaskPP_7.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_7.Show
    jfmnuPCB_TaskPP_7.WindowState = 0
    jfmnuPCB_TaskPP_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{8D926E51-F1E9-48AB-973E-D9B70443C0BA}'"
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
    jfmnuPCB_TaskPP_7.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_7_OnClearFilter()
   jfmnuPCB_TaskPP_7.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{8D926E51-F1E9-48AB-973E-D9B70443C0BA}'"
End Sub
Private Sub jfmnuPCB_TaskPP_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_TaskPP_8_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_TaskPP_8 Is Nothing Then
      Set jfmnuPCB_TaskPP_8 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{B297C89A-9282-453F-BB28-B18124B5970C}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_TaskPP_8.jv.journal = journal
      jfmnuPCB_TaskPP_8.jv.OpenModal = False
      jfmnuPCB_TaskPP_8.Caption = "Задача на монтаж ПП :Оценена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{0FBDCCF0-98FC-4810-8035-EBDE57DE7C2C}'"
    jfmnuPCB_TaskPP_8.jv.Filter.Add "AUTOPCB_TPP_Info", f
    Dim fltr As frmPCB_TaskPP
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
    jfmnuPCB_TaskPP_8.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
      jfmnuPCB_TaskPP_8.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_TaskPP_8.Show
    jfmnuPCB_TaskPP_8.WindowState = 0
    jfmnuPCB_TaskPP_8.ZOrder 0
End Sub
Private Sub jfmnuPCB_TaskPP_8_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_TaskPP
    Dim f As String
    Set fltr = New frmPCB_TaskPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{0FBDCCF0-98FC-4810-8035-EBDE57DE7C2C}'"
      If fltr.lblPriceRentOnce_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce<= val(fltr.txtPriceRentOnce_LE.Text)"
      End If
      If fltr.lblPriceItemNNDS_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS>= val(fltr.txtPriceItemNNDS_GE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblAntisitat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Antisitat='" & fltr.cmbAntisitat.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLak.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_Lak_ID='" & fltr.txtLak.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin>= val(fltr.txtPriceRecomMin_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPricePerOne_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne>= val(fltr.txtPricePerOne_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceTrafaret_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret>= val(fltr.txtPriceTrafaret_GE.Text)"
      End If
      If fltr.lblThePName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ThePName like '%" & fltr.txtThePName.Text & "%'"
      End If
      If fltr.lblLengthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM>= val(fltr.txtLengthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblRentBGA.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_RentBGA='" & fltr.cmbRentBGA.Text & "'"
      End If
      If fltr.lblPricePerOne_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePerOne<= val(fltr.txtPricePerOne_LE.Text)"
      End If
      If fltr.lblMountCount_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount<= val(fltr.txtMountCount_LE.Text)"
      End If
      If fltr.lblPricePrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare<= val(fltr.txtPricePrepare_LE.Text)"
      End If
      If fltr.lblWeidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM<= val(fltr.txtWeidthMM_LE.Text)"
      End If
      If fltr.lblFileFormat.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FileFormat like '%" & fltr.txtFileFormat.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceResPrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare>= val(fltr.txtPriceResPrepare_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblMontainPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod>= val(fltr.txtMontainPeriod_GE.Text)"
      End If
      If fltr.lblWeidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_WeidthMM>= val(fltr.txtWeidthMM_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblAccCustomer.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_AccCustomer='" & fltr.cmbAccCustomer.Text & "'"
      End If
      If fltr.lblPriceTrafaret_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaret<= val(fltr.txtPriceTrafaret_LE.Text)"
      End If
      If fltr.lblClearAfter.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ClearAfter_ID='" & fltr.txtClearAfter.Tag & "'"
      End If
      If fltr.lblExtraChargeMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin<= val(fltr.txtExtraChargeMin_LE.Text)"
      End If
      If fltr.lblMountZagot_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot<= val(fltr.txtMountZagot_LE.Text)"
      End If
      If fltr.lblMountZagot_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountZagot>= val(fltr.txtMountZagot_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblMountCount_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountCount>= val(fltr.txtMountCount_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblUseGlue.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_UseGlue='" & fltr.cmbUseGlue.Text & "'"
      End If
      If fltr.lblContRentgen_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen>= val(fltr.txtContRentgen_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceItemNNDS_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceItemNNDS<= val(fltr.txtPriceItemNNDS_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblContRentgen_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ContRentgen<= val(fltr.txtContRentgen_LE.Text)"
      End If
      If fltr.lblExtraChargeMax_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax>= val(fltr.txtExtraChargeMax_GE.Text)"
      End If
      If fltr.lblDopRequests.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_DopRequests like '%" & fltr.txtDopRequests.Text & "%'"
      End If
      If fltr.lblMountingType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MountingType_ID='" & fltr.txtMountingType.Tag & "'"
      End If
      If fltr.lblPriceRecomMin_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRecomMin<= val(fltr.txtPriceRecomMin_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblExtraChargeMin_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMin>= val(fltr.txtExtraChargeMin_GE.Text)"
      End If
      If fltr.lblMontainPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_MontainPeriod<= val(fltr.txtMontainPeriod_LE.Text)"
      End If
      If fltr.lblExtraControl.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraControl='" & fltr.cmbExtraControl.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblExtraChargeMax_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ExtraChargeMax<= val(fltr.txtExtraChargeMax_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPripoyType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PripoyType_ID='" & fltr.txtPripoyType.Tag & "'"
      End If
      If fltr.lblPriceTrafaretSell_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell<= val(fltr.txtPriceTrafaretSell_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceTrafaretSell_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceTrafaretSell>= val(fltr.txtPriceTrafaretSell_GE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceResPrepare_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceResPrepare<= val(fltr.txtPriceResPrepare_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRentOnce_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PriceRentOnce>= val(fltr.txtPriceRentOnce_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblLengthMM_LE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_LengthMM<= val(fltr.txtLengthMM_LE.Text)"
      End If
      If fltr.lblPricePrepare_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_PricePrepare>= val(fltr.txtPricePrepare_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_TPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
    jfmnuPCB_TaskPP_8.jv.Filter.Add "AUTOPCB_TPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_TaskPP_8_OnClearFilter()
   jfmnuPCB_TaskPP_8.jv.Filter.Add "AUTOPCB_TPP_Info", " INTSANCEStatusID='{0FBDCCF0-98FC-4810-8035-EBDE57DE7C2C}'"
End Sub
Private Sub jfmnuPCB_TaskPP_8_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_TaskPP", "Задача на монтаж ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuAllPCB_OUtility_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_OUtility Is Nothing Then
      Set jfmnuAllPCB_OUtility = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_OUtility.jv.journal = journal
      jfmnuAllPCB_OUtility.jv.OpenModal = False
      jfmnuAllPCB_OUtility.Caption = "Задача на поставку комплектующих - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
    jfmnuAllPCB_OUtility.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuAllPCB_OUtility.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_OUtility.Show
    jfmnuAllPCB_OUtility.WindowState = 0
    jfmnuAllPCB_OUtility.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_OUtility_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
    jfmnuAllPCB_OUtility.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_OUtility_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_1 Is Nothing Then
      Set jfmnuPCB_OUtility_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_1.jv.journal = journal
      jfmnuPCB_OUtility_1.jv.OpenModal = False
      jfmnuPCB_OUtility_1.Caption = "Задача на поставку комплектующих :Оценена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{CB4D24F5-C3E0-47A1-A35B-21A60AB4A561}'"
    jfmnuPCB_OUtility_1.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuPCB_OUtility_1.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_1.Show
    jfmnuPCB_OUtility_1.WindowState = 0
    jfmnuPCB_OUtility_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{CB4D24F5-C3E0-47A1-A35B-21A60AB4A561}'"
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuPCB_OUtility_1.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_1_OnClearFilter()
   jfmnuPCB_OUtility_1.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{CB4D24F5-C3E0-47A1-A35B-21A60AB4A561}'"
End Sub
Private Sub jfmnuPCB_OUtility_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_2 Is Nothing Then
      Set jfmnuPCB_OUtility_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_2.jv.journal = journal
      jfmnuPCB_OUtility_2.jv.OpenModal = False
      jfmnuPCB_OUtility_2.Caption = "Задача на поставку комплектующих :Оценить"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5FB288A7-61D0-4328-93E4-2782B9497E6B}'"
    jfmnuPCB_OUtility_2.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
    jfmnuPCB_OUtility_2.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_2.Show
    jfmnuPCB_OUtility_2.WindowState = 0
    jfmnuPCB_OUtility_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5FB288A7-61D0-4328-93E4-2782B9497E6B}'"
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
    jfmnuPCB_OUtility_2.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_2_OnClearFilter()
   jfmnuPCB_OUtility_2.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{5FB288A7-61D0-4328-93E4-2782B9497E6B}'"
End Sub
Private Sub jfmnuPCB_OUtility_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_3 Is Nothing Then
      Set jfmnuPCB_OUtility_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_3.jv.journal = journal
      jfmnuPCB_OUtility_3.jv.OpenModal = False
      jfmnuPCB_OUtility_3.Caption = "Задача на поставку комплектующих :Принята"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5309A8CC-EA44-4DBB-85CB-6AFA75D6D47B}'"
    jfmnuPCB_OUtility_3.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_OUtility_3.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_3.Show
    jfmnuPCB_OUtility_3.WindowState = 0
    jfmnuPCB_OUtility_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5309A8CC-EA44-4DBB-85CB-6AFA75D6D47B}'"
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_OUtility_3.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_3_OnClearFilter()
   jfmnuPCB_OUtility_3.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{5309A8CC-EA44-4DBB-85CB-6AFA75D6D47B}'"
End Sub
Private Sub jfmnuPCB_OUtility_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_4 Is Nothing Then
      Set jfmnuPCB_OUtility_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_4.jv.journal = journal
      jfmnuPCB_OUtility_4.jv.OpenModal = False
      jfmnuPCB_OUtility_4.Caption = "Задача на поставку комплектующих :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{623D8E2D-3152-423C-878B-7EA7D4A731D1}'"
    jfmnuPCB_OUtility_4.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_OUtility_4.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_4.Show
    jfmnuPCB_OUtility_4.WindowState = 0
    jfmnuPCB_OUtility_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{623D8E2D-3152-423C-878B-7EA7D4A731D1}'"
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_OUtility_4.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_4_OnClearFilter()
   jfmnuPCB_OUtility_4.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{623D8E2D-3152-423C-878B-7EA7D4A731D1}'"
End Sub
Private Sub jfmnuPCB_OUtility_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_5 Is Nothing Then
      Set jfmnuPCB_OUtility_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_5.jv.journal = journal
      jfmnuPCB_OUtility_5.jv.OpenModal = False
      jfmnuPCB_OUtility_5.Caption = "Задача на поставку комплектующих :Завершена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{F5C3A7C1-EE7F-4582-8670-AD3F5CB4BB29}'"
    jfmnuPCB_OUtility_5.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
    jfmnuPCB_OUtility_5.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_5.Show
    jfmnuPCB_OUtility_5.WindowState = 0
    jfmnuPCB_OUtility_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{F5C3A7C1-EE7F-4582-8670-AD3F5CB4BB29}'"
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
    jfmnuPCB_OUtility_5.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_5_OnClearFilter()
   jfmnuPCB_OUtility_5.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{F5C3A7C1-EE7F-4582-8670-AD3F5CB4BB29}'"
End Sub
Private Sub jfmnuPCB_OUtility_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_6 Is Nothing Then
      Set jfmnuPCB_OUtility_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_6.jv.journal = journal
      jfmnuPCB_OUtility_6.jv.OpenModal = False
      jfmnuPCB_OUtility_6.Caption = "Задача на поставку комплектующих :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{EDDCF72F-6BFE-4FF4-A850-C8B4067D29D9}'"
    jfmnuPCB_OUtility_6.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_OUtility_6.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_6.Show
    jfmnuPCB_OUtility_6.WindowState = 0
    jfmnuPCB_OUtility_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{EDDCF72F-6BFE-4FF4-A850-C8B4067D29D9}'"
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
    jfmnuPCB_OUtility_6.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_6_OnClearFilter()
   jfmnuPCB_OUtility_6.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{EDDCF72F-6BFE-4FF4-A850-C8B4067D29D9}'"
End Sub
Private Sub jfmnuPCB_OUtility_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_7 Is Nothing Then
      Set jfmnuPCB_OUtility_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_7.jv.journal = journal
      jfmnuPCB_OUtility_7.jv.OpenModal = False
      jfmnuPCB_OUtility_7.Caption = "Задача на поставку комплектующих :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5F707860-6878-4F98-A33A-D2B39310C079}'"
    jfmnuPCB_OUtility_7.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_OUtility_7.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_7.Show
    jfmnuPCB_OUtility_7.WindowState = 0
    jfmnuPCB_OUtility_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5F707860-6878-4F98-A33A-D2B39310C079}'"
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_OUtility_7.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_7_OnClearFilter()
   jfmnuPCB_OUtility_7.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{5F707860-6878-4F98-A33A-D2B39310C079}'"
End Sub
Private Sub jfmnuPCB_OUtility_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_OUtility_8_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_OUtility_8 Is Nothing Then
      Set jfmnuPCB_OUtility_8 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{1DABBD2A-91DD-47CC-B5C4-02E48AAD3A8B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_OUtility_8.jv.journal = journal
      jfmnuPCB_OUtility_8.jv.OpenModal = False
      jfmnuPCB_OUtility_8.Caption = "Задача на поставку комплектующих :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{D0364D33-1791-4CD0-BDD3-E7E3C242D025}'"
    jfmnuPCB_OUtility_8.jv.Filter.Add "AUTOPCB_OU_Info", f
    Dim fltr As frmPCB_OUtility
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
    jfmnuPCB_OUtility_8.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
      jfmnuPCB_OUtility_8.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_OUtility_8.Show
    jfmnuPCB_OUtility_8.WindowState = 0
    jfmnuPCB_OUtility_8.ZOrder 0
End Sub
Private Sub jfmnuPCB_OUtility_8_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_OUtility
    Dim f As String
    Set fltr = New frmPCB_OUtility
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{D0364D33-1791-4CD0-BDD3-E7E3C242D025}'"
      If fltr.lblPriceDelivery_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery>= val(fltr.txtPriceDelivery_GE.Text)"
      End If
      If fltr.lblPriceDelivery_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceDelivery<= val(fltr.txtPriceDelivery_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPreSetDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT<= MakeMSSQLDate(fltr.dtpPreSetDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPreSetDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PreSetDT>= MakeMSSQLDate(fltr.dtpPreSetDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceSetByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceSetByRef_ID='" & fltr.txtPriceSetByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceCommon_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon>= val(fltr.txtPriceCommon_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_OU_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPriceCommon_LE.Value = vbChecked Then
        f = f & " and PCB_OU_Info_PriceCommon<= val(fltr.txtPriceCommon_LE.Text)"
      End If
      If fltr.lblDeliveryRef.Value = vbChecked Then
        f = f & " and PCB_OU_Info_DeliveryRef_ID='" & fltr.txtDeliveryRef.Tag & "'"
      End If
    jfmnuPCB_OUtility_8.jv.Filter.Add "AUTOPCB_OU_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_OUtility_8_OnClearFilter()
   jfmnuPCB_OUtility_8.jv.Filter.Add "AUTOPCB_OU_Info", " INTSANCEStatusID='{D0364D33-1791-4CD0-BDD3-E7E3C242D025}'"
End Sub
Private Sub jfmnuPCB_OUtility_8_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_OUtility", "Задача на поставку комплектующих" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuAllPCB_PPP_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_PPP Is Nothing Then
      Set jfmnuAllPCB_PPP = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_PPP.jv.journal = journal
      jfmnuAllPCB_PPP.jv.OpenModal = False
      jfmnuAllPCB_PPP.Caption = "Задача на проектирование ПП - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
    jfmnuAllPCB_PPP.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuAllPCB_PPP.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_PPP.Show
    jfmnuAllPCB_PPP.WindowState = 0
    jfmnuAllPCB_PPP.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_PPP_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
    jfmnuAllPCB_PPP.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_PPP_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_1 Is Nothing Then
      Set jfmnuPCB_PPP_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_1.jv.journal = journal
      jfmnuPCB_PPP_1.jv.OpenModal = False
      jfmnuPCB_PPP_1.Caption = "Задача на проектирование ПП :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{6B6159BC-0FA6-4249-950D-04EAAC8F17F5}'"
    jfmnuPCB_PPP_1.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
    jfmnuPCB_PPP_1.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_1.Show
    jfmnuPCB_PPP_1.WindowState = 0
    jfmnuPCB_PPP_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{6B6159BC-0FA6-4249-950D-04EAAC8F17F5}'"
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
    jfmnuPCB_PPP_1.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_1_OnClearFilter()
   jfmnuPCB_PPP_1.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{6B6159BC-0FA6-4249-950D-04EAAC8F17F5}'"
End Sub
Private Sub jfmnuPCB_PPP_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_2 Is Nothing Then
      Set jfmnuPCB_PPP_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_2.jv.journal = journal
      jfmnuPCB_PPP_2.jv.OpenModal = False
      jfmnuPCB_PPP_2.Caption = "Задача на проектирование ПП :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5927D858-22C4-49CA-8AA0-0DCD0B2CEB57}'"
    jfmnuPCB_PPP_2.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
    jfmnuPCB_PPP_2.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_2.Show
    jfmnuPCB_PPP_2.WindowState = 0
    jfmnuPCB_PPP_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5927D858-22C4-49CA-8AA0-0DCD0B2CEB57}'"
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
    jfmnuPCB_PPP_2.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_2_OnClearFilter()
   jfmnuPCB_PPP_2.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{5927D858-22C4-49CA-8AA0-0DCD0B2CEB57}'"
End Sub
Private Sub jfmnuPCB_PPP_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_3 Is Nothing Then
      Set jfmnuPCB_PPP_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_3.jv.journal = journal
      jfmnuPCB_PPP_3.jv.OpenModal = False
      jfmnuPCB_PPP_3.Caption = "Задача на проектирование ПП :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{74A1C1D5-CCE1-4229-996E-14D79FB0791C}'"
    jfmnuPCB_PPP_3.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
    jfmnuPCB_PPP_3.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_3.Show
    jfmnuPCB_PPP_3.WindowState = 0
    jfmnuPCB_PPP_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{74A1C1D5-CCE1-4229-996E-14D79FB0791C}'"
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
    jfmnuPCB_PPP_3.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_3_OnClearFilter()
   jfmnuPCB_PPP_3.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{74A1C1D5-CCE1-4229-996E-14D79FB0791C}'"
End Sub
Private Sub jfmnuPCB_PPP_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_4 Is Nothing Then
      Set jfmnuPCB_PPP_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_4.jv.journal = journal
      jfmnuPCB_PPP_4.jv.OpenModal = False
      jfmnuPCB_PPP_4.Caption = "Задача на проектирование ПП :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{092073D1-35F1-44DD-850A-39E639EBDDF0}'"
    jfmnuPCB_PPP_4.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
    jfmnuPCB_PPP_4.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_4.Show
    jfmnuPCB_PPP_4.WindowState = 0
    jfmnuPCB_PPP_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{092073D1-35F1-44DD-850A-39E639EBDDF0}'"
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
    jfmnuPCB_PPP_4.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_4_OnClearFilter()
   jfmnuPCB_PPP_4.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{092073D1-35F1-44DD-850A-39E639EBDDF0}'"
End Sub
Private Sub jfmnuPCB_PPP_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_5 Is Nothing Then
      Set jfmnuPCB_PPP_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_5.jv.journal = journal
      jfmnuPCB_PPP_5.jv.OpenModal = False
      jfmnuPCB_PPP_5.Caption = "Задача на проектирование ПП :Принята"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{0AFEBA62-F471-4948-89F4-84766BF88DEC}'"
    jfmnuPCB_PPP_5.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_PPP_5.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_5.Show
    jfmnuPCB_PPP_5.WindowState = 0
    jfmnuPCB_PPP_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{0AFEBA62-F471-4948-89F4-84766BF88DEC}'"
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
    jfmnuPCB_PPP_5.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_5_OnClearFilter()
   jfmnuPCB_PPP_5.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{0AFEBA62-F471-4948-89F4-84766BF88DEC}'"
End Sub
Private Sub jfmnuPCB_PPP_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_6 Is Nothing Then
      Set jfmnuPCB_PPP_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_6.jv.journal = journal
      jfmnuPCB_PPP_6.jv.OpenModal = False
      jfmnuPCB_PPP_6.Caption = "Задача на проектирование ПП :Оценить"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{072D1581-4563-436D-972F-A9456C17A6A4}'"
    jfmnuPCB_PPP_6.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
    jfmnuPCB_PPP_6.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_6.Show
    jfmnuPCB_PPP_6.WindowState = 0
    jfmnuPCB_PPP_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{072D1581-4563-436D-972F-A9456C17A6A4}'"
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
    jfmnuPCB_PPP_6.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_6_OnClearFilter()
   jfmnuPCB_PPP_6.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{072D1581-4563-436D-972F-A9456C17A6A4}'"
End Sub
Private Sub jfmnuPCB_PPP_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_7 Is Nothing Then
      Set jfmnuPCB_PPP_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_7.jv.journal = journal
      jfmnuPCB_PPP_7.jv.OpenModal = False
      jfmnuPCB_PPP_7.Caption = "Задача на проектирование ПП :Оценена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5287FAA2-CF78-4B0F-858B-D708F507F00F}'"
    jfmnuPCB_PPP_7.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
    jfmnuPCB_PPP_7.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_7.Show
    jfmnuPCB_PPP_7.WindowState = 0
    jfmnuPCB_PPP_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5287FAA2-CF78-4B0F-858B-D708F507F00F}'"
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
    jfmnuPCB_PPP_7.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_7_OnClearFilter()
   jfmnuPCB_PPP_7.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{5287FAA2-CF78-4B0F-858B-D708F507F00F}'"
End Sub
Private Sub jfmnuPCB_PPP_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_PPP_8_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_PPP_8 Is Nothing Then
      Set jfmnuPCB_PPP_8 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{FD872F0C-AD8B-4EE0-88A1-AE726C6E1536}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_PPP_8.jv.journal = journal
      jfmnuPCB_PPP_8.jv.OpenModal = False
      jfmnuPCB_PPP_8.Caption = "Задача на проектирование ПП :Завершена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{B54FFD73-2B61-4B51-A88E-DE1C59521CAB}'"
    jfmnuPCB_PPP_8.jv.Filter.Add "AUTOPCB_PPP_Info", f
    Dim fltr As frmPCB_PPP
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
    jfmnuPCB_PPP_8.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
      jfmnuPCB_PPP_8.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_PPP_8.Show
    jfmnuPCB_PPP_8.WindowState = 0
    jfmnuPCB_PPP_8.ZOrder 0
End Sub
Private Sub jfmnuPCB_PPP_8_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_PPP
    Dim f As String
    Set fltr = New frmPCB_PPP
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{B54FFD73-2B61-4B51-A88E-DE1C59521CAB}'"
      If fltr.lblDueDate_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate>= MakeMSSQLDate(fltr.dtpDueDate_GE.value)"
      End If
      If fltr.lblPlanStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT<= MakeMSSQLDate(fltr.dtpPlanStartDT_LE.value)"
      End If
      If fltr.lblPriceRes_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes>= val(fltr.txtPriceRes_GE.Text)"
      End If
      If fltr.lblSoftType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SoftType_ID='" & fltr.txtSoftType.Tag & "'"
      End If
      If fltr.lblLegthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM<= val(fltr.txtLegthMM_LE.Text)"
      End If
      If fltr.lblWarmAnalize.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WarmAnalize='" & fltr.cmbWarmAnalize.Text & "'"
      End If
      If fltr.lblPriceRecom_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom<= val(fltr.txtPriceRecom_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblSquareDM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM>= val(fltr.txtSquareDM_GE.Text)"
      End If
      If fltr.lblPlanStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanStartDT>= MakeMSSQLDate(fltr.dtpPlanStartDT_GE.value)"
      End If
      If fltr.lblPriceRecom_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRecom>= val(fltr.txtPriceRecom_GE.Text)"
      End If
      If fltr.lblDocLength_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength>= val(fltr.txtDocLength_GE.Text)"
      End If
      If fltr.lblControlerRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ControlerRef_ID='" & fltr.txtControlerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblLayers_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers>= val(fltr.txtLayers_GE.Text)"
      End If
      If fltr.lblLegthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_LegthMM>= val(fltr.txtLegthMM_GE.Text)"
      End If
      If fltr.lblSquareDM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_SquareDM<= val(fltr.txtSquareDM_LE.Text)"
      End If
      If fltr.lblFormatKD.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FormatKD_ID='" & fltr.txtFormatKD.Tag & "'"
      End If
      If fltr.lblDueDate_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DueDate<= MakeMSSQLDate(fltr.dtpDueDate_LE.value)"
      End If
      If fltr.lblConstructorRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ConstructorRef_ID='" & fltr.txtConstructorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblLayers_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Layers<= val(fltr.txtLayers_LE.Text)"
      End If
      If fltr.lblEstimationDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT<= MakeMSSQLDate(fltr.dtpEstimationDT_LE.value)"
      End If
      If fltr.lblOutlets_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets<= val(fltr.txtOutlets_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblEstimationDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimationDT>= MakeMSSQLDate(fltr.dtpEstimationDT_GE.value)"
      End If
      If fltr.lblPriceResNDS_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS>= val(fltr.txtPriceResNDS_GE.Text)"
      End If
      If fltr.lblProductPeriod_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod>= val(fltr.txtProductPeriod_GE.Text)"
      End If
      If fltr.lblDopNeeds.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DopNeeds like '%" & fltr.txtDopNeeds.Text & "%'"
      End If
      If fltr.lblComponents_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components>= val(fltr.txtComponents_GE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblWhantedDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT>= MakeMSSQLDate(fltr.dtpWhantedDT_GE.value)"
      End If
      If fltr.lblDocLength_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_DocLength<= val(fltr.txtDocLength_LE.Text)"
      End If
      If fltr.lblWidthMM_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM<= val(fltr.txtWidthMM_LE.Text)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblOutlets_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Outlets>= val(fltr.txtOutlets_GE.Text)"
      End If
      If fltr.lblProductPeriod_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_ProductPeriod<= val(fltr.txtProductPeriod_LE.Text)"
      End If
      If fltr.lblComponents_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Components<= val(fltr.txtComponents_LE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceRes_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceRes<= val(fltr.txtPriceRes_LE.Text)"
      End If
      If fltr.lblPriceResNDS_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_PriceResNDS<= val(fltr.txtPriceResNDS_LE.Text)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblWhantedDT_LE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WhantedDT<= MakeMSSQLDate(fltr.dtpWhantedDT_LE.value)"
      End If
      If fltr.lblNeeds3D.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_Needs3D='" & fltr.cmbNeeds3D.Text & "'"
      End If
      If fltr.lblEstimatedByRef.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_EstimatedByRef_ID='" & fltr.txtEstimatedByRef.Tag & "'"
      End If
      If fltr.lblWidthMM_GE.Value = vbChecked Then
        f = f & " and PCB_PPP_Info_WidthMM>= val(fltr.txtWidthMM_GE.Text)"
      End If
    jfmnuPCB_PPP_8.jv.Filter.Add "AUTOPCB_PPP_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_PPP_8_OnClearFilter()
   jfmnuPCB_PPP_8.jv.Filter.Add "AUTOPCB_PPP_Info", " INTSANCEStatusID='{B54FFD73-2B61-4B51-A88E-DE1C59521CAB}'"
End Sub
Private Sub jfmnuPCB_PPP_8_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_PPP", "Задача на проектирование ПП" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuAllPCB_Delivery_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_Delivery Is Nothing Then
      Set jfmnuAllPCB_Delivery = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_Delivery.jv.journal = journal
      jfmnuAllPCB_Delivery.jv.OpenModal = False
      jfmnuAllPCB_Delivery.Caption = "Задача по доставке - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuAllPCB_Delivery.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuAllPCB_Delivery.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_Delivery.Show
    jfmnuAllPCB_Delivery.WindowState = 0
    jfmnuAllPCB_Delivery.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_Delivery_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
    jfmnuAllPCB_Delivery.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_Delivery_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_1 Is Nothing Then
      Set jfmnuPCB_Delivery_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_1.jv.journal = journal
      jfmnuPCB_Delivery_1.jv.OpenModal = False
      jfmnuPCB_Delivery_1.Caption = "Задача по доставке :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{14A3D6A7-34CD-46F1-A558-06D3DE7A7C19}'"
    jfmnuPCB_Delivery_1.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
    jfmnuPCB_Delivery_1.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_1.Show
    jfmnuPCB_Delivery_1.WindowState = 0
    jfmnuPCB_Delivery_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{14A3D6A7-34CD-46F1-A558-06D3DE7A7C19}'"
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
    jfmnuPCB_Delivery_1.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_1_OnClearFilter()
   jfmnuPCB_Delivery_1.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{14A3D6A7-34CD-46F1-A558-06D3DE7A7C19}'"
End Sub
Private Sub jfmnuPCB_Delivery_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_2 Is Nothing Then
      Set jfmnuPCB_Delivery_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_2.jv.journal = journal
      jfmnuPCB_Delivery_2.jv.OpenModal = False
      jfmnuPCB_Delivery_2.Caption = "Задача по доставке :Принята"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{809C7967-36E2-48E4-BAB7-0CD0512C5B6D}'"
    jfmnuPCB_Delivery_2.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
    jfmnuPCB_Delivery_2.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_2.Show
    jfmnuPCB_Delivery_2.WindowState = 0
    jfmnuPCB_Delivery_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{809C7967-36E2-48E4-BAB7-0CD0512C5B6D}'"
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
    jfmnuPCB_Delivery_2.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_2_OnClearFilter()
   jfmnuPCB_Delivery_2.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{809C7967-36E2-48E4-BAB7-0CD0512C5B6D}'"
End Sub
Private Sub jfmnuPCB_Delivery_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_3 Is Nothing Then
      Set jfmnuPCB_Delivery_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_3.jv.journal = journal
      jfmnuPCB_Delivery_3.jv.OpenModal = False
      jfmnuPCB_Delivery_3.Caption = "Задача по доставке :Оценена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{9B2A0235-EB2F-465B-A77C-4A6274085AB7}'"
    jfmnuPCB_Delivery_3.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
    jfmnuPCB_Delivery_3.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_3.Show
    jfmnuPCB_Delivery_3.WindowState = 0
    jfmnuPCB_Delivery_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{9B2A0235-EB2F-465B-A77C-4A6274085AB7}'"
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
    jfmnuPCB_Delivery_3.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_3_OnClearFilter()
   jfmnuPCB_Delivery_3.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{9B2A0235-EB2F-465B-A77C-4A6274085AB7}'"
End Sub
Private Sub jfmnuPCB_Delivery_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_4 Is Nothing Then
      Set jfmnuPCB_Delivery_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_4.jv.journal = journal
      jfmnuPCB_Delivery_4.jv.OpenModal = False
      jfmnuPCB_Delivery_4.Caption = "Задача по доставке :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{53A20A88-B48D-4562-92C6-7570F3E3C4CA}'"
    jfmnuPCB_Delivery_4.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
    jfmnuPCB_Delivery_4.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_4.Show
    jfmnuPCB_Delivery_4.WindowState = 0
    jfmnuPCB_Delivery_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{53A20A88-B48D-4562-92C6-7570F3E3C4CA}'"
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
    jfmnuPCB_Delivery_4.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_4_OnClearFilter()
   jfmnuPCB_Delivery_4.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{53A20A88-B48D-4562-92C6-7570F3E3C4CA}'"
End Sub
Private Sub jfmnuPCB_Delivery_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_5 Is Nothing Then
      Set jfmnuPCB_Delivery_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_5.jv.journal = journal
      jfmnuPCB_Delivery_5.jv.OpenModal = False
      jfmnuPCB_Delivery_5.Caption = "Задача по доставке :Завершена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{7CDFFE64-02F3-4A7C-A932-772820CF52CA}'"
    jfmnuPCB_Delivery_5.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_Delivery_5.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_5.Show
    jfmnuPCB_Delivery_5.WindowState = 0
    jfmnuPCB_Delivery_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{7CDFFE64-02F3-4A7C-A932-772820CF52CA}'"
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
    jfmnuPCB_Delivery_5.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_5_OnClearFilter()
   jfmnuPCB_Delivery_5.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{7CDFFE64-02F3-4A7C-A932-772820CF52CA}'"
End Sub
Private Sub jfmnuPCB_Delivery_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_6 Is Nothing Then
      Set jfmnuPCB_Delivery_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_6.jv.journal = journal
      jfmnuPCB_Delivery_6.jv.OpenModal = False
      jfmnuPCB_Delivery_6.Caption = "Задача по доставке :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{2F926809-5F22-4D44-9DA6-7F539F89A9E4}'"
    jfmnuPCB_Delivery_6.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
    jfmnuPCB_Delivery_6.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_6.Show
    jfmnuPCB_Delivery_6.WindowState = 0
    jfmnuPCB_Delivery_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{2F926809-5F22-4D44-9DA6-7F539F89A9E4}'"
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
    jfmnuPCB_Delivery_6.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_6_OnClearFilter()
   jfmnuPCB_Delivery_6.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{2F926809-5F22-4D44-9DA6-7F539F89A9E4}'"
End Sub
Private Sub jfmnuPCB_Delivery_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_7 Is Nothing Then
      Set jfmnuPCB_Delivery_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_7.jv.journal = journal
      jfmnuPCB_Delivery_7.jv.OpenModal = False
      jfmnuPCB_Delivery_7.Caption = "Задача по доставке :Оценить"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{55BDE6D1-D661-40B0-9D94-DBC0A2115996}'"
    jfmnuPCB_Delivery_7.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
    jfmnuPCB_Delivery_7.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_7.Show
    jfmnuPCB_Delivery_7.WindowState = 0
    jfmnuPCB_Delivery_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{55BDE6D1-D661-40B0-9D94-DBC0A2115996}'"
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
    jfmnuPCB_Delivery_7.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_7_OnClearFilter()
   jfmnuPCB_Delivery_7.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{55BDE6D1-D661-40B0-9D94-DBC0A2115996}'"
End Sub
Private Sub jfmnuPCB_Delivery_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Delivery_8_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Delivery_8 Is Nothing Then
      Set jfmnuPCB_Delivery_8 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6B30FFAB-7D84-41E9-9656-85F3E39685AC}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Delivery_8.jv.journal = journal
      jfmnuPCB_Delivery_8.jv.OpenModal = False
      jfmnuPCB_Delivery_8.Caption = "Задача по доставке :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{B75ACEFA-8C8A-4EAB-8BBE-EC4791D5B6B6}'"
    jfmnuPCB_Delivery_8.jv.Filter.Add "AUTOPCB_DEL_Info", f
    Dim fltr As frmPCB_Delivery
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
    jfmnuPCB_Delivery_8.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
      jfmnuPCB_Delivery_8.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Delivery_8.Show
    jfmnuPCB_Delivery_8.WindowState = 0
    jfmnuPCB_Delivery_8.ZOrder 0
End Sub
Private Sub jfmnuPCB_Delivery_8_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Delivery
    Dim f As String
    Set fltr = New frmPCB_Delivery
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{B75ACEFA-8C8A-4EAB-8BBE-EC4791D5B6B6}'"
      If fltr.lblCreatedByRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedByRef_ID='" & fltr.txtCreatedByRef.Tag & "'"
      End If
      If fltr.lblPlannedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT>= MakeMSSQLDate(fltr.dtpPlannedDT_GE.value)"
      End If
      If fltr.lblFactStartDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT<= MakeMSSQLDate(fltr.dtpFactStartDT_LE.value)"
      End If
      If fltr.lblFactEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT<= MakeMSSQLDate(fltr.dtpFactEndDT_LE.value)"
      End If
      If fltr.lblPriceDelivary_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary<= val(fltr.txtPriceDelivary_LE.Text)"
      End If
      If fltr.lblPriceDelivary_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PriceDelivary>= val(fltr.txtPriceDelivary_GE.Text)"
      End If
      If fltr.lblTheComments.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComments like '%" & fltr.txtTheComments.Text & "%'"
      End If
      If fltr.lblPlannedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlannedDT<= MakeMSSQLDate(fltr.dtpPlannedDT_LE.value)"
      End If
      If fltr.lblPlanEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT>= MakeMSSQLDate(fltr.dtpPlanEndDT_GE.value)"
      End If
      If fltr.lblTaskType.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TaskType='" & fltr.cmbTaskType.Text & "'"
      End If
      If fltr.lblPhoneLink.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PhoneLink like '%" & fltr.txtPhoneLink.Text & "%'"
      End If
      If fltr.lblDeliveryTypeRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_DeliveryTypeRef_ID='" & fltr.txtDeliveryTypeRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblContributorRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContributorRef_ID='" & fltr.txtContributorRef.Tag & "'"
      End If
      If fltr.lblCountnumber.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_Countnumber like '%" & fltr.txtCountnumber.Text & "%'"
      End If
      If fltr.lblPlanEndDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_PlanEndDT<= MakeMSSQLDate(fltr.dtpPlanEndDT_LE.value)"
      End If
      If fltr.lblContactRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_ContactRef_ID='" & fltr.txtContactRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblFactEndDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactEndDT>= MakeMSSQLDate(fltr.dtpFactEndDT_GE.value)"
      End If
      If fltr.lblFactStartDT_GE.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_FactStartDT>= MakeMSSQLDate(fltr.dtpFactStartDT_GE.value)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_DEL_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
    jfmnuPCB_Delivery_8.jv.Filter.Add "AUTOPCB_DEL_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Delivery_8_OnClearFilter()
   jfmnuPCB_Delivery_8.jv.Filter.Add "AUTOPCB_DEL_Info", " INTSANCEStatusID='{B75ACEFA-8C8A-4EAB-8BBE-EC4791D5B6B6}'"
End Sub
Private Sub jfmnuPCB_Delivery_8_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Delivery", "Задача по доставке" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuAllPCB_Order_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_Order Is Nothing Then
      Set jfmnuAllPCB_Order = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_Order.jv.journal = journal
      jfmnuAllPCB_Order.jv.OpenModal = False
      jfmnuAllPCB_Order.Caption = "Заказ - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
    jfmnuAllPCB_Order.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuAllPCB_Order.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_Order.Show
    jfmnuAllPCB_Order.WindowState = 0
    jfmnuAllPCB_Order.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_Order_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
    jfmnuAllPCB_Order.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_Order_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Order_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Order_1 Is Nothing Then
      Set jfmnuPCB_Order_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Order_1.jv.journal = journal
      jfmnuPCB_Order_1.jv.OpenModal = False
      jfmnuPCB_Order_1.Caption = "Заказ :Подготовка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{BBA6008C-35C0-4FA0-9585-2FC510E4C52A}'"
    jfmnuPCB_Order_1.jv.Filter.Add "AUTOPCB_Order_Info", f
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
    jfmnuPCB_Order_1.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuPCB_Order_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Order_1.Show
    jfmnuPCB_Order_1.WindowState = 0
    jfmnuPCB_Order_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_Order_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{BBA6008C-35C0-4FA0-9585-2FC510E4C52A}'"
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
    jfmnuPCB_Order_1.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Order_1_OnClearFilter()
   jfmnuPCB_Order_1.jv.Filter.Add "AUTOPCB_Order_Info", " INTSANCEStatusID='{BBA6008C-35C0-4FA0-9585-2FC510E4C52A}'"
End Sub
Private Sub jfmnuPCB_Order_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Order_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Order_2 Is Nothing Then
      Set jfmnuPCB_Order_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Order_2.jv.journal = journal
      jfmnuPCB_Order_2.jv.OpenModal = False
      jfmnuPCB_Order_2.Caption = "Заказ :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{C59C0878-DBF2-47EC-87FC-32C76E87E042}'"
    jfmnuPCB_Order_2.jv.Filter.Add "AUTOPCB_Order_Info", f
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
    jfmnuPCB_Order_2.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuPCB_Order_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Order_2.Show
    jfmnuPCB_Order_2.WindowState = 0
    jfmnuPCB_Order_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_Order_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{C59C0878-DBF2-47EC-87FC-32C76E87E042}'"
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
    jfmnuPCB_Order_2.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Order_2_OnClearFilter()
   jfmnuPCB_Order_2.jv.Filter.Add "AUTOPCB_Order_Info", " INTSANCEStatusID='{C59C0878-DBF2-47EC-87FC-32C76E87E042}'"
End Sub
Private Sub jfmnuPCB_Order_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Order_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Order_3 Is Nothing Then
      Set jfmnuPCB_Order_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Order_3.jv.journal = journal
      jfmnuPCB_Order_3.jv.OpenModal = False
      jfmnuPCB_Order_3.Caption = "Заказ :Отмена"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{3EDEF703-DC26-4A11-9114-83210DDDAE46}'"
    jfmnuPCB_Order_3.jv.Filter.Add "AUTOPCB_Order_Info", f
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
    jfmnuPCB_Order_3.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuPCB_Order_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Order_3.Show
    jfmnuPCB_Order_3.WindowState = 0
    jfmnuPCB_Order_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_Order_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{3EDEF703-DC26-4A11-9114-83210DDDAE46}'"
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
    jfmnuPCB_Order_3.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Order_3_OnClearFilter()
   jfmnuPCB_Order_3.jv.Filter.Add "AUTOPCB_Order_Info", " INTSANCEStatusID='{3EDEF703-DC26-4A11-9114-83210DDDAE46}'"
End Sub
Private Sub jfmnuPCB_Order_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Order_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Order_4 Is Nothing Then
      Set jfmnuPCB_Order_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Order_4.jv.journal = journal
      jfmnuPCB_Order_4.jv.OpenModal = False
      jfmnuPCB_Order_4.Caption = "Заказ :Выполнен"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{D35FEE5E-563F-4235-9540-8C27105284E4}'"
    jfmnuPCB_Order_4.jv.Filter.Add "AUTOPCB_Order_Info", f
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
    jfmnuPCB_Order_4.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuPCB_Order_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Order_4.Show
    jfmnuPCB_Order_4.WindowState = 0
    jfmnuPCB_Order_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_Order_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{D35FEE5E-563F-4235-9540-8C27105284E4}'"
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
    jfmnuPCB_Order_4.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Order_4_OnClearFilter()
   jfmnuPCB_Order_4.jv.Filter.Add "AUTOPCB_Order_Info", " INTSANCEStatusID='{D35FEE5E-563F-4235-9540-8C27105284E4}'"
End Sub
Private Sub jfmnuPCB_Order_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Order_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Order_5 Is Nothing Then
      Set jfmnuPCB_Order_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{3AD812C7-EB33-45B4-B28A-83D68A0E6EAD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Order_5.jv.journal = journal
      jfmnuPCB_Order_5.jv.OpenModal = False
      jfmnuPCB_Order_5.Caption = "Заказ :В Работе"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{154A0E74-15F4-4CED-A344-E10C01A73ED5}'"
    jfmnuPCB_Order_5.jv.Filter.Add "AUTOPCB_Order_Info", f
    Dim fltr As frmPCB_Order
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
    jfmnuPCB_Order_5.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
      jfmnuPCB_Order_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Order_5.Show
    jfmnuPCB_Order_5.WindowState = 0
    jfmnuPCB_Order_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_Order_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Order
    Dim f As String
    Set fltr = New frmPCB_Order
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{154A0E74-15F4-4CED-A344-E10C01A73ED5}'"
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_Order_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblFileRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_FileRef_ID='" & fltr.txtFileRef.Tag & "'"
      End If
      If fltr.lblPayerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_PayerRef_ID='" & fltr.txtPayerRef.Tag & "'"
      End If
      If fltr.lblCustomerURRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerURRef_ID='" & fltr.txtCustomerURRef.Tag & "'"
      End If
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblProfit_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit<= val(fltr.txtProfit_LE.Text)"
      End If
      If fltr.lblCustomerRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CustomerRef_ID='" & fltr.txtCustomerRef.Tag & "'"
      End If
      If fltr.lblRecipient.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Recipient_ID='" & fltr.txtRecipient.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblReason.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Reason like '%" & fltr.txtReason.Text & "%'"
      End If
      If fltr.lblReasonStart.Value = vbChecked Then
        f = f & " and PCB_Order_Info_ReasonStart like '%" & fltr.txtReasonStart.Text & "%'"
      End If
      If fltr.lblRepeatCount_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount<= val(fltr.txtRepeatCount_LE.Text)"
      End If
      If fltr.lblRequestRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RequestRef_ID='" & fltr.txtRequestRef.Tag & "'"
      End If
      If fltr.lblRepeatCount_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_RepeatCount>= val(fltr.txtRepeatCount_GE.Text)"
      End If
      If fltr.lblOrderNumber.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderNumber like '%" & fltr.txtOrderNumber.Text & "%'"
      End If
      If fltr.lblOrderSumm_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm>= val(fltr.txtOrderSumm_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblProfit_GE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_Profit>= val(fltr.txtProfit_GE.Text)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and PCB_Order_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblOrderSumm_LE.Value = vbChecked Then
        f = f & " and PCB_Order_Info_OrderSumm<= val(fltr.txtOrderSumm_LE.Text)"
      End If
    jfmnuPCB_Order_5.jv.Filter.Add "AUTOPCB_Order_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Order_5_OnClearFilter()
   jfmnuPCB_Order_5.jv.Filter.Add "AUTOPCB_Order_Info", " INTSANCEStatusID='{154A0E74-15F4-4CED-A344-E10C01A73ED5}'"
End Sub
Private Sub jfmnuPCB_Order_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Order", "Заказ" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuPCB_Customer_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Customer Is Nothing Then
      Set jfmnuPCB_Customer = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{8EF3A4F9-D208-4488-AF51-E7F380BF68C9}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Customer.jv.journal = journal
      jfmnuPCB_Customer.jv.OpenModal = False
      jfmnuPCB_Customer.Caption = "Заказчик"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Customer
    Set fltr = New frmPCB_Customer
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblINN.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_INN like '%" & fltr.txtINN.Text & "%'"
      End If
      If fltr.lblfax.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_fax like '%" & fltr.txtfax.Text & "%'"
      End If
      If fltr.lblCurator.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Curator_ID='" & fltr.txtCurator.Tag & "'"
      End If
      If fltr.lblCustCatRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustCatRef_ID='" & fltr.txtCustCatRef.Tag & "'"
      End If
      If fltr.lblURAddress.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_URAddress like '%" & fltr.txtURAddress.Text & "%'"
      End If
      If fltr.lblPassportInfo.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_PassportInfo like '%" & fltr.txtPassportInfo.Text & "%'"
      End If
      If fltr.lblCustomerStatus.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerStatus='" & fltr.cmbCustomerStatus.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblAddress.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Address like '%" & fltr.txtAddress.Text & "%'"
      End If
      If fltr.lblPhone.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Phone like '%" & fltr.txtPhone.Text & "%'"
      End If
      If fltr.lblCustomerSite.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerSite like '%" & fltr.txtCustomerSite.Text & "%'"
      End If
      If fltr.lblCustomerCode.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerCode like '%" & fltr.txtCustomerCode.Text & "%'"
      End If
      If fltr.lblTheCityRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheCityRef_ID='" & fltr.txtTheCityRef.Tag & "'"
      End If
      If fltr.lblKPP.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_KPP like '%" & fltr.txtKPP.Text & "%'"
      End If
      If fltr.lblcode.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_code like '%" & fltr.txtcode.Text & "%'"
      End If
      If fltr.lblthe_Comment.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_the_Comment like '%" & fltr.txtthe_Comment.Text & "%'"
      End If
      If fltr.lblIsPhizical.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_IsPhizical='" & fltr.cmbIsPhizical.Text & "'"
      End If
      If fltr.lblContactTech.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_ContactTech_ID='" & fltr.txtContactTech.Tag & "'"
      End If
      If fltr.lbleMail.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_eMail like '%" & fltr.txteMail.Text & "%'"
      End If
      If fltr.lblfullname.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_fullname like '%" & fltr.txtfullname.Text & "%'"
      End If
      If fltr.lblOwnerRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_OwnerRef_ID='" & fltr.txtOwnerRef.Tag & "'"
      End If
      If fltr.lblContactOrg.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_ContactOrg_ID='" & fltr.txtContactOrg.Tag & "'"
      End If
      If fltr.lblTheSource.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheSource like '%" & fltr.txtTheSource.Text & "%'"
      End If
    jfmnuPCB_Customer.jv.Filter.Add "AUTOPCB_Cust_Info", f
    End If
      jfmnuPCB_Customer.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Customer.Show
    jfmnuPCB_Customer.WindowState = 0
    jfmnuPCB_Customer.ZOrder 0
End Sub
Private Sub jfmnuPCB_Customer_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Customer
    Dim f As String
    Set fltr = New frmPCB_Customer
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblINN.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_INN like '%" & fltr.txtINN.Text & "%'"
      End If
      If fltr.lblfax.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_fax like '%" & fltr.txtfax.Text & "%'"
      End If
      If fltr.lblCurator.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Curator_ID='" & fltr.txtCurator.Tag & "'"
      End If
      If fltr.lblCustCatRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustCatRef_ID='" & fltr.txtCustCatRef.Tag & "'"
      End If
      If fltr.lblURAddress.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_URAddress like '%" & fltr.txtURAddress.Text & "%'"
      End If
      If fltr.lblPassportInfo.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_PassportInfo like '%" & fltr.txtPassportInfo.Text & "%'"
      End If
      If fltr.lblCustomerStatus.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerStatus='" & fltr.cmbCustomerStatus.Text & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblAddress.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Address like '%" & fltr.txtAddress.Text & "%'"
      End If
      If fltr.lblPhone.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_Phone like '%" & fltr.txtPhone.Text & "%'"
      End If
      If fltr.lblCustomerSite.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerSite like '%" & fltr.txtCustomerSite.Text & "%'"
      End If
      If fltr.lblCustomerCode.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_CustomerCode like '%" & fltr.txtCustomerCode.Text & "%'"
      End If
      If fltr.lblTheCityRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheCityRef_ID='" & fltr.txtTheCityRef.Tag & "'"
      End If
      If fltr.lblKPP.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_KPP like '%" & fltr.txtKPP.Text & "%'"
      End If
      If fltr.lblcode.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_code like '%" & fltr.txtcode.Text & "%'"
      End If
      If fltr.lblthe_Comment.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_the_Comment like '%" & fltr.txtthe_Comment.Text & "%'"
      End If
      If fltr.lblIsPhizical.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_IsPhizical='" & fltr.cmbIsPhizical.Text & "'"
      End If
      If fltr.lblContactTech.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_ContactTech_ID='" & fltr.txtContactTech.Tag & "'"
      End If
      If fltr.lbleMail.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_eMail like '%" & fltr.txteMail.Text & "%'"
      End If
      If fltr.lblfullname.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_fullname like '%" & fltr.txtfullname.Text & "%'"
      End If
      If fltr.lblOwnerRef.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_OwnerRef_ID='" & fltr.txtOwnerRef.Tag & "'"
      End If
      If fltr.lblContactOrg.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_ContactOrg_ID='" & fltr.txtContactOrg.Tag & "'"
      End If
      If fltr.lblTheSource.Value = vbChecked Then
        f = f & " and PCB_Cust_Info_TheSource like '%" & fltr.txtTheSource.Text & "%'"
      End If
    jfmnuPCB_Customer.jv.Filter.Add "AUTOPCB_Cust_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Customer_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Customer", "Заказчик" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuAllPCB_Request_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_Request Is Nothing Then
      Set jfmnuAllPCB_Request = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_Request.jv.journal = journal
      jfmnuAllPCB_Request.jv.OpenModal = False
      jfmnuAllPCB_Request.Caption = "Запрос - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
    jfmnuAllPCB_Request.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuAllPCB_Request.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_Request.Show
    jfmnuAllPCB_Request.WindowState = 0
    jfmnuAllPCB_Request.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_Request_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
    jfmnuAllPCB_Request.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_Request_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Request_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Request_1 Is Nothing Then
      Set jfmnuPCB_Request_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Request_1.jv.journal = journal
      jfmnuPCB_Request_1.jv.OpenModal = False
      jfmnuPCB_Request_1.Caption = "Запрос :Отказ"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{E6EC9645-8905-4D06-9A73-51A8D00D238F}'"
    jfmnuPCB_Request_1.jv.Filter.Add "AUTORCB_Req_Info", f
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_Request_1.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuPCB_Request_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Request_1.Show
    jfmnuPCB_Request_1.WindowState = 0
    jfmnuPCB_Request_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_Request_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{E6EC9645-8905-4D06-9A73-51A8D00D238F}'"
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_Request_1.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Request_1_OnClearFilter()
   jfmnuPCB_Request_1.jv.Filter.Add "AUTORCB_Req_Info", " INTSANCEStatusID='{E6EC9645-8905-4D06-9A73-51A8D00D238F}'"
End Sub
Private Sub jfmnuPCB_Request_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Request_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Request_2 Is Nothing Then
      Set jfmnuPCB_Request_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Request_2.jv.journal = journal
      jfmnuPCB_Request_2.jv.OpenModal = False
      jfmnuPCB_Request_2.Caption = "Запрос :Оценка"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{6181937D-DC97-419A-82AD-6DDA1BCD9470}'"
    jfmnuPCB_Request_2.jv.Filter.Add "AUTORCB_Req_Info", f
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
    jfmnuPCB_Request_2.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuPCB_Request_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Request_2.Show
    jfmnuPCB_Request_2.WindowState = 0
    jfmnuPCB_Request_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_Request_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{6181937D-DC97-419A-82AD-6DDA1BCD9470}'"
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
    jfmnuPCB_Request_2.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Request_2_OnClearFilter()
   jfmnuPCB_Request_2.jv.Filter.Add "AUTORCB_Req_Info", " INTSANCEStatusID='{6181937D-DC97-419A-82AD-6DDA1BCD9470}'"
End Sub
Private Sub jfmnuPCB_Request_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Request_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Request_3 Is Nothing Then
      Set jfmnuPCB_Request_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Request_3.jv.journal = journal
      jfmnuPCB_Request_3.jv.OpenModal = False
      jfmnuPCB_Request_3.Caption = "Запрос :Оформлен"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{73FE47E3-7A13-4685-91EA-B0772AD7BA6B}'"
    jfmnuPCB_Request_3.jv.Filter.Add "AUTORCB_Req_Info", f
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
    jfmnuPCB_Request_3.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuPCB_Request_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Request_3.Show
    jfmnuPCB_Request_3.WindowState = 0
    jfmnuPCB_Request_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_Request_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{73FE47E3-7A13-4685-91EA-B0772AD7BA6B}'"
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
    jfmnuPCB_Request_3.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Request_3_OnClearFilter()
   jfmnuPCB_Request_3.jv.Filter.Add "AUTORCB_Req_Info", " INTSANCEStatusID='{73FE47E3-7A13-4685-91EA-B0772AD7BA6B}'"
End Sub
Private Sub jfmnuPCB_Request_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Request_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Request_4 Is Nothing Then
      Set jfmnuPCB_Request_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Request_4.jv.journal = journal
      jfmnuPCB_Request_4.jv.OpenModal = False
      jfmnuPCB_Request_4.Caption = "Запрос :Оценён"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{9A964133-8A9C-4498-A7C0-B14AEC19D97E}'"
    jfmnuPCB_Request_4.jv.Filter.Add "AUTORCB_Req_Info", f
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
    jfmnuPCB_Request_4.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuPCB_Request_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Request_4.Show
    jfmnuPCB_Request_4.WindowState = 0
    jfmnuPCB_Request_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_Request_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{9A964133-8A9C-4498-A7C0-B14AEC19D97E}'"
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
    jfmnuPCB_Request_4.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Request_4_OnClearFilter()
   jfmnuPCB_Request_4.jv.Filter.Add "AUTORCB_Req_Info", " INTSANCEStatusID='{9A964133-8A9C-4498-A7C0-B14AEC19D97E}'"
End Sub
Private Sub jfmnuPCB_Request_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Request_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Request_5 Is Nothing Then
      Set jfmnuPCB_Request_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{6A6793FE-C3EE-47A6-9171-8C23C9EEF465}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Request_5.jv.journal = journal
      jfmnuPCB_Request_5.jv.OpenModal = False
      jfmnuPCB_Request_5.Caption = "Запрос :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{2EE9EEB4-18D1-4D3F-8750-FFC3F394308B}'"
    jfmnuPCB_Request_5.jv.Filter.Add "AUTORCB_Req_Info", f
    Dim fltr As frmPCB_Request
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
    jfmnuPCB_Request_5.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
      jfmnuPCB_Request_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Request_5.Show
    jfmnuPCB_Request_5.WindowState = 0
    jfmnuPCB_Request_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_Request_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Request
    Dim f As String
    Set fltr = New frmPCB_Request
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{2EE9EEB4-18D1-4D3F-8750-FFC3F394308B}'"
      If fltr.lblRepeatedRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_RepeatedRef_ID='" & fltr.txtRepeatedRef.Tag & "'"
      End If
      If fltr.lblTheNumber.Value = vbChecked Then
        f = f & " and RCB_Req_Info_TheNumber like '%" & fltr.txtTheNumber.Text & "%'"
      End If
      If fltr.lblRepeated.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Repeated='" & fltr.cmbRepeated.Text & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCuratorRef.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CuratorRef_ID='" & fltr.txtCuratorRef.Tag & "'"
      End If
      If fltr.lblCreator.Value = vbChecked Then
        f = f & " and RCB_Req_Info_Creator_ID='" & fltr.txtCreator.Tag & "'"
      End If
      If fltr.lblCutomerTaskID.Value = vbChecked Then
        f = f & " and RCB_Req_Info_CutomerTaskID like '%" & fltr.txtCutomerTaskID.Text & "%'"
      End If
    jfmnuPCB_Request_5.jv.Filter.Add "AUTORCB_Req_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Request_5_OnClearFilter()
   jfmnuPCB_Request_5.jv.Filter.Add "AUTORCB_Req_Info", " INTSANCEStatusID='{2EE9EEB4-18D1-4D3F-8750-FFC3F394308B}'"
End Sub
Private Sub jfmnuPCB_Request_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Request", "Запрос" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuPCB_Protocol_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Protocol Is Nothing Then
      Set jfmnuPCB_Protocol = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{097372AB-A3B3-4C11-B6E9-BD5146944EBA}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Protocol.jv.journal = journal
      jfmnuPCB_Protocol.jv.OpenModal = False
      jfmnuPCB_Protocol.Caption = "Протокол"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Protocol
    Set fltr = New frmPCB_Protocol
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblParentRef.Value = vbChecked Then
        f = f & " and PCB_Prot_Info_ParentRef_ID='" & fltr.txtParentRef.Tag & "'"
      End If
    jfmnuPCB_Protocol.jv.Filter.Add "AUTOPCB_Prot_Info", f
    End If
      jfmnuPCB_Protocol.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Protocol.Show
    jfmnuPCB_Protocol.WindowState = 0
    jfmnuPCB_Protocol.ZOrder 0
End Sub
Private Sub jfmnuPCB_Protocol_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Protocol
    Dim f As String
    Set fltr = New frmPCB_Protocol
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblParentRef.Value = vbChecked Then
        f = f & " and PCB_Prot_Info_ParentRef_ID='" & fltr.txtParentRef.Tag & "'"
      End If
    jfmnuPCB_Protocol.jv.Filter.Add "AUTOPCB_Prot_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Protocol_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Protocol", "Протокол" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuAllPCB_Invoice_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuAllPCB_Invoice Is Nothing Then
      Set jfmnuAllPCB_Invoice = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuAllPCB_Invoice.jv.journal = journal
      jfmnuAllPCB_Invoice.jv.OpenModal = False
      jfmnuAllPCB_Invoice.Caption = "Счёт - все состояния"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
    jfmnuAllPCB_Invoice.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuAllPCB_Invoice.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuAllPCB_Invoice.Show
    jfmnuAllPCB_Invoice.WindowState = 0
    jfmnuAllPCB_Invoice.ZOrder 0
End Sub
Private Sub jfmnuAllPCB_Invoice_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
    jfmnuAllPCB_Invoice.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuAllPCB_Invoice_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_1_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_1 Is Nothing Then
      Set jfmnuPCB_Invoice_1 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_1.jv.journal = journal
      jfmnuPCB_Invoice_1.jv.OpenModal = False
      jfmnuPCB_Invoice_1.Caption = "Счёт :Частично оплачен"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{24DCF70F-D6E2-4752-90A9-069D0FB7330D}'"
    jfmnuPCB_Invoice_1.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
    jfmnuPCB_Invoice_1.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_1.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_1.Show
    jfmnuPCB_Invoice_1.WindowState = 0
    jfmnuPCB_Invoice_1.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_1_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{24DCF70F-D6E2-4752-90A9-069D0FB7330D}'"
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
    jfmnuPCB_Invoice_1.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_1_OnClearFilter()
   jfmnuPCB_Invoice_1.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{24DCF70F-D6E2-4752-90A9-069D0FB7330D}'"
End Sub
Private Sub jfmnuPCB_Invoice_1_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_2_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_2 Is Nothing Then
      Set jfmnuPCB_Invoice_2 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_2.jv.journal = journal
      jfmnuPCB_Invoice_2.jv.OpenModal = False
      jfmnuPCB_Invoice_2.Caption = "Счёт :Создание"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{7A4F03C4-CB61-49B5-B756-1DE329A574E6}'"
    jfmnuPCB_Invoice_2.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
    jfmnuPCB_Invoice_2.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_2.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_2.Show
    jfmnuPCB_Invoice_2.WindowState = 0
    jfmnuPCB_Invoice_2.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_2_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{7A4F03C4-CB61-49B5-B756-1DE329A574E6}'"
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
    jfmnuPCB_Invoice_2.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_2_OnClearFilter()
   jfmnuPCB_Invoice_2.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{7A4F03C4-CB61-49B5-B756-1DE329A574E6}'"
End Sub
Private Sub jfmnuPCB_Invoice_2_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_3_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_3 Is Nothing Then
      Set jfmnuPCB_Invoice_3 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_3.jv.journal = journal
      jfmnuPCB_Invoice_3.jv.OpenModal = False
      jfmnuPCB_Invoice_3.Caption = "Счёт :Закрыт"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{FE59E136-06AA-4EE0-A3F6-328BD5A2653E}'"
    jfmnuPCB_Invoice_3.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
    jfmnuPCB_Invoice_3.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_3.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_3.Show
    jfmnuPCB_Invoice_3.WindowState = 0
    jfmnuPCB_Invoice_3.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_3_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{FE59E136-06AA-4EE0-A3F6-328BD5A2653E}'"
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
    jfmnuPCB_Invoice_3.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_3_OnClearFilter()
   jfmnuPCB_Invoice_3.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{FE59E136-06AA-4EE0-A3F6-328BD5A2653E}'"
End Sub
Private Sub jfmnuPCB_Invoice_3_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_4_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_4 Is Nothing Then
      Set jfmnuPCB_Invoice_4 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_4.jv.journal = journal
      jfmnuPCB_Invoice_4.jv.OpenModal = False
      jfmnuPCB_Invoice_4.Caption = "Счёт :Оплачен"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{8635DA6A-C763-49FC-83D0-5A354FCA07F0}'"
    jfmnuPCB_Invoice_4.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_Invoice_4.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_4.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_4.Show
    jfmnuPCB_Invoice_4.WindowState = 0
    jfmnuPCB_Invoice_4.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_4_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{8635DA6A-C763-49FC-83D0-5A354FCA07F0}'"
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
    jfmnuPCB_Invoice_4.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_4_OnClearFilter()
   jfmnuPCB_Invoice_4.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{8635DA6A-C763-49FC-83D0-5A354FCA07F0}'"
End Sub
Private Sub jfmnuPCB_Invoice_4_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_5_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_5 Is Nothing Then
      Set jfmnuPCB_Invoice_5 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_5.jv.journal = journal
      jfmnuPCB_Invoice_5.jv.OpenModal = False
      jfmnuPCB_Invoice_5.Caption = "Счёт :Выставлен"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{99503ADD-BF8A-4E36-BD2F-894BFB626C5D}'"
    jfmnuPCB_Invoice_5.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
    jfmnuPCB_Invoice_5.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_5.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_5.Show
    jfmnuPCB_Invoice_5.WindowState = 0
    jfmnuPCB_Invoice_5.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_5_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{99503ADD-BF8A-4E36-BD2F-894BFB626C5D}'"
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
    jfmnuPCB_Invoice_5.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_5_OnClearFilter()
   jfmnuPCB_Invoice_5.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{99503ADD-BF8A-4E36-BD2F-894BFB626C5D}'"
End Sub
Private Sub jfmnuPCB_Invoice_5_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_6_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_6 Is Nothing Then
      Set jfmnuPCB_Invoice_6 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_6.jv.journal = journal
      jfmnuPCB_Invoice_6.jv.OpenModal = False
      jfmnuPCB_Invoice_6.Caption = "Счёт :Отменён"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{5B9829E6-9FC1-463E-B5F2-A6DC569EF80A}'"
    jfmnuPCB_Invoice_6.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
    jfmnuPCB_Invoice_6.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_6.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_6.Show
    jfmnuPCB_Invoice_6.WindowState = 0
    jfmnuPCB_Invoice_6.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_6_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{5B9829E6-9FC1-463E-B5F2-A6DC569EF80A}'"
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
    jfmnuPCB_Invoice_6.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_6_OnClearFilter()
   jfmnuPCB_Invoice_6.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{5B9829E6-9FC1-463E-B5F2-A6DC569EF80A}'"
End Sub
Private Sub jfmnuPCB_Invoice_6_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuPCB_Invoice_7_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_Invoice_7 Is Nothing Then
      Set jfmnuPCB_Invoice_7 = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{7CD44EA4-5F40-4EE3-ABFF-31CFB76C938F}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_Invoice_7.jv.journal = journal
      jfmnuPCB_Invoice_7.jv.OpenModal = False
      jfmnuPCB_Invoice_7.Caption = "Счёт :Частично закрыт"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
   f = " INTSANCEStatusID='{41062488-24AA-4D58-943E-B5F16E86130E}'"
    jfmnuPCB_Invoice_7.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    Dim fltr As frmPCB_Invoice
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
    jfmnuPCB_Invoice_7.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
      jfmnuPCB_Invoice_7.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_Invoice_7.Show
    jfmnuPCB_Invoice_7.WindowState = 0
    jfmnuPCB_Invoice_7.ZOrder 0
End Sub
Private Sub jfmnuPCB_Invoice_7_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_Invoice
    Dim f As String
    Set fltr = New frmPCB_Invoice
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
   f = " INTSANCEStatusID='{41062488-24AA-4D58-943E-B5F16E86130E}'"
      If fltr.lblDebts_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts<= val(fltr.txtDebts_LE.Text)"
      End If
      If fltr.lblCustomer.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Customer_ID='" & fltr.txtCustomer.Tag & "'"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblInvNumber.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvNumber like '%" & fltr.txtInvNumber.Text & "%'"
      End If
      If fltr.lblPCBReceiver.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_PCBReceiver_ID='" & fltr.txtPCBReceiver.Tag & "'"
      End If
      If fltr.lblInvoiceDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT>= MakeMSSQLDate(fltr.dtpInvoiceDT_GE.value)"
      End If
      If fltr.lblEditedDT_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT>= MakeMSSQLDate(fltr.dtpEditedDT_GE.value)"
      End If
      If fltr.lblInvoiceDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_InvoiceDT<= MakeMSSQLDate(fltr.dtpInvoiceDT_LE.value)"
      End If
      If fltr.lblEditedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedDT<= MakeMSSQLDate(fltr.dtpEditedDT_LE.value)"
      End If
      If fltr.lblNotClosedPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice<= val(fltr.txtNotClosedPrice_LE.Text)"
      End If
      If fltr.lblNotClosedPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_NotClosedPrice>= val(fltr.txtNotClosedPrice_GE.Text)"
      End If
      If fltr.lblEditedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_EditedBy_ID='" & fltr.txtEditedBy.Tag & "'"
      End If
      If fltr.lblCreatedBy.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedBy_ID='" & fltr.txtCreatedBy.Tag & "'"
      End If
      If fltr.lblTheManager.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_TheManager_ID='" & fltr.txtTheManager.Tag & "'"
      End If
      If fltr.lblPrice_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price>= val(fltr.txtPrice_GE.Text)"
      End If
      If fltr.lblPrice_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Price<= val(fltr.txtPrice_LE.Text)"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblDebts_GE.Value = vbChecked Then
        f = f & " and PCB_Invoice_Info_Debts>= val(fltr.txtDebts_GE.Text)"
      End If
    jfmnuPCB_Invoice_7.jv.Filter.Add "AUTOPCB_Invoice_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_Invoice_7_OnClearFilter()
   jfmnuPCB_Invoice_7.jv.Filter.Add "AUTOPCB_Invoice_Info", " INTSANCEStatusID='{41062488-24AA-4D58-943E-B5F16E86130E}'"
End Sub
Private Sub jfmnuPCB_Invoice_7_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_Invoice", "Счёт" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuPCB_File_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuPCB_File Is Nothing Then
      Set jfmnuPCB_File = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{2ADE3357-DAB8-4A10-9938-24B203279CBD}")
      Manager.LockInstanceObject journal.id
      Set jfmnuPCB_File.jv.journal = journal
      jfmnuPCB_File.jv.OpenModal = False
      jfmnuPCB_File.Caption = "Файл"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmPCB_File
    Set fltr = New frmPCB_File
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheID.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheID like '%" & fltr.txtTheID.Text & "%'"
      End If
      If fltr.lblCreatorRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatorRef_ID='" & fltr.txtCreatorRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblReqestRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_ReqestRef_ID='" & fltr.txtReqestRef.Tag & "'"
      End If
      If fltr.lblTheType.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheType_ID='" & fltr.txtTheType.Tag & "'"
      End If
    jfmnuPCB_File.jv.Filter.Add "AUTOPCB_File_Info", f
    End If
      jfmnuPCB_File.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuPCB_File.Show
    jfmnuPCB_File.WindowState = 0
    jfmnuPCB_File.ZOrder 0
End Sub
Private Sub jfmnuPCB_File_OnFilter(usedefault As Boolean)
    Dim fltr As frmPCB_File
    Dim f As String
    Set fltr = New frmPCB_File
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblOrderRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_OrderRef_ID='" & fltr.txtOrderRef.Tag & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblCreatedDT_LE.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatedDT<= MakeMSSQLDate(fltr.dtpCreatedDT_LE.value)"
      End If
      If fltr.lblCreatedDT_GE.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatedDT>= MakeMSSQLDate(fltr.dtpCreatedDT_GE.value)"
      End If
      If fltr.lblTheID.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheID like '%" & fltr.txtTheID.Text & "%'"
      End If
      If fltr.lblCreatorRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_CreatorRef_ID='" & fltr.txtCreatorRef.Tag & "'"
      End If
      If fltr.lblTheName.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheName like '%" & fltr.txtTheName.Text & "%'"
      End If
      If fltr.lblReqestRef.Value = vbChecked Then
        f = f & " and PCB_File_Info_ReqestRef_ID='" & fltr.txtReqestRef.Tag & "'"
      End If
      If fltr.lblTheType.Value = vbChecked Then
        f = f & " and PCB_File_Info_TheType_ID='" & fltr.txtTheType.Tag & "'"
      End If
    jfmnuPCB_File.jv.Filter.Add "AUTOPCB_File_Info", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuPCB_File_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "PCB_File", "Файл" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub


Private Sub mnuROLES_Click()
    Dim journal As Object
    On Error Resume Next
    If jfmnuROLES Is Nothing Then
      Set jfmnuROLES = New frmJournalShow
      Set journal = Manager.GetInstanceObject("{049298AF-0D01-42BB-85FF-4569C79A598B}")
      Manager.LockInstanceObject journal.id
      Set jfmnuROLES.jv.journal = journal
      jfmnuROLES.jv.OpenModal = False
      jfmnuROLES.Caption = "Роли"
      Me.MousePointer = vbHourglass
      DoEvents
      Dim f As String
    f = "1=1"
    Dim fltr As frmROLES
    Set fltr = New frmROLES
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
      If fltr.lblListCFG_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_ListCFG_Denied='" & fltr.cmbListCFG_Denied.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and ROLES_DEF_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblRightsSet_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_RightsSet_Denied='" & fltr.cmbRightsSet_Denied.Text & "'"
      End If
      If fltr.lblname.Value = vbChecked Then
        f = f & " and ROLES_DEF_name like '%" & fltr.txtname.Text & "%'"
      End If
      If fltr.lblFileExch_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_FileExch_Denied='" & fltr.cmbFileExch_Denied.Text & "'"
      End If
      If fltr.lblFormCFG_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_FormCFG_Denied='" & fltr.cmbFormCFG_Denied.Text & "'"
      End If
    jfmnuROLES.jv.Filter.Add "AUTOROLES_DEF", f
    End If
      jfmnuROLES.jv.Refresh
      Me.MousePointer = vbNormal
    End If
    jfmnuROLES.Show
    jfmnuROLES.WindowState = 0
    jfmnuROLES.ZOrder 0
End Sub
Private Sub jfmnuROLES_OnFilter(usedefault As Boolean)
    Dim fltr As frmROLES
    Dim f As String
    Set fltr = New frmROLES
    fltr.Show vbModal
    If fltr.OK Then
    ' build flter expression
    f = "1=1"
      If fltr.lblListCFG_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_ListCFG_Denied='" & fltr.cmbListCFG_Denied.Text & "'"
      End If
      If fltr.lblTheComment.Value = vbChecked Then
        f = f & " and ROLES_DEF_TheComment like '%" & fltr.txtTheComment.Text & "%'"
      End If
      If fltr.lblRightsSet_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_RightsSet_Denied='" & fltr.cmbRightsSet_Denied.Text & "'"
      End If
      If fltr.lblname.Value = vbChecked Then
        f = f & " and ROLES_DEF_name like '%" & fltr.txtname.Text & "%'"
      End If
      If fltr.lblFileExch_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_FileExch_Denied='" & fltr.cmbFileExch_Denied.Text & "'"
      End If
      If fltr.lblFormCFG_Denied.Value = vbChecked Then
        f = f & " and ROLES_DEF_FormCFG_Denied='" & fltr.cmbFormCFG_Denied.Text & "'"
      End If
    jfmnuROLES.jv.Filter.Add "AUTOROLES_DEF", f
    End If
    Unload fltr
    usedefault = False
End Sub
Private Sub jfmnuROLES_OnAdd(usedefaut As Boolean, Refesh As Boolean)
  Dim objGui  As Object
  Dim o As Object
  Dim id As String
  id = CreateGUID2
  Manager.NewInstance id, "ROLES", "Роли" & Now, Site
  Set o = Manager.GetInstanceObject(id)
  If IsDocDenied(o) Then
    MsgBox "Не разрешен доступ к документам такого типа"
    Exit Sub
  End If

  Dim g  As Object
  Set g = Manager.GetInstanceGUI(o.id)
  If Not g Is Nothing Then
    g.Show GetDocumentMode(o), o, False
  End If
  usedefaut = False
  Refesh = False
End Sub




Private Sub mnuPCB_Info_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim id As String
  Set rs = Manager.ListInstances("", "PCB_Info")
  If Not rs.EOF Then
    id = rs!InstanceID
  Else
    id = CreateGUID2
    Manager.NewInstance id, "PCB_Info", "PCB Professional"
  End If
    Set o = Manager.GetInstanceObject(id)
    If IsDocDenied(o) Then
      MsgBox "Не разрешен доступ к документам такого типа"
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.id)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  Set rs = Nothing
End Sub


Private Sub mnuPCB_Dict_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim id As String
  Set rs = Manager.ListInstances("", "PCB_Dict")
  If Not rs.EOF Then
    id = rs!InstanceID
  Else
    id = CreateGUID2
    Manager.NewInstance id, "PCB_Dict", "PCB справочники"
  End If
    Set o = Manager.GetInstanceObject(id)
    If IsDocDenied(o) Then
      MsgBox "Не разрешен доступ к документам такого типа"
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.id)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  Set rs = Nothing
End Sub


Private Sub mnuPCB_DICT_COM_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim id As String
  Set rs = Manager.ListInstances("", "PCB_DICT_COM")
  If Not rs.EOF Then
    id = rs!InstanceID
  Else
    id = CreateGUID2
    Manager.NewInstance id, "PCB_DICT_COM", "PCB Справочники общие"
  End If
    Set o = Manager.GetInstanceObject(id)
    If IsDocDenied(o) Then
      MsgBox "Не разрешен доступ к документам такого типа"
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.id)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  Set rs = Nothing
End Sub


Private Sub mnuPCB_Reports_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim id As String
  Set rs = Manager.ListInstances("", "PCB_Reports")
  If Not rs.EOF Then
    id = rs!InstanceID
  Else
    id = CreateGUID2
    Manager.NewInstance id, "PCB_Reports", "Отчёты"
  End If
    Set o = Manager.GetInstanceObject(id)
    If IsDocDenied(o) Then
      MsgBox "Не разрешен доступ к документам такого типа"
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.id)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  Set rs = Nothing
End Sub


Private Sub mnuMTZUsers_Click()
 Dim o As Object
 Dim rs  As ADODB.Recordset
 Dim id As String
  Set rs = Manager.ListInstances("", "MTZUsers")
  If Not rs.EOF Then
    id = rs!InstanceID
  Else
    id = CreateGUID2
    Manager.NewInstance id, "MTZUsers", "Справочник: пользователи"
  End If
    Set o = Manager.GetInstanceObject(id)
    If IsDocDenied(o) Then
      MsgBox "Не разрешен доступ к документам такого типа"
      Exit Sub
    End If

    Dim g  As Object
    Set g = Manager.GetInstanceGUI(o.id)
    If Not g Is Nothing Then
      g.Show GetDocumentMode(o), o, False
    End If
  Set rs = Nothing
End Sub




Private Sub UnloadObjects()



Unload jfmnuAllPCB_MPP
Set jfmnuAllPCB_MPP = Nothing

Unload jfmnuPCB_MPP_1
Set jfmnuPCB_MPP_1 = Nothing

Unload jfmnuPCB_MPP_2
Set jfmnuPCB_MPP_2 = Nothing

Unload jfmnuPCB_MPP_3
Set jfmnuPCB_MPP_3 = Nothing

Unload jfmnuPCB_MPP_4
Set jfmnuPCB_MPP_4 = Nothing

Unload jfmnuPCB_MPP_5
Set jfmnuPCB_MPP_5 = Nothing

Unload jfmnuPCB_MPP_6
Set jfmnuPCB_MPP_6 = Nothing

Unload jfmnuPCB_MPP_7
Set jfmnuPCB_MPP_7 = Nothing

Unload jfmnuPCB_MPP_8
Set jfmnuPCB_MPP_8 = Nothing


Unload jfmnuAllPCB_TaskPP
Set jfmnuAllPCB_TaskPP = Nothing

Unload jfmnuPCB_TaskPP_1
Set jfmnuPCB_TaskPP_1 = Nothing

Unload jfmnuPCB_TaskPP_2
Set jfmnuPCB_TaskPP_2 = Nothing

Unload jfmnuPCB_TaskPP_3
Set jfmnuPCB_TaskPP_3 = Nothing

Unload jfmnuPCB_TaskPP_4
Set jfmnuPCB_TaskPP_4 = Nothing

Unload jfmnuPCB_TaskPP_5
Set jfmnuPCB_TaskPP_5 = Nothing

Unload jfmnuPCB_TaskPP_6
Set jfmnuPCB_TaskPP_6 = Nothing

Unload jfmnuPCB_TaskPP_7
Set jfmnuPCB_TaskPP_7 = Nothing

Unload jfmnuPCB_TaskPP_8
Set jfmnuPCB_TaskPP_8 = Nothing


Unload jfmnuAllPCB_OUtility
Set jfmnuAllPCB_OUtility = Nothing

Unload jfmnuPCB_OUtility_1
Set jfmnuPCB_OUtility_1 = Nothing

Unload jfmnuPCB_OUtility_2
Set jfmnuPCB_OUtility_2 = Nothing

Unload jfmnuPCB_OUtility_3
Set jfmnuPCB_OUtility_3 = Nothing

Unload jfmnuPCB_OUtility_4
Set jfmnuPCB_OUtility_4 = Nothing

Unload jfmnuPCB_OUtility_5
Set jfmnuPCB_OUtility_5 = Nothing

Unload jfmnuPCB_OUtility_6
Set jfmnuPCB_OUtility_6 = Nothing

Unload jfmnuPCB_OUtility_7
Set jfmnuPCB_OUtility_7 = Nothing

Unload jfmnuPCB_OUtility_8
Set jfmnuPCB_OUtility_8 = Nothing


Unload jfmnuAllPCB_PPP
Set jfmnuAllPCB_PPP = Nothing

Unload jfmnuPCB_PPP_1
Set jfmnuPCB_PPP_1 = Nothing

Unload jfmnuPCB_PPP_2
Set jfmnuPCB_PPP_2 = Nothing

Unload jfmnuPCB_PPP_3
Set jfmnuPCB_PPP_3 = Nothing

Unload jfmnuPCB_PPP_4
Set jfmnuPCB_PPP_4 = Nothing

Unload jfmnuPCB_PPP_5
Set jfmnuPCB_PPP_5 = Nothing

Unload jfmnuPCB_PPP_6
Set jfmnuPCB_PPP_6 = Nothing

Unload jfmnuPCB_PPP_7
Set jfmnuPCB_PPP_7 = Nothing

Unload jfmnuPCB_PPP_8
Set jfmnuPCB_PPP_8 = Nothing


Unload jfmnuAllPCB_Delivery
Set jfmnuAllPCB_Delivery = Nothing

Unload jfmnuPCB_Delivery_1
Set jfmnuPCB_Delivery_1 = Nothing

Unload jfmnuPCB_Delivery_2
Set jfmnuPCB_Delivery_2 = Nothing

Unload jfmnuPCB_Delivery_3
Set jfmnuPCB_Delivery_3 = Nothing

Unload jfmnuPCB_Delivery_4
Set jfmnuPCB_Delivery_4 = Nothing

Unload jfmnuPCB_Delivery_5
Set jfmnuPCB_Delivery_5 = Nothing

Unload jfmnuPCB_Delivery_6
Set jfmnuPCB_Delivery_6 = Nothing

Unload jfmnuPCB_Delivery_7
Set jfmnuPCB_Delivery_7 = Nothing

Unload jfmnuPCB_Delivery_8
Set jfmnuPCB_Delivery_8 = Nothing


Unload jfmnuAllPCB_Order
Set jfmnuAllPCB_Order = Nothing

Unload jfmnuPCB_Order_1
Set jfmnuPCB_Order_1 = Nothing

Unload jfmnuPCB_Order_2
Set jfmnuPCB_Order_2 = Nothing

Unload jfmnuPCB_Order_3
Set jfmnuPCB_Order_3 = Nothing

Unload jfmnuPCB_Order_4
Set jfmnuPCB_Order_4 = Nothing

Unload jfmnuPCB_Order_5
Set jfmnuPCB_Order_5 = Nothing

Unload jfmnuPCB_Customer
Set jfmnuPCB_Customer = Nothing


Unload jfmnuAllPCB_Request
Set jfmnuAllPCB_Request = Nothing

Unload jfmnuPCB_Request_1
Set jfmnuPCB_Request_1 = Nothing

Unload jfmnuPCB_Request_2
Set jfmnuPCB_Request_2 = Nothing

Unload jfmnuPCB_Request_3
Set jfmnuPCB_Request_3 = Nothing

Unload jfmnuPCB_Request_4
Set jfmnuPCB_Request_4 = Nothing

Unload jfmnuPCB_Request_5
Set jfmnuPCB_Request_5 = Nothing

Unload jfmnuPCB_Protocol
Set jfmnuPCB_Protocol = Nothing


Unload jfmnuAllPCB_Invoice
Set jfmnuAllPCB_Invoice = Nothing

Unload jfmnuPCB_Invoice_1
Set jfmnuPCB_Invoice_1 = Nothing

Unload jfmnuPCB_Invoice_2
Set jfmnuPCB_Invoice_2 = Nothing

Unload jfmnuPCB_Invoice_3
Set jfmnuPCB_Invoice_3 = Nothing

Unload jfmnuPCB_Invoice_4
Set jfmnuPCB_Invoice_4 = Nothing

Unload jfmnuPCB_Invoice_5
Set jfmnuPCB_Invoice_5 = Nothing

Unload jfmnuPCB_Invoice_6
Set jfmnuPCB_Invoice_6 = Nothing

Unload jfmnuPCB_Invoice_7
Set jfmnuPCB_Invoice_7 = Nothing

Unload jfmnuPCB_File
Set jfmnuPCB_File = Nothing

Unload jfmnuROLES
Set jfmnuROLES = Nothing







End Sub



